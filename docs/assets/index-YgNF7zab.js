const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/JoinClassroomView-DVPmcb24.js","assets/JoinClassroomView-D90zTq1t.css"])))=>i.map(i=>d[i]);
(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const r of a.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&n(r)}).observe(document,{childList:!0,subtree:!0});function s(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(o){if(o.ep)return;o.ep=!0;const a=s(o);fetch(o.href,a)}})();/**
* @vue/shared v3.5.27
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function br(e){const t=Object.create(null);for(const s of e.split(","))t[s]=1;return s=>s in t}const Ee={},tn=[],Wt=()=>{},$i=()=>!1,ta=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),_r=e=>e.startsWith("onUpdate:"),rt=Object.assign,wr=(e,t)=>{const s=e.indexOf(t);s>-1&&e.splice(s,1)},Yu=Object.prototype.hasOwnProperty,Te=(e,t)=>Yu.call(e,t),he=Array.isArray,sn=e=>co(e)==="[object Map]",yn=e=>co(e)==="[object Set]",il=e=>co(e)==="[object Date]",we=e=>typeof e=="function",Ge=e=>typeof e=="string",Dt=e=>typeof e=="symbol",Oe=e=>e!==null&&typeof e=="object",ki=e=>(Oe(e)||we(e))&&we(e.then)&&we(e.catch),xi=Object.prototype.toString,co=e=>xi.call(e),qu=e=>co(e).slice(8,-1),Ai=e=>co(e)==="[object Object]",Cr=e=>Ge(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Dn=br(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),sa=e=>{const t=Object.create(null);return s=>t[s]||(t[s]=e(s))},Xu=/-\w/g,Et=sa(e=>e.replace(Xu,t=>t.slice(1).toUpperCase())),Qu=/\B([A-Z])/g,_s=sa(e=>e.replace(Qu,"-$1").toLowerCase()),na=sa(e=>e.charAt(0).toUpperCase()+e.slice(1)),ya=sa(e=>e?`on${na(e)}`:""),ms=(e,t)=>!Object.is(e,t),To=(e,...t)=>{for(let s=0;s<e.length;s++)e[s](...t)},Ti=(e,t,s,n=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:n,value:s})},oa=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let cl;const aa=()=>cl||(cl=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function st(e){if(he(e)){const t={};for(let s=0;s<e.length;s++){const n=e[s],o=Ge(n)?sd(n):st(n);if(o)for(const a in o)t[a]=o[a]}return t}else if(Ge(e)||Oe(e))return e}const Zu=/;(?![^(]*\))/g,ed=/:([^]+)/,td=/\/\*[^]*?\*\//g;function sd(e){const t={};return e.replace(td,"").split(Zu).forEach(s=>{if(s){const n=s.split(ed);n.length>1&&(t[n[0].trim()]=n[1].trim())}}),t}function le(e){let t="";if(Ge(e))t=e;else if(he(e))for(let s=0;s<e.length;s++){const n=le(e[s]);n&&(t+=n+" ")}else if(Oe(e))for(const s in e)e[s]&&(t+=s+" ");return t.trim()}const nd="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",od=br(nd);function Ni(e){return!!e||e===""}function ad(e,t){if(e.length!==t.length)return!1;let s=!0;for(let n=0;s&&n<e.length;n++)s=Bs(e[n],t[n]);return s}function Bs(e,t){if(e===t)return!0;let s=il(e),n=il(t);if(s||n)return s&&n?e.getTime()===t.getTime():!1;if(s=Dt(e),n=Dt(t),s||n)return e===t;if(s=he(e),n=he(t),s||n)return s&&n?ad(e,t):!1;if(s=Oe(e),n=Oe(t),s||n){if(!s||!n)return!1;const o=Object.keys(e).length,a=Object.keys(t).length;if(o!==a)return!1;for(const r in e){const i=e.hasOwnProperty(r),c=t.hasOwnProperty(r);if(i&&!c||!i&&c||!Bs(e[r],t[r]))return!1}}return String(e)===String(t)}function Sr(e,t){return e.findIndex(s=>Bs(s,t))}const Ei=e=>!!(e&&e.__v_isRef===!0),_=e=>Ge(e)?e:e==null?"":he(e)||Oe(e)&&(e.toString===xi||!we(e.toString))?Ei(e)?_(e.value):JSON.stringify(e,Oi,2):String(e),Oi=(e,t)=>Ei(t)?Oi(e,t.value):sn(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((s,[n,o],a)=>(s[ba(n,a)+" =>"]=o,s),{})}:yn(t)?{[`Set(${t.size})`]:[...t.values()].map(s=>ba(s))}:Dt(t)?ba(t):Oe(t)&&!he(t)&&!Ai(t)?String(t):t,ba=(e,t="")=>{var s;return Dt(e)?`Symbol(${(s=e.description)!=null?s:t})`:e};/**
* @vue/reactivity v3.5.27
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let gt;class rd{constructor(t=!1){this.detached=t,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=gt,!t&&gt&&(this.index=(gt.scopes||(gt.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,s;if(this.scopes)for(t=0,s=this.scopes.length;t<s;t++)this.scopes[t].pause();for(t=0,s=this.effects.length;t<s;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,s;if(this.scopes)for(t=0,s=this.scopes.length;t<s;t++)this.scopes[t].resume();for(t=0,s=this.effects.length;t<s;t++)this.effects[t].resume()}}run(t){if(this._active){const s=gt;try{return gt=this,t()}finally{gt=s}}}on(){++this._on===1&&(this.prevScope=gt,gt=this)}off(){this._on>0&&--this._on===0&&(gt=this.prevScope,this.prevScope=void 0)}stop(t){if(this._active){this._active=!1;let s,n;for(s=0,n=this.effects.length;s<n;s++)this.effects[s].stop();for(this.effects.length=0,s=0,n=this.cleanups.length;s<n;s++)this.cleanups[s]();if(this.cleanups.length=0,this.scopes){for(s=0,n=this.scopes.length;s<n;s++)this.scopes[s].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const o=this.parent.scopes.pop();o&&o!==this&&(this.parent.scopes[this.index]=o,o.index=this.index)}this.parent=void 0}}}function ld(){return gt}let Re;const _a=new WeakSet;class Ii{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,gt&&gt.active&&gt.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,_a.has(this)&&(_a.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Pi(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,ul(this),Di(this);const t=Re,s=Rt;Re=this,Rt=!0;try{return this.fn()}finally{Li(this),Re=t,Rt=s,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)xr(t);this.deps=this.depsTail=void 0,ul(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?_a.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){ja(this)&&this.run()}get dirty(){return ja(this)}}let Ri=0,Ln,Bn;function Pi(e,t=!1){if(e.flags|=8,t){e.next=Bn,Bn=e;return}e.next=Ln,Ln=e}function $r(){Ri++}function kr(){if(--Ri>0)return;if(Bn){let t=Bn;for(Bn=void 0;t;){const s=t.next;t.next=void 0,t.flags&=-9,t=s}}let e;for(;Ln;){let t=Ln;for(Ln=void 0;t;){const s=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(n){e||(e=n)}t=s}}if(e)throw e}function Di(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function Li(e){let t,s=e.depsTail,n=s;for(;n;){const o=n.prevDep;n.version===-1?(n===s&&(s=o),xr(n),id(n)):t=n,n.dep.activeLink=n.prevActiveLink,n.prevActiveLink=void 0,n=o}e.deps=t,e.depsTail=s}function ja(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(Bi(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function Bi(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===Yn)||(e.globalVersion=Yn,!e.isSSR&&e.flags&128&&(!e.deps&&!e._dirty||!ja(e))))return;e.flags|=2;const t=e.dep,s=Re,n=Rt;Re=e,Rt=!0;try{Di(e);const o=e.fn(e._value);(t.version===0||ms(o,e._value))&&(e.flags|=128,e._value=o,t.version++)}catch(o){throw t.version++,o}finally{Re=s,Rt=n,Li(e),e.flags&=-3}}function xr(e,t=!1){const{dep:s,prevSub:n,nextSub:o}=e;if(n&&(n.nextSub=o,e.prevSub=void 0),o&&(o.prevSub=n,e.nextSub=void 0),s.subs===e&&(s.subs=n,!n&&s.computed)){s.computed.flags&=-5;for(let a=s.computed.deps;a;a=a.nextDep)xr(a,!0)}!t&&!--s.sc&&s.map&&s.map.delete(s.key)}function id(e){const{prevDep:t,nextDep:s}=e;t&&(t.nextDep=s,e.prevDep=void 0),s&&(s.prevDep=t,e.nextDep=void 0)}let Rt=!0;const Mi=[];function ss(){Mi.push(Rt),Rt=!1}function ns(){const e=Mi.pop();Rt=e===void 0?!0:e}function ul(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const s=Re;Re=void 0;try{t()}finally{Re=s}}}let Yn=0;class cd{constructor(t,s){this.sub=t,this.dep=s,this.version=s.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Ar{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(t){if(!Re||!Rt||Re===this.computed)return;let s=this.activeLink;if(s===void 0||s.sub!==Re)s=this.activeLink=new cd(Re,this),Re.deps?(s.prevDep=Re.depsTail,Re.depsTail.nextDep=s,Re.depsTail=s):Re.deps=Re.depsTail=s,Ui(s);else if(s.version===-1&&(s.version=this.version,s.nextDep)){const n=s.nextDep;n.prevDep=s.prevDep,s.prevDep&&(s.prevDep.nextDep=n),s.prevDep=Re.depsTail,s.nextDep=void 0,Re.depsTail.nextDep=s,Re.depsTail=s,Re.deps===s&&(Re.deps=n)}return s}trigger(t){this.version++,Yn++,this.notify(t)}notify(t){$r();try{for(let s=this.subs;s;s=s.prevSub)s.sub.notify()&&s.sub.dep.notify()}finally{kr()}}}function Ui(e){if(e.dep.sc++,e.sub.flags&4){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let n=t.deps;n;n=n.nextDep)Ui(n)}const s=e.dep.subs;s!==e&&(e.prevSub=s,s&&(s.nextSub=e)),e.dep.subs=e}}const Ha=new WeakMap,Ps=Symbol(""),Wa=Symbol(""),qn=Symbol("");function ct(e,t,s){if(Rt&&Re){let n=Ha.get(e);n||Ha.set(e,n=new Map);let o=n.get(s);o||(n.set(s,o=new Ar),o.map=n,o.key=s),o.track()}}function Xt(e,t,s,n,o,a){const r=Ha.get(e);if(!r){Yn++;return}const i=c=>{c&&c.trigger()};if($r(),t==="clear")r.forEach(i);else{const c=he(e),u=c&&Cr(s);if(c&&s==="length"){const f=Number(n);r.forEach((d,p)=>{(p==="length"||p===qn||!Dt(p)&&p>=f)&&i(d)})}else switch((s!==void 0||r.has(void 0))&&i(r.get(s)),u&&i(r.get(qn)),t){case"add":c?u&&i(r.get("length")):(i(r.get(Ps)),sn(e)&&i(r.get(Wa)));break;case"delete":c||(i(r.get(Ps)),sn(e)&&i(r.get(Wa)));break;case"set":sn(e)&&i(r.get(Ps));break}}kr()}function Hs(e){const t=Ae(e);return t===e?t:(ct(t,"iterate",qn),Tt(e)?t:t.map(Lt))}function ra(e){return ct(e=Ae(e),"iterate",qn),e}function cs(e,t){return os(e)?ln(Ds(e)?Lt(t):t):Lt(t)}const ud={__proto__:null,[Symbol.iterator](){return wa(this,Symbol.iterator,e=>cs(this,e))},concat(...e){return Hs(this).concat(...e.map(t=>he(t)?Hs(t):t))},entries(){return wa(this,"entries",e=>(e[1]=cs(this,e[1]),e))},every(e,t){return zt(this,"every",e,t,void 0,arguments)},filter(e,t){return zt(this,"filter",e,t,s=>s.map(n=>cs(this,n)),arguments)},find(e,t){return zt(this,"find",e,t,s=>cs(this,s),arguments)},findIndex(e,t){return zt(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return zt(this,"findLast",e,t,s=>cs(this,s),arguments)},findLastIndex(e,t){return zt(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return zt(this,"forEach",e,t,void 0,arguments)},includes(...e){return Ca(this,"includes",e)},indexOf(...e){return Ca(this,"indexOf",e)},join(e){return Hs(this).join(e)},lastIndexOf(...e){return Ca(this,"lastIndexOf",e)},map(e,t){return zt(this,"map",e,t,void 0,arguments)},pop(){return Sn(this,"pop")},push(...e){return Sn(this,"push",e)},reduce(e,...t){return dl(this,"reduce",e,t)},reduceRight(e,...t){return dl(this,"reduceRight",e,t)},shift(){return Sn(this,"shift")},some(e,t){return zt(this,"some",e,t,void 0,arguments)},splice(...e){return Sn(this,"splice",e)},toReversed(){return Hs(this).toReversed()},toSorted(e){return Hs(this).toSorted(e)},toSpliced(...e){return Hs(this).toSpliced(...e)},unshift(...e){return Sn(this,"unshift",e)},values(){return wa(this,"values",e=>cs(this,e))}};function wa(e,t,s){const n=ra(e),o=n[t]();return n!==e&&!Tt(e)&&(o._next=o.next,o.next=()=>{const a=o._next();return a.done||(a.value=s(a.value)),a}),o}const dd=Array.prototype;function zt(e,t,s,n,o,a){const r=ra(e),i=r!==e&&!Tt(e),c=r[t];if(c!==dd[t]){const d=c.apply(e,a);return i?Lt(d):d}let u=s;r!==e&&(i?u=function(d,p){return s.call(this,cs(e,d),p,e)}:s.length>2&&(u=function(d,p){return s.call(this,d,p,e)}));const f=c.call(r,u,n);return i&&o?o(f):f}function dl(e,t,s,n){const o=ra(e);let a=s;return o!==e&&(Tt(e)?s.length>3&&(a=function(r,i,c){return s.call(this,r,i,c,e)}):a=function(r,i,c){return s.call(this,r,cs(e,i),c,e)}),o[t](a,...n)}function Ca(e,t,s){const n=Ae(e);ct(n,"iterate",qn);const o=n[t](...s);return(o===-1||o===!1)&&Er(s[0])?(s[0]=Ae(s[0]),n[t](...s)):o}function Sn(e,t,s=[]){ss(),$r();const n=Ae(e)[t].apply(e,s);return kr(),ns(),n}const fd=br("__proto__,__v_isRef,__isVue"),Fi=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Dt));function pd(e){Dt(e)||(e=String(e));const t=Ae(this);return ct(t,"has",e),t.hasOwnProperty(e)}class ji{constructor(t=!1,s=!1){this._isReadonly=t,this._isShallow=s}get(t,s,n){if(s==="__v_skip")return t.__v_skip;const o=this._isReadonly,a=this._isShallow;if(s==="__v_isReactive")return!o;if(s==="__v_isReadonly")return o;if(s==="__v_isShallow")return a;if(s==="__v_raw")return n===(o?a?Sd:Ki:a?Vi:Wi).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(n)?t:void 0;const r=he(t);if(!o){let c;if(r&&(c=ud[s]))return c;if(s==="hasOwnProperty")return pd}const i=Reflect.get(t,s,dt(t)?t:n);if((Dt(s)?Fi.has(s):fd(s))||(o||ct(t,"get",s),a))return i;if(dt(i)){const c=r&&Cr(s)?i:i.value;return o&&Oe(c)?Ka(c):c}return Oe(i)?o?Ka(i):Vt(i):i}}class Hi extends ji{constructor(t=!1){super(!1,t)}set(t,s,n,o){let a=t[s];const r=he(t)&&Cr(s);if(!this._isShallow){const u=os(a);if(!Tt(n)&&!os(n)&&(a=Ae(a),n=Ae(n)),!r&&dt(a)&&!dt(n))return u||(a.value=n),!0}const i=r?Number(s)<t.length:Te(t,s),c=Reflect.set(t,s,n,dt(t)?t:o);return t===Ae(o)&&(i?ms(n,a)&&Xt(t,"set",s,n):Xt(t,"add",s,n)),c}deleteProperty(t,s){const n=Te(t,s);t[s];const o=Reflect.deleteProperty(t,s);return o&&n&&Xt(t,"delete",s,void 0),o}has(t,s){const n=Reflect.has(t,s);return(!Dt(s)||!Fi.has(s))&&ct(t,"has",s),n}ownKeys(t){return ct(t,"iterate",he(t)?"length":Ps),Reflect.ownKeys(t)}}class md extends ji{constructor(t=!1){super(!0,t)}set(t,s){return!0}deleteProperty(t,s){return!0}}const vd=new Hi,hd=new md,gd=new Hi(!0);const Va=e=>e,bo=e=>Reflect.getPrototypeOf(e);function yd(e,t,s){return function(...n){const o=this.__v_raw,a=Ae(o),r=sn(a),i=e==="entries"||e===Symbol.iterator&&r,c=e==="keys"&&r,u=o[e](...n),f=s?Va:t?ln:Lt;return!t&&ct(a,"iterate",c?Wa:Ps),rt(Object.create(u),{next(){const{value:d,done:p}=u.next();return p?{value:d,done:p}:{value:i?[f(d[0]),f(d[1])]:f(d),done:p}}})}}function _o(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function bd(e,t){const s={get(o){const a=this.__v_raw,r=Ae(a),i=Ae(o);e||(ms(o,i)&&ct(r,"get",o),ct(r,"get",i));const{has:c}=bo(r),u=t?Va:e?ln:Lt;if(c.call(r,o))return u(a.get(o));if(c.call(r,i))return u(a.get(i));a!==r&&a.get(o)},get size(){const o=this.__v_raw;return!e&&ct(Ae(o),"iterate",Ps),o.size},has(o){const a=this.__v_raw,r=Ae(a),i=Ae(o);return e||(ms(o,i)&&ct(r,"has",o),ct(r,"has",i)),o===i?a.has(o):a.has(o)||a.has(i)},forEach(o,a){const r=this,i=r.__v_raw,c=Ae(i),u=t?Va:e?ln:Lt;return!e&&ct(c,"iterate",Ps),i.forEach((f,d)=>o.call(a,u(f),u(d),r))}};return rt(s,e?{add:_o("add"),set:_o("set"),delete:_o("delete"),clear:_o("clear")}:{add(o){!t&&!Tt(o)&&!os(o)&&(o=Ae(o));const a=Ae(this);return bo(a).has.call(a,o)||(a.add(o),Xt(a,"add",o,o)),this},set(o,a){!t&&!Tt(a)&&!os(a)&&(a=Ae(a));const r=Ae(this),{has:i,get:c}=bo(r);let u=i.call(r,o);u||(o=Ae(o),u=i.call(r,o));const f=c.call(r,o);return r.set(o,a),u?ms(a,f)&&Xt(r,"set",o,a):Xt(r,"add",o,a),this},delete(o){const a=Ae(this),{has:r,get:i}=bo(a);let c=r.call(a,o);c||(o=Ae(o),c=r.call(a,o)),i&&i.call(a,o);const u=a.delete(o);return c&&Xt(a,"delete",o,void 0),u},clear(){const o=Ae(this),a=o.size!==0,r=o.clear();return a&&Xt(o,"clear",void 0,void 0),r}}),["keys","values","entries",Symbol.iterator].forEach(o=>{s[o]=yd(o,e,t)}),s}function Tr(e,t){const s=bd(e,t);return(n,o,a)=>o==="__v_isReactive"?!e:o==="__v_isReadonly"?e:o==="__v_raw"?n:Reflect.get(Te(s,o)&&o in n?s:n,o,a)}const _d={get:Tr(!1,!1)},wd={get:Tr(!1,!0)},Cd={get:Tr(!0,!1)};const Wi=new WeakMap,Vi=new WeakMap,Ki=new WeakMap,Sd=new WeakMap;function $d(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function kd(e){return e.__v_skip||!Object.isExtensible(e)?0:$d(qu(e))}function Vt(e){return os(e)?e:Nr(e,!1,vd,_d,Wi)}function Gi(e){return Nr(e,!1,gd,wd,Vi)}function Ka(e){return Nr(e,!0,hd,Cd,Ki)}function Nr(e,t,s,n,o){if(!Oe(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const a=kd(e);if(a===0)return e;const r=o.get(e);if(r)return r;const i=new Proxy(e,a===2?n:s);return o.set(e,i),i}function Ds(e){return os(e)?Ds(e.__v_raw):!!(e&&e.__v_isReactive)}function os(e){return!!(e&&e.__v_isReadonly)}function Tt(e){return!!(e&&e.__v_isShallow)}function Er(e){return e?!!e.__v_raw:!1}function Ae(e){const t=e&&e.__v_raw;return t?Ae(t):e}function xd(e){return!Te(e,"__v_skip")&&Object.isExtensible(e)&&Ti(e,"__v_skip",!0),e}const Lt=e=>Oe(e)?Vt(e):e,ln=e=>Oe(e)?Ka(e):e;function dt(e){return e?e.__v_isRef===!0:!1}function R(e){return zi(e,!1)}function Ad(e){return zi(e,!0)}function zi(e,t){return dt(e)?e:new Td(e,t)}class Td{constructor(t,s){this.dep=new Ar,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=s?t:Ae(t),this._value=s?t:Lt(t),this.__v_isShallow=s}get value(){return this.dep.track(),this._value}set value(t){const s=this._rawValue,n=this.__v_isShallow||Tt(t)||os(t);t=n?t:Ae(t),ms(t,s)&&(this._rawValue=t,this._value=n?t:Lt(t),this.dep.trigger())}}function B(e){return dt(e)?e.value:e}const Nd={get:(e,t,s)=>t==="__v_raw"?e:B(Reflect.get(e,t,s)),set:(e,t,s,n)=>{const o=e[t];return dt(o)&&!dt(s)?(o.value=s,!0):Reflect.set(e,t,s,n)}};function Ji(e){return Ds(e)?e:new Proxy(e,Nd)}class Ed{constructor(t,s,n){this.fn=t,this.setter=s,this._value=void 0,this.dep=new Ar(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Yn-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!s,this.isSSR=n}notify(){if(this.flags|=16,!(this.flags&8)&&Re!==this)return Pi(this,!0),!0}get value(){const t=this.dep.track();return Bi(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function Od(e,t,s=!1){let n,o;return we(e)?n=e:(n=e.get,o=e.set),new Ed(n,o,s)}const wo={},Lo=new WeakMap;let Os;function Id(e,t=!1,s=Os){if(s){let n=Lo.get(s);n||Lo.set(s,n=[]),n.push(e)}}function Rd(e,t,s=Ee){const{immediate:n,deep:o,once:a,scheduler:r,augmentJob:i,call:c}=s,u=A=>o?A:Tt(A)||o===!1||o===0?Qt(A,1):Qt(A);let f,d,p,h,g=!1,y=!1;if(dt(e)?(d=()=>e.value,g=Tt(e)):Ds(e)?(d=()=>u(e),g=!0):he(e)?(y=!0,g=e.some(A=>Ds(A)||Tt(A)),d=()=>e.map(A=>{if(dt(A))return A.value;if(Ds(A))return u(A);if(we(A))return c?c(A,2):A()})):we(e)?t?d=c?()=>c(e,2):e:d=()=>{if(p){ss();try{p()}finally{ns()}}const A=Os;Os=f;try{return c?c(e,3,[h]):e(h)}finally{Os=A}}:d=Wt,t&&o){const A=d,L=o===!0?1/0:o;d=()=>Qt(A(),L)}const $=ld(),C=()=>{f.stop(),$&&$.active&&wr($.effects,f)};if(a&&t){const A=t;t=(...L)=>{A(...L),C()}}let b=y?new Array(e.length).fill(wo):wo;const w=A=>{if(!(!(f.flags&1)||!f.dirty&&!A))if(t){const L=f.run();if(o||g||(y?L.some((V,U)=>ms(V,b[U])):ms(L,b))){p&&p();const V=Os;Os=f;try{const U=[L,b===wo?void 0:y&&b[0]===wo?[]:b,h];b=L,c?c(t,3,U):t(...U)}finally{Os=V}}}else f.run()};return i&&i(w),f=new Ii(d),f.scheduler=r?()=>r(w,!1):w,h=A=>Id(A,!1,f),p=f.onStop=()=>{const A=Lo.get(f);if(A){if(c)c(A,4);else for(const L of A)L();Lo.delete(f)}},t?n?w(!0):b=f.run():r?r(w.bind(null,!0),!0):f.run(),C.pause=f.pause.bind(f),C.resume=f.resume.bind(f),C.stop=C,C}function Qt(e,t=1/0,s){if(t<=0||!Oe(e)||e.__v_skip||(s=s||new Map,(s.get(e)||0)>=t))return e;if(s.set(e,t),t--,dt(e))Qt(e.value,t,s);else if(he(e))for(let n=0;n<e.length;n++)Qt(e[n],t,s);else if(yn(e)||sn(e))e.forEach(n=>{Qt(n,t,s)});else if(Ai(e)){for(const n in e)Qt(e[n],t,s);for(const n of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,n)&&Qt(e[n],t,s)}return e}/**
* @vue/runtime-core v3.5.27
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function uo(e,t,s,n){try{return n?e(...n):e()}catch(o){la(o,t,s)}}function Kt(e,t,s,n){if(we(e)){const o=uo(e,t,s,n);return o&&ki(o)&&o.catch(a=>{la(a,t,s)}),o}if(he(e)){const o=[];for(let a=0;a<e.length;a++)o.push(Kt(e[a],t,s,n));return o}}function la(e,t,s,n=!0){const o=t?t.vnode:null,{errorHandler:a,throwUnhandledErrorInProduction:r}=t&&t.appContext.config||Ee;if(t){let i=t.parent;const c=t.proxy,u=`https://vuejs.org/error-reference/#runtime-${s}`;for(;i;){const f=i.ec;if(f){for(let d=0;d<f.length;d++)if(f[d](e,c,u)===!1)return}i=i.parent}if(a){ss(),uo(a,null,10,[e,c,u]),ns();return}}Pd(e,s,o,n,r)}function Pd(e,t,s,n=!0,o=!1){if(o)throw e;console.error(e)}const vt=[];let Ft=-1;const nn=[];let us=null,Ks=0;const Yi=Promise.resolve();let Bo=null;function Xn(e){const t=Bo||Yi;return e?t.then(this?e.bind(this):e):t}function Dd(e){let t=Ft+1,s=vt.length;for(;t<s;){const n=t+s>>>1,o=vt[n],a=Qn(o);a<e||a===e&&o.flags&2?t=n+1:s=n}return t}function Or(e){if(!(e.flags&1)){const t=Qn(e),s=vt[vt.length-1];!s||!(e.flags&2)&&t>=Qn(s)?vt.push(e):vt.splice(Dd(t),0,e),e.flags|=1,qi()}}function qi(){Bo||(Bo=Yi.then(Qi))}function Ld(e){he(e)?nn.push(...e):us&&e.id===-1?us.splice(Ks+1,0,e):e.flags&1||(nn.push(e),e.flags|=1),qi()}function fl(e,t,s=Ft+1){for(;s<vt.length;s++){const n=vt[s];if(n&&n.flags&2){if(e&&n.id!==e.uid)continue;vt.splice(s,1),s--,n.flags&4&&(n.flags&=-2),n(),n.flags&4||(n.flags&=-2)}}}function Xi(e){if(nn.length){const t=[...new Set(nn)].sort((s,n)=>Qn(s)-Qn(n));if(nn.length=0,us){us.push(...t);return}for(us=t,Ks=0;Ks<us.length;Ks++){const s=us[Ks];s.flags&4&&(s.flags&=-2),s.flags&8||s(),s.flags&=-2}us=null,Ks=0}}const Qn=e=>e.id==null?e.flags&2?-1:1/0:e.id;function Qi(e){try{for(Ft=0;Ft<vt.length;Ft++){const t=vt[Ft];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),uo(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;Ft<vt.length;Ft++){const t=vt[Ft];t&&(t.flags&=-2)}Ft=-1,vt.length=0,Xi(),Bo=null,(vt.length||nn.length)&&Qi()}}let ot=null,Zi=null;function Mo(e){const t=ot;return ot=e,Zi=e&&e.type.__scopeId||null,t}function Bd(e,t=ot,s){if(!t||e._n)return e;const n=(...o)=>{n._d&&jo(-1);const a=Mo(t);let r;try{r=e(...o)}finally{Mo(a),n._d&&jo(1)}return r};return n._n=!0,n._c=!0,n._d=!0,n}function Be(e,t){if(ot===null)return e;const s=da(ot),n=e.dirs||(e.dirs=[]);for(let o=0;o<t.length;o++){let[a,r,i,c=Ee]=t[o];a&&(we(a)&&(a={mounted:a,updated:a}),a.deep&&Qt(r),n.push({dir:a,instance:s,value:r,oldValue:void 0,arg:i,modifiers:c}))}return e}function Cs(e,t,s,n){const o=e.dirs,a=t&&t.dirs;for(let r=0;r<o.length;r++){const i=o[r];a&&(i.oldValue=a[r].value);let c=i.dir[n];c&&(ss(),Kt(c,s,8,[e.el,i,e,t]),ns())}}function No(e,t){if(ut){let s=ut.provides;const n=ut.parent&&ut.parent.provides;n===s&&(s=ut.provides=Object.create(n)),s[e]=t}}function Pt(e,t,s=!1){const n=Ff();if(n||an){let o=an?an._context.provides:n?n.parent==null||n.ce?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides:void 0;if(o&&e in o)return o[e];if(arguments.length>1)return s&&we(t)?t.call(n&&n.proxy):t}}const Md=Symbol.for("v-scx"),Ud=()=>Pt(Md);function yt(e,t,s){return ec(e,t,s)}function ec(e,t,s=Ee){const{immediate:n,deep:o,flush:a,once:r}=s,i=rt({},s),c=t&&n||!t&&a!=="post";let u;if(so){if(a==="sync"){const h=Ud();u=h.__watcherHandles||(h.__watcherHandles=[])}else if(!c){const h=()=>{};return h.stop=Wt,h.resume=Wt,h.pause=Wt,h}}const f=ut;i.call=(h,g,y)=>Kt(h,f,g,y);let d=!1;a==="post"?i.scheduler=h=>{pt(h,f&&f.suspense)}:a!=="sync"&&(d=!0,i.scheduler=(h,g)=>{g?h():Or(h)}),i.augmentJob=h=>{t&&(h.flags|=4),d&&(h.flags|=2,f&&(h.id=f.uid,h.i=f))};const p=Rd(e,t,i);return so&&(u?u.push(p):c&&p()),p}function Fd(e,t,s){const n=this.proxy,o=Ge(e)?e.includes(".")?tc(n,e):()=>n[e]:e.bind(n,n);let a;we(t)?a=t:(a=t.handler,s=t);const r=fo(this),i=ec(o,a.bind(n),s);return r(),i}function tc(e,t){const s=t.split(".");return()=>{let n=e;for(let o=0;o<s.length&&n;o++)n=n[s[o]];return n}}const sc=Symbol("_vte"),jd=e=>e.__isTeleport,Mn=e=>e&&(e.disabled||e.disabled===""),pl=e=>e&&(e.defer||e.defer===""),ml=e=>typeof SVGElement<"u"&&e instanceof SVGElement,vl=e=>typeof MathMLElement=="function"&&e instanceof MathMLElement,Ga=(e,t)=>{const s=e&&e.to;return Ge(s)?t?t(s):null:s},nc={name:"Teleport",__isTeleport:!0,process(e,t,s,n,o,a,r,i,c,u){const{mc:f,pc:d,pbc:p,o:{insert:h,querySelector:g,createText:y,createComment:$}}=u,C=Mn(t.props);let{shapeFlag:b,children:w,dynamicChildren:A}=t;if(e==null){const L=t.el=y(""),V=t.anchor=y("");h(L,s,n),h(V,s,n);const U=(q,ue)=>{b&16&&f(w,q,ue,o,a,r,i,c)},X=()=>{const q=t.target=Ga(t.props,g),ue=oc(q,t,y,h);q&&(r!=="svg"&&ml(q)?r="svg":r!=="mathml"&&vl(q)&&(r="mathml"),o&&o.isCE&&(o.ce._teleportTargets||(o.ce._teleportTargets=new Set)).add(q),C||(U(q,ue),Eo(t,!1)))};C&&(U(s,V),Eo(t,!0)),pl(t.props)?(t.el.__isMounted=!1,pt(()=>{X(),delete t.el.__isMounted},a)):X()}else{if(pl(t.props)&&e.el.__isMounted===!1){pt(()=>{nc.process(e,t,s,n,o,a,r,i,c,u)},a);return}t.el=e.el,t.targetStart=e.targetStart;const L=t.anchor=e.anchor,V=t.target=e.target,U=t.targetAnchor=e.targetAnchor,X=Mn(e.props),q=X?s:V,ue=X?L:U;if(r==="svg"||ml(V)?r="svg":(r==="mathml"||vl(V))&&(r="mathml"),A?(p(e.dynamicChildren,A,q,o,a,r,i),Br(e,t,!0)):c||d(e,t,q,ue,o,a,r,i,!1),C)X?t.props&&e.props&&t.props.to!==e.props.to&&(t.props.to=e.props.to):Co(t,s,L,u,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const ve=t.target=Ga(t.props,g);ve&&Co(t,ve,null,u,0)}else X&&Co(t,V,U,u,1);Eo(t,C)}},remove(e,t,s,{um:n,o:{remove:o}},a){const{shapeFlag:r,children:i,anchor:c,targetStart:u,targetAnchor:f,target:d,props:p}=e;if(d&&(o(u),o(f)),a&&o(c),r&16){const h=a||!Mn(p);for(let g=0;g<i.length;g++){const y=i[g];n(y,t,s,h,!!y.dynamicChildren)}}},move:Co,hydrate:Hd};function Co(e,t,s,{o:{insert:n},m:o},a=2){a===0&&n(e.targetAnchor,t,s);const{el:r,anchor:i,shapeFlag:c,children:u,props:f}=e,d=a===2;if(d&&n(r,t,s),(!d||Mn(f))&&c&16)for(let p=0;p<u.length;p++)o(u[p],t,s,2);d&&n(i,t,s)}function Hd(e,t,s,n,o,a,{o:{nextSibling:r,parentNode:i,querySelector:c,insert:u,createText:f}},d){function p(y,$,C,b){$.anchor=d(r(y),$,i(y),s,n,o,a),$.targetStart=C,$.targetAnchor=b}const h=t.target=Ga(t.props,c),g=Mn(t.props);if(h){const y=h._lpa||h.firstChild;if(t.shapeFlag&16)if(g)p(e,t,y,y&&r(y));else{t.anchor=r(e);let $=y;for(;$;){if($&&$.nodeType===8){if($.data==="teleport start anchor")t.targetStart=$;else if($.data==="teleport anchor"){t.targetAnchor=$,h._lpa=t.targetAnchor&&r(t.targetAnchor);break}}$=r($)}t.targetAnchor||oc(h,t,f,u),d(y&&r(y),t,h,s,n,o,a)}Eo(t,g)}else g&&t.shapeFlag&16&&p(e,t,e,r(e));return t.anchor&&r(t.anchor)}const Wd=nc;function Eo(e,t){const s=e.ctx;if(s&&s.ut){let n,o;for(t?(n=e.el,o=e.anchor):(n=e.targetStart,o=e.targetAnchor);n&&n!==o;)n.nodeType===1&&n.setAttribute("data-v-owner",s.uid),n=n.nextSibling;s.ut()}}function oc(e,t,s,n){const o=t.targetStart=s(""),a=t.targetAnchor=s("");return o[sc]=a,e&&(n(o,e),n(a,e)),a}const Vd=Symbol("_leaveCb");function Ir(e,t){e.shapeFlag&6&&e.component?(e.transition=t,Ir(e.component.subTree,t)):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function ac(e,t){return we(e)?rt({name:e.name},t,{setup:e}):e}function rc(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}const Uo=new WeakMap;function Un(e,t,s,n,o=!1){if(he(e)){e.forEach((g,y)=>Un(g,t&&(he(t)?t[y]:t),s,n,o));return}if(on(n)&&!o){n.shapeFlag&512&&n.type.__asyncResolved&&n.component.subTree.component&&Un(e,t,s,n.component.subTree);return}const a=n.shapeFlag&4?da(n.component):n.el,r=o?null:a,{i,r:c}=e,u=t&&t.r,f=i.refs===Ee?i.refs={}:i.refs,d=i.setupState,p=Ae(d),h=d===Ee?$i:g=>Te(p,g);if(u!=null&&u!==c){if(hl(t),Ge(u))f[u]=null,h(u)&&(d[u]=null);else if(dt(u)){u.value=null;const g=t;g.k&&(f[g.k]=null)}}if(we(c))uo(c,i,12,[r,f]);else{const g=Ge(c),y=dt(c);if(g||y){const $=()=>{if(e.f){const C=g?h(c)?d[c]:f[c]:c.value;if(o)he(C)&&wr(C,a);else if(he(C))C.includes(a)||C.push(a);else if(g)f[c]=[a],h(c)&&(d[c]=f[c]);else{const b=[a];c.value=b,e.k&&(f[e.k]=b)}}else g?(f[c]=r,h(c)&&(d[c]=r)):y&&(c.value=r,e.k&&(f[e.k]=r))};if(r){const C=()=>{$(),Uo.delete(e)};C.id=-1,Uo.set(e,C),pt(C,s)}else hl(e),$()}}}function hl(e){const t=Uo.get(e);t&&(t.flags|=8,Uo.delete(e))}aa().requestIdleCallback;aa().cancelIdleCallback;const on=e=>!!e.type.__asyncLoader,lc=e=>e.type.__isKeepAlive;function Kd(e,t){ic(e,"a",t)}function Gd(e,t){ic(e,"da",t)}function ic(e,t,s=ut){const n=e.__wdc||(e.__wdc=()=>{let o=s;for(;o;){if(o.isDeactivated)return;o=o.parent}return e()});if(ia(t,n,s),s){let o=s.parent;for(;o&&o.parent;)lc(o.parent.vnode)&&zd(n,t,s,o),o=o.parent}}function zd(e,t,s,n){const o=ia(t,e,n,!0);Pr(()=>{wr(n[t],o)},s)}function ia(e,t,s=ut,n=!1){if(s){const o=s[e]||(s[e]=[]),a=t.__weh||(t.__weh=(...r)=>{ss();const i=fo(s),c=Kt(t,s,e,r);return i(),ns(),c});return n?o.unshift(a):o.push(a),a}}const rs=e=>(t,s=ut)=>{(!so||e==="sp")&&ia(e,(...n)=>t(...n),s)},Jd=rs("bm"),wt=rs("m"),Yd=rs("bu"),qd=rs("u"),Rr=rs("bum"),Pr=rs("um"),Xd=rs("sp"),Qd=rs("rtg"),Zd=rs("rtc");function ef(e,t=ut){ia("ec",e,t)}const tf="components";function sf(e,t){return of(tf,e,!0,t)||e}const nf=Symbol.for("v-ndc");function of(e,t,s=!0,n=!1){const o=ot||ut;if(o){const a=o.type;{const i=Kf(a,!1);if(i&&(i===t||i===Et(t)||i===na(Et(t))))return a}const r=gl(o[e]||a[e],t)||gl(o.appContext[e],t);return!r&&n?a:r}}function gl(e,t){return e&&(e[t]||e[Et(t)]||e[na(Et(t))])}function ae(e,t,s,n){let o;const a=s,r=he(e);if(r||Ge(e)){const i=r&&Ds(e);let c=!1,u=!1;i&&(c=!Tt(e),u=os(e),e=ra(e)),o=new Array(e.length);for(let f=0,d=e.length;f<d;f++)o[f]=t(c?u?ln(Lt(e[f])):Lt(e[f]):e[f],f,void 0,a)}else if(typeof e=="number"){o=new Array(e);for(let i=0;i<e;i++)o[i]=t(i+1,i,void 0,a)}else if(Oe(e))if(e[Symbol.iterator])o=Array.from(e,(i,c)=>t(i,c,void 0,a));else{const i=Object.keys(e);o=new Array(i.length);for(let c=0,u=i.length;c<u;c++){const f=i[c];o[c]=t(e[f],f,c,a)}}else o=[];return o}function af(e,t,s={},n,o){if(ot.ce||ot.parent&&on(ot.parent)&&ot.parent.ce){const u=Object.keys(s).length>0;return s.name=t,m(),Le(Q,null,[ge("slot",s,n)],u?-2:64)}let a=e[t];a&&a._c&&(a._d=!1),m();const r=a&&cc(a(s)),i=s.key||r&&r.key,c=Le(Q,{key:(i&&!Dt(i)?i:`_${t}`)+(!r&&n?"_fb":"")},r||[],r&&e._===1?64:-2);return a&&a._c&&(a._d=!0),c}function cc(e){return e.some(t=>eo(t)?!(t.type===as||t.type===Q&&!cc(t.children)):!0)?e:null}const za=e=>e?Ac(e)?da(e):za(e.parent):null,Fn=rt(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>za(e.parent),$root:e=>za(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>dc(e),$forceUpdate:e=>e.f||(e.f=()=>{Or(e.update)}),$nextTick:e=>e.n||(e.n=Xn.bind(e.proxy)),$watch:e=>Fd.bind(e)}),Sa=(e,t)=>e!==Ee&&!e.__isScriptSetup&&Te(e,t),rf={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:s,setupState:n,data:o,props:a,accessCache:r,type:i,appContext:c}=e;if(t[0]!=="$"){const p=r[t];if(p!==void 0)switch(p){case 1:return n[t];case 2:return o[t];case 4:return s[t];case 3:return a[t]}else{if(Sa(n,t))return r[t]=1,n[t];if(o!==Ee&&Te(o,t))return r[t]=2,o[t];if(Te(a,t))return r[t]=3,a[t];if(s!==Ee&&Te(s,t))return r[t]=4,s[t];Ja&&(r[t]=0)}}const u=Fn[t];let f,d;if(u)return t==="$attrs"&&ct(e.attrs,"get",""),u(e);if((f=i.__cssModules)&&(f=f[t]))return f;if(s!==Ee&&Te(s,t))return r[t]=4,s[t];if(d=c.config.globalProperties,Te(d,t))return d[t]},set({_:e},t,s){const{data:n,setupState:o,ctx:a}=e;return Sa(o,t)?(o[t]=s,!0):n!==Ee&&Te(n,t)?(n[t]=s,!0):Te(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(a[t]=s,!0)},has({_:{data:e,setupState:t,accessCache:s,ctx:n,appContext:o,props:a,type:r}},i){let c;return!!(s[i]||e!==Ee&&i[0]!=="$"&&Te(e,i)||Sa(t,i)||Te(a,i)||Te(n,i)||Te(Fn,i)||Te(o.config.globalProperties,i)||(c=r.__cssModules)&&c[i])},defineProperty(e,t,s){return s.get!=null?e._.accessCache[t]=0:Te(s,"value")&&this.set(e,t,s.value,null),Reflect.defineProperty(e,t,s)}};function yl(e){return he(e)?e.reduce((t,s)=>(t[s]=null,t),{}):e}let Ja=!0;function lf(e){const t=dc(e),s=e.proxy,n=e.ctx;Ja=!1,t.beforeCreate&&bl(t.beforeCreate,e,"bc");const{data:o,computed:a,methods:r,watch:i,provide:c,inject:u,created:f,beforeMount:d,mounted:p,beforeUpdate:h,updated:g,activated:y,deactivated:$,beforeDestroy:C,beforeUnmount:b,destroyed:w,unmounted:A,render:L,renderTracked:V,renderTriggered:U,errorCaptured:X,serverPrefetch:q,expose:ue,inheritAttrs:ve,components:de,directives:ye,filters:Se}=t;if(u&&cf(u,n,null),r)for(const H in r){const O=r[H];we(O)&&(n[H]=O.bind(s))}if(o){const H=o.call(s,s);Oe(H)&&(e.data=Vt(H))}if(Ja=!0,a)for(const H in a){const O=a[H],M=we(O)?O.bind(s,s):we(O.get)?O.get.bind(s,s):Wt,j=!we(O)&&we(O.set)?O.set.bind(s):Wt,D=E({get:M,set:j});Object.defineProperty(n,H,{enumerable:!0,configurable:!0,get:()=>D.value,set:ee=>D.value=ee})}if(i)for(const H in i)uc(i[H],n,s,H);if(c){const H=we(c)?c.call(s):c;Reflect.ownKeys(H).forEach(O=>{No(O,H[O])})}f&&bl(f,e,"c");function ie(H,O){he(O)?O.forEach(M=>H(M.bind(s))):O&&H(O.bind(s))}if(ie(Jd,d),ie(wt,p),ie(Yd,h),ie(qd,g),ie(Kd,y),ie(Gd,$),ie(ef,X),ie(Zd,V),ie(Qd,U),ie(Rr,b),ie(Pr,A),ie(Xd,q),he(ue))if(ue.length){const H=e.exposed||(e.exposed={});ue.forEach(O=>{Object.defineProperty(H,O,{get:()=>s[O],set:M=>s[O]=M,enumerable:!0})})}else e.exposed||(e.exposed={});L&&e.render===Wt&&(e.render=L),ve!=null&&(e.inheritAttrs=ve),de&&(e.components=de),ye&&(e.directives=ye),q&&rc(e)}function cf(e,t,s=Wt){he(e)&&(e=Ya(e));for(const n in e){const o=e[n];let a;Oe(o)?"default"in o?a=Pt(o.from||n,o.default,!0):a=Pt(o.from||n):a=Pt(o),dt(a)?Object.defineProperty(t,n,{enumerable:!0,configurable:!0,get:()=>a.value,set:r=>a.value=r}):t[n]=a}}function bl(e,t,s){Kt(he(e)?e.map(n=>n.bind(t.proxy)):e.bind(t.proxy),t,s)}function uc(e,t,s,n){let o=n.includes(".")?tc(s,n):()=>s[n];if(Ge(e)){const a=t[e];we(a)&&yt(o,a)}else if(we(e))yt(o,e.bind(s));else if(Oe(e))if(he(e))e.forEach(a=>uc(a,t,s,n));else{const a=we(e.handler)?e.handler.bind(s):t[e.handler];we(a)&&yt(o,a,e)}}function dc(e){const t=e.type,{mixins:s,extends:n}=t,{mixins:o,optionsCache:a,config:{optionMergeStrategies:r}}=e.appContext,i=a.get(t);let c;return i?c=i:!o.length&&!s&&!n?c=t:(c={},o.length&&o.forEach(u=>Fo(c,u,r,!0)),Fo(c,t,r)),Oe(t)&&a.set(t,c),c}function Fo(e,t,s,n=!1){const{mixins:o,extends:a}=t;a&&Fo(e,a,s,!0),o&&o.forEach(r=>Fo(e,r,s,!0));for(const r in t)if(!(n&&r==="expose")){const i=uf[r]||s&&s[r];e[r]=i?i(e[r],t[r]):t[r]}return e}const uf={data:_l,props:wl,emits:wl,methods:Rn,computed:Rn,beforeCreate:ft,created:ft,beforeMount:ft,mounted:ft,beforeUpdate:ft,updated:ft,beforeDestroy:ft,beforeUnmount:ft,destroyed:ft,unmounted:ft,activated:ft,deactivated:ft,errorCaptured:ft,serverPrefetch:ft,components:Rn,directives:Rn,watch:ff,provide:_l,inject:df};function _l(e,t){return t?e?function(){return rt(we(e)?e.call(this,this):e,we(t)?t.call(this,this):t)}:t:e}function df(e,t){return Rn(Ya(e),Ya(t))}function Ya(e){if(he(e)){const t={};for(let s=0;s<e.length;s++)t[e[s]]=e[s];return t}return e}function ft(e,t){return e?[...new Set([].concat(e,t))]:t}function Rn(e,t){return e?rt(Object.create(null),e,t):t}function wl(e,t){return e?he(e)&&he(t)?[...new Set([...e,...t])]:rt(Object.create(null),yl(e),yl(t??{})):t}function ff(e,t){if(!e)return t;if(!t)return e;const s=rt(Object.create(null),e);for(const n in t)s[n]=ft(e[n],t[n]);return s}function fc(){return{app:null,config:{isNativeTag:$i,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let pf=0;function mf(e,t){return function(n,o=null){we(n)||(n=rt({},n)),o!=null&&!Oe(o)&&(o=null);const a=fc(),r=new WeakSet,i=[];let c=!1;const u=a.app={_uid:pf++,_component:n,_props:o,_container:null,_context:a,_instance:null,version:zf,get config(){return a.config},set config(f){},use(f,...d){return r.has(f)||(f&&we(f.install)?(r.add(f),f.install(u,...d)):we(f)&&(r.add(f),f(u,...d))),u},mixin(f){return a.mixins.includes(f)||a.mixins.push(f),u},component(f,d){return d?(a.components[f]=d,u):a.components[f]},directive(f,d){return d?(a.directives[f]=d,u):a.directives[f]},mount(f,d,p){if(!c){const h=u._ceVNode||ge(n,o);return h.appContext=a,p===!0?p="svg":p===!1&&(p=void 0),e(h,f,p),c=!0,u._container=f,f.__vue_app__=u,da(h.component)}},onUnmount(f){i.push(f)},unmount(){c&&(Kt(i,u._instance,16),e(null,u._container),delete u._container.__vue_app__)},provide(f,d){return a.provides[f]=d,u},runWithContext(f){const d=an;an=u;try{return f()}finally{an=d}}};return u}}let an=null;const vf=(e,t)=>t==="modelValue"||t==="model-value"?e.modelModifiers:e[`${t}Modifiers`]||e[`${Et(t)}Modifiers`]||e[`${_s(t)}Modifiers`];function hf(e,t,...s){if(e.isUnmounted)return;const n=e.vnode.props||Ee;let o=s;const a=t.startsWith("update:"),r=a&&vf(n,t.slice(7));r&&(r.trim&&(o=s.map(f=>Ge(f)?f.trim():f)),r.number&&(o=s.map(oa)));let i,c=n[i=ya(t)]||n[i=ya(Et(t))];!c&&a&&(c=n[i=ya(_s(t))]),c&&Kt(c,e,6,o);const u=n[i+"Once"];if(u){if(!e.emitted)e.emitted={};else if(e.emitted[i])return;e.emitted[i]=!0,Kt(u,e,6,o)}}const gf=new WeakMap;function pc(e,t,s=!1){const n=s?gf:t.emitsCache,o=n.get(e);if(o!==void 0)return o;const a=e.emits;let r={},i=!1;if(!we(e)){const c=u=>{const f=pc(u,t,!0);f&&(i=!0,rt(r,f))};!s&&t.mixins.length&&t.mixins.forEach(c),e.extends&&c(e.extends),e.mixins&&e.mixins.forEach(c)}return!a&&!i?(Oe(e)&&n.set(e,null),null):(he(a)?a.forEach(c=>r[c]=null):rt(r,a),Oe(e)&&n.set(e,r),r)}function ca(e,t){return!e||!ta(t)?!1:(t=t.slice(2).replace(/Once$/,""),Te(e,t[0].toLowerCase()+t.slice(1))||Te(e,_s(t))||Te(e,t))}function Cl(e){const{type:t,vnode:s,proxy:n,withProxy:o,propsOptions:[a],slots:r,attrs:i,emit:c,render:u,renderCache:f,props:d,data:p,setupState:h,ctx:g,inheritAttrs:y}=e,$=Mo(e);let C,b;try{if(s.shapeFlag&4){const A=o||n,L=A;C=jt(u.call(L,A,f,d,h,p,g)),b=i}else{const A=t;C=jt(A.length>1?A(d,{attrs:i,slots:r,emit:c}):A(d,null)),b=t.props?i:yf(i)}}catch(A){jn.length=0,la(A,e,1),C=ge(as)}let w=C;if(b&&y!==!1){const A=Object.keys(b),{shapeFlag:L}=w;A.length&&L&7&&(a&&A.some(_r)&&(b=bf(b,a)),w=cn(w,b,!1,!0))}return s.dirs&&(w=cn(w,null,!1,!0),w.dirs=w.dirs?w.dirs.concat(s.dirs):s.dirs),s.transition&&Ir(w,s.transition),C=w,Mo($),C}const yf=e=>{let t;for(const s in e)(s==="class"||s==="style"||ta(s))&&((t||(t={}))[s]=e[s]);return t},bf=(e,t)=>{const s={};for(const n in e)(!_r(n)||!(n.slice(9)in t))&&(s[n]=e[n]);return s};function _f(e,t,s){const{props:n,children:o,component:a}=e,{props:r,children:i,patchFlag:c}=t,u=a.emitsOptions;if(t.dirs||t.transition)return!0;if(s&&c>=0){if(c&1024)return!0;if(c&16)return n?Sl(n,r,u):!!r;if(c&8){const f=t.dynamicProps;for(let d=0;d<f.length;d++){const p=f[d];if(r[p]!==n[p]&&!ca(u,p))return!0}}}else return(o||i)&&(!i||!i.$stable)?!0:n===r?!1:n?r?Sl(n,r,u):!0:!!r;return!1}function Sl(e,t,s){const n=Object.keys(t);if(n.length!==Object.keys(e).length)return!0;for(let o=0;o<n.length;o++){const a=n[o];if(t[a]!==e[a]&&!ca(s,a))return!0}return!1}function wf({vnode:e,parent:t},s){for(;t;){const n=t.subTree;if(n.suspense&&n.suspense.activeBranch===e&&(n.el=e.el),n===e)(e=t.vnode).el=s,t=t.parent;else break}}const mc={},vc=()=>Object.create(mc),hc=e=>Object.getPrototypeOf(e)===mc;function Cf(e,t,s,n=!1){const o={},a=vc();e.propsDefaults=Object.create(null),gc(e,t,o,a);for(const r in e.propsOptions[0])r in o||(o[r]=void 0);s?e.props=n?o:Gi(o):e.type.props?e.props=o:e.props=a,e.attrs=a}function Sf(e,t,s,n){const{props:o,attrs:a,vnode:{patchFlag:r}}=e,i=Ae(o),[c]=e.propsOptions;let u=!1;if((n||r>0)&&!(r&16)){if(r&8){const f=e.vnode.dynamicProps;for(let d=0;d<f.length;d++){let p=f[d];if(ca(e.emitsOptions,p))continue;const h=t[p];if(c)if(Te(a,p))h!==a[p]&&(a[p]=h,u=!0);else{const g=Et(p);o[g]=qa(c,i,g,h,e,!1)}else h!==a[p]&&(a[p]=h,u=!0)}}}else{gc(e,t,o,a)&&(u=!0);let f;for(const d in i)(!t||!Te(t,d)&&((f=_s(d))===d||!Te(t,f)))&&(c?s&&(s[d]!==void 0||s[f]!==void 0)&&(o[d]=qa(c,i,d,void 0,e,!0)):delete o[d]);if(a!==i)for(const d in a)(!t||!Te(t,d))&&(delete a[d],u=!0)}u&&Xt(e.attrs,"set","")}function gc(e,t,s,n){const[o,a]=e.propsOptions;let r=!1,i;if(t)for(let c in t){if(Dn(c))continue;const u=t[c];let f;o&&Te(o,f=Et(c))?!a||!a.includes(f)?s[f]=u:(i||(i={}))[f]=u:ca(e.emitsOptions,c)||(!(c in n)||u!==n[c])&&(n[c]=u,r=!0)}if(a){const c=Ae(s),u=i||Ee;for(let f=0;f<a.length;f++){const d=a[f];s[d]=qa(o,c,d,u[d],e,!Te(u,d))}}return r}function qa(e,t,s,n,o,a){const r=e[s];if(r!=null){const i=Te(r,"default");if(i&&n===void 0){const c=r.default;if(r.type!==Function&&!r.skipFactory&&we(c)){const{propsDefaults:u}=o;if(s in u)n=u[s];else{const f=fo(o);n=u[s]=c.call(null,t),f()}}else n=c;o.ce&&o.ce._setProp(s,n)}r[0]&&(a&&!i?n=!1:r[1]&&(n===""||n===_s(s))&&(n=!0))}return n}const $f=new WeakMap;function yc(e,t,s=!1){const n=s?$f:t.propsCache,o=n.get(e);if(o)return o;const a=e.props,r={},i=[];let c=!1;if(!we(e)){const f=d=>{c=!0;const[p,h]=yc(d,t,!0);rt(r,p),h&&i.push(...h)};!s&&t.mixins.length&&t.mixins.forEach(f),e.extends&&f(e.extends),e.mixins&&e.mixins.forEach(f)}if(!a&&!c)return Oe(e)&&n.set(e,tn),tn;if(he(a))for(let f=0;f<a.length;f++){const d=Et(a[f]);$l(d)&&(r[d]=Ee)}else if(a)for(const f in a){const d=Et(f);if($l(d)){const p=a[f],h=r[d]=he(p)||we(p)?{type:p}:rt({},p),g=h.type;let y=!1,$=!0;if(he(g))for(let C=0;C<g.length;++C){const b=g[C],w=we(b)&&b.name;if(w==="Boolean"){y=!0;break}else w==="String"&&($=!1)}else y=we(g)&&g.name==="Boolean";h[0]=y,h[1]=$,(y||Te(h,"default"))&&i.push(d)}}const u=[r,i];return Oe(e)&&n.set(e,u),u}function $l(e){return e[0]!=="$"&&!Dn(e)}const Dr=e=>e==="_"||e==="_ctx"||e==="$stable",Lr=e=>he(e)?e.map(jt):[jt(e)],kf=(e,t,s)=>{if(t._n)return t;const n=Bd((...o)=>Lr(t(...o)),s);return n._c=!1,n},bc=(e,t,s)=>{const n=e._ctx;for(const o in e){if(Dr(o))continue;const a=e[o];if(we(a))t[o]=kf(o,a,n);else if(a!=null){const r=Lr(a);t[o]=()=>r}}},_c=(e,t)=>{const s=Lr(t);e.slots.default=()=>s},wc=(e,t,s)=>{for(const n in t)(s||!Dr(n))&&(e[n]=t[n])},xf=(e,t,s)=>{const n=e.slots=vc();if(e.vnode.shapeFlag&32){const o=t._;o?(wc(n,t,s),s&&Ti(n,"_",o,!0)):bc(t,n)}else t&&_c(e,t)},Af=(e,t,s)=>{const{vnode:n,slots:o}=e;let a=!0,r=Ee;if(n.shapeFlag&32){const i=t._;i?s&&i===1?a=!1:wc(o,t,s):(a=!t.$stable,bc(t,o)),r=t}else t&&(_c(e,t),r={default:1});if(a)for(const i in o)!Dr(i)&&r[i]==null&&delete o[i]},pt=If;function Tf(e){return Nf(e)}function Nf(e,t){const s=aa();s.__VUE__=!0;const{insert:n,remove:o,patchProp:a,createElement:r,createText:i,createComment:c,setText:u,setElementText:f,parentNode:d,nextSibling:p,setScopeId:h=Wt,insertStaticContent:g}=e,y=(S,k,P,G=null,Y=null,z=null,se=void 0,te=null,N=!!k.dynamicChildren)=>{if(S===k)return;S&&!$n(S,k)&&(G=J(S),ee(S,Y,z,!0),S=null),k.patchFlag===-2&&(N=!1,k.dynamicChildren=null);const{type:T,ref:W,shapeFlag:x}=k;switch(T){case ua:$(S,k,P,G);break;case as:C(S,k,P,G);break;case Oo:S==null&&b(k,P,G,se);break;case Q:de(S,k,P,G,Y,z,se,te,N);break;default:x&1?L(S,k,P,G,Y,z,se,te,N):x&6?ye(S,k,P,G,Y,z,se,te,N):(x&64||x&128)&&T.process(S,k,P,G,Y,z,se,te,N,ce)}W!=null&&Y?Un(W,S&&S.ref,z,k||S,!k):W==null&&S&&S.ref!=null&&Un(S.ref,null,z,S,!0)},$=(S,k,P,G)=>{if(S==null)n(k.el=i(k.children),P,G);else{const Y=k.el=S.el;k.children!==S.children&&u(Y,k.children)}},C=(S,k,P,G)=>{S==null?n(k.el=c(k.children||""),P,G):k.el=S.el},b=(S,k,P,G)=>{[S.el,S.anchor]=g(S.children,k,P,G,S.el,S.anchor)},w=({el:S,anchor:k},P,G)=>{let Y;for(;S&&S!==k;)Y=p(S),n(S,P,G),S=Y;n(k,P,G)},A=({el:S,anchor:k})=>{let P;for(;S&&S!==k;)P=p(S),o(S),S=P;o(k)},L=(S,k,P,G,Y,z,se,te,N)=>{if(k.type==="svg"?se="svg":k.type==="math"&&(se="mathml"),S==null)V(k,P,G,Y,z,se,te,N);else{const T=S.el&&S.el._isVueCE?S.el:null;try{T&&T._beginPatch(),q(S,k,Y,z,se,te,N)}finally{T&&T._endPatch()}}},V=(S,k,P,G,Y,z,se,te)=>{let N,T;const{props:W,shapeFlag:x,transition:I,dirs:K}=S;if(N=S.el=r(S.type,z,W&&W.is,W),x&8?f(N,S.children):x&16&&X(S.children,N,null,G,Y,$a(S,z),se,te),K&&Cs(S,null,G,"created"),U(N,S,S.scopeId,se,G),W){for(const oe in W)oe!=="value"&&!Dn(oe)&&a(N,oe,null,W[oe],z,G);"value"in W&&a(N,"value",null,W.value,z),(T=W.onVnodeBeforeMount)&&Mt(T,G,S)}K&&Cs(S,null,G,"beforeMount");const Z=Ef(Y,I);Z&&I.beforeEnter(N),n(N,k,P),((T=W&&W.onVnodeMounted)||Z||K)&&pt(()=>{T&&Mt(T,G,S),Z&&I.enter(N),K&&Cs(S,null,G,"mounted")},Y)},U=(S,k,P,G,Y)=>{if(P&&h(S,P),G)for(let z=0;z<G.length;z++)h(S,G[z]);if(Y){let z=Y.subTree;if(k===z||$c(z.type)&&(z.ssContent===k||z.ssFallback===k)){const se=Y.vnode;U(S,se,se.scopeId,se.slotScopeIds,Y.parent)}}},X=(S,k,P,G,Y,z,se,te,N=0)=>{for(let T=N;T<S.length;T++){const W=S[T]=te?ds(S[T]):jt(S[T]);y(null,W,k,P,G,Y,z,se,te)}},q=(S,k,P,G,Y,z,se)=>{const te=k.el=S.el;let{patchFlag:N,dynamicChildren:T,dirs:W}=k;N|=S.patchFlag&16;const x=S.props||Ee,I=k.props||Ee;let K;if(P&&Ss(P,!1),(K=I.onVnodeBeforeUpdate)&&Mt(K,P,k,S),W&&Cs(k,S,P,"beforeUpdate"),P&&Ss(P,!0),(x.innerHTML&&I.innerHTML==null||x.textContent&&I.textContent==null)&&f(te,""),T?ue(S.dynamicChildren,T,te,P,G,$a(k,Y),z):se||O(S,k,te,null,P,G,$a(k,Y),z,!1),N>0){if(N&16)ve(te,x,I,P,Y);else if(N&2&&x.class!==I.class&&a(te,"class",null,I.class,Y),N&4&&a(te,"style",x.style,I.style,Y),N&8){const Z=k.dynamicProps;for(let oe=0;oe<Z.length;oe++){const pe=Z[oe],_e=x[pe],me=I[pe];(me!==_e||pe==="value")&&a(te,pe,_e,me,Y,P)}}N&1&&S.children!==k.children&&f(te,k.children)}else!se&&T==null&&ve(te,x,I,P,Y);((K=I.onVnodeUpdated)||W)&&pt(()=>{K&&Mt(K,P,k,S),W&&Cs(k,S,P,"updated")},G)},ue=(S,k,P,G,Y,z,se)=>{for(let te=0;te<k.length;te++){const N=S[te],T=k[te],W=N.el&&(N.type===Q||!$n(N,T)||N.shapeFlag&198)?d(N.el):P;y(N,T,W,null,G,Y,z,se,!0)}},ve=(S,k,P,G,Y)=>{if(k!==P){if(k!==Ee)for(const z in k)!Dn(z)&&!(z in P)&&a(S,z,k[z],null,Y,G);for(const z in P){if(Dn(z))continue;const se=P[z],te=k[z];se!==te&&z!=="value"&&a(S,z,te,se,Y,G)}"value"in P&&a(S,"value",k.value,P.value,Y)}},de=(S,k,P,G,Y,z,se,te,N)=>{const T=k.el=S?S.el:i(""),W=k.anchor=S?S.anchor:i("");let{patchFlag:x,dynamicChildren:I,slotScopeIds:K}=k;K&&(te=te?te.concat(K):K),S==null?(n(T,P,G),n(W,P,G),X(k.children||[],P,W,Y,z,se,te,N)):x>0&&x&64&&I&&S.dynamicChildren&&S.dynamicChildren.length===I.length?(ue(S.dynamicChildren,I,P,Y,z,se,te),(k.key!=null||Y&&k===Y.subTree)&&Br(S,k,!0)):O(S,k,P,W,Y,z,se,te,N)},ye=(S,k,P,G,Y,z,se,te,N)=>{k.slotScopeIds=te,S==null?k.shapeFlag&512?Y.ctx.activate(k,P,G,se,N):Se(k,P,G,Y,z,se,N):fe(S,k,N)},Se=(S,k,P,G,Y,z,se)=>{const te=S.component=Uf(S,G,Y);if(lc(S)&&(te.ctx.renderer=ce),jf(te,!1,se),te.asyncDep){if(Y&&Y.registerDep(te,ie,se),!S.el){const N=te.subTree=ge(as);C(null,N,k,P),S.placeholder=N.el}}else ie(te,S,k,P,Y,z,se)},fe=(S,k,P)=>{const G=k.component=S.component;if(_f(S,k,P))if(G.asyncDep&&!G.asyncResolved){H(G,k,P);return}else G.next=k,G.update();else k.el=S.el,G.vnode=k},ie=(S,k,P,G,Y,z,se)=>{const te=()=>{if(S.isMounted){let{next:x,bu:I,u:K,parent:Z,vnode:oe}=S;{const Je=Cc(S);if(Je){x&&(x.el=oe.el,H(S,x,se)),Je.asyncDep.then(()=>{S.isUnmounted||te()});return}}let pe=x,_e;Ss(S,!1),x?(x.el=oe.el,H(S,x,se)):x=oe,I&&To(I),(_e=x.props&&x.props.onVnodeBeforeUpdate)&&Mt(_e,Z,x,oe),Ss(S,!0);const me=Cl(S),Ve=S.subTree;S.subTree=me,y(Ve,me,d(Ve.el),J(Ve),S,Y,z),x.el=me.el,pe===null&&wf(S,me.el),K&&pt(K,Y),(_e=x.props&&x.props.onVnodeUpdated)&&pt(()=>Mt(_e,Z,x,oe),Y)}else{let x;const{el:I,props:K}=k,{bm:Z,m:oe,parent:pe,root:_e,type:me}=S,Ve=on(k);Ss(S,!1),Z&&To(Z),!Ve&&(x=K&&K.onVnodeBeforeMount)&&Mt(x,pe,k),Ss(S,!0);{_e.ce&&_e.ce._def.shadowRoot!==!1&&_e.ce._injectChildStyle(me);const Je=S.subTree=Cl(S);y(null,Je,P,G,S,Y,z),k.el=Je.el}if(oe&&pt(oe,Y),!Ve&&(x=K&&K.onVnodeMounted)){const Je=k;pt(()=>Mt(x,pe,Je),Y)}(k.shapeFlag&256||pe&&on(pe.vnode)&&pe.vnode.shapeFlag&256)&&S.a&&pt(S.a,Y),S.isMounted=!0,k=P=G=null}};S.scope.on();const N=S.effect=new Ii(te);S.scope.off();const T=S.update=N.run.bind(N),W=S.job=N.runIfDirty.bind(N);W.i=S,W.id=S.uid,N.scheduler=()=>Or(W),Ss(S,!0),T()},H=(S,k,P)=>{k.component=S;const G=S.vnode.props;S.vnode=k,S.next=null,Sf(S,k.props,G,P),Af(S,k.children,P),ss(),fl(S),ns()},O=(S,k,P,G,Y,z,se,te,N=!1)=>{const T=S&&S.children,W=S?S.shapeFlag:0,x=k.children,{patchFlag:I,shapeFlag:K}=k;if(I>0){if(I&128){j(T,x,P,G,Y,z,se,te,N);return}else if(I&256){M(T,x,P,G,Y,z,se,te,N);return}}K&8?(W&16&&Fe(T,Y,z),x!==T&&f(P,x)):W&16?K&16?j(T,x,P,G,Y,z,se,te,N):Fe(T,Y,z,!0):(W&8&&f(P,""),K&16&&X(x,P,G,Y,z,se,te,N))},M=(S,k,P,G,Y,z,se,te,N)=>{S=S||tn,k=k||tn;const T=S.length,W=k.length,x=Math.min(T,W);let I;for(I=0;I<x;I++){const K=k[I]=N?ds(k[I]):jt(k[I]);y(S[I],K,P,null,Y,z,se,te,N)}T>W?Fe(S,Y,z,!0,!1,x):X(k,P,G,Y,z,se,te,N,x)},j=(S,k,P,G,Y,z,se,te,N)=>{let T=0;const W=k.length;let x=S.length-1,I=W-1;for(;T<=x&&T<=I;){const K=S[T],Z=k[T]=N?ds(k[T]):jt(k[T]);if($n(K,Z))y(K,Z,P,null,Y,z,se,te,N);else break;T++}for(;T<=x&&T<=I;){const K=S[x],Z=k[I]=N?ds(k[I]):jt(k[I]);if($n(K,Z))y(K,Z,P,null,Y,z,se,te,N);else break;x--,I--}if(T>x){if(T<=I){const K=I+1,Z=K<W?k[K].el:G;for(;T<=I;)y(null,k[T]=N?ds(k[T]):jt(k[T]),P,Z,Y,z,se,te,N),T++}}else if(T>I)for(;T<=x;)ee(S[T],Y,z,!0),T++;else{const K=T,Z=T,oe=new Map;for(T=Z;T<=I;T++){const Ke=k[T]=N?ds(k[T]):jt(k[T]);Ke.key!=null&&oe.set(Ke.key,T)}let pe,_e=0;const me=I-Z+1;let Ve=!1,Je=0;const Ze=new Array(me);for(T=0;T<me;T++)Ze[T]=0;for(T=K;T<=x;T++){const Ke=S[T];if(_e>=me){ee(Ke,Y,z,!0);continue}let $e;if(Ke.key!=null)$e=oe.get(Ke.key);else for(pe=Z;pe<=I;pe++)if(Ze[pe-Z]===0&&$n(Ke,k[pe])){$e=pe;break}$e===void 0?ee(Ke,Y,z,!0):(Ze[$e-Z]=T+1,$e>=Je?Je=$e:Ve=!0,y(Ke,k[$e],P,null,Y,z,se,te,N),_e++)}const Gt=Ve?Of(Ze):tn;for(pe=Gt.length-1,T=me-1;T>=0;T--){const Ke=Z+T,$e=k[Ke],qe=k[Ke+1],et=Ke+1<W?qe.el||Sc(qe):G;Ze[T]===0?y(null,$e,P,et,Y,z,se,te,N):Ve&&(pe<0||T!==Gt[pe]?D($e,P,et,2):pe--)}}},D=(S,k,P,G,Y=null)=>{const{el:z,type:se,transition:te,children:N,shapeFlag:T}=S;if(T&6){D(S.component.subTree,k,P,G);return}if(T&128){S.suspense.move(k,P,G);return}if(T&64){se.move(S,k,P,ce);return}if(se===Q){n(z,k,P);for(let x=0;x<N.length;x++)D(N[x],k,P,G);n(S.anchor,k,P);return}if(se===Oo){w(S,k,P);return}if(G!==2&&T&1&&te)if(G===0)te.beforeEnter(z),n(z,k,P),pt(()=>te.enter(z),Y);else{const{leave:x,delayLeave:I,afterLeave:K}=te,Z=()=>{S.ctx.isUnmounted?o(z):n(z,k,P)},oe=()=>{z._isLeaving&&z[Vd](!0),x(z,()=>{Z(),K&&K()})};I?I(z,Z,oe):oe()}else n(z,k,P)},ee=(S,k,P,G=!1,Y=!1)=>{const{type:z,props:se,ref:te,children:N,dynamicChildren:T,shapeFlag:W,patchFlag:x,dirs:I,cacheIndex:K}=S;if(x===-2&&(Y=!1),te!=null&&(ss(),Un(te,null,P,S,!0),ns()),K!=null&&(k.renderCache[K]=void 0),W&256){k.ctx.deactivate(S);return}const Z=W&1&&I,oe=!on(S);let pe;if(oe&&(pe=se&&se.onVnodeBeforeUnmount)&&Mt(pe,k,S),W&6)Ue(S.component,P,G);else{if(W&128){S.suspense.unmount(P,G);return}Z&&Cs(S,null,k,"beforeUnmount"),W&64?S.type.remove(S,k,P,ce,G):T&&!T.hasOnce&&(z!==Q||x>0&&x&64)?Fe(T,k,P,!1,!0):(z===Q&&x&384||!Y&&W&16)&&Fe(N,k,P),G&&ke(S)}(oe&&(pe=se&&se.onVnodeUnmounted)||Z)&&pt(()=>{pe&&Mt(pe,k,S),Z&&Cs(S,null,k,"unmounted")},P)},ke=S=>{const{type:k,el:P,anchor:G,transition:Y}=S;if(k===Q){Me(P,G);return}if(k===Oo){A(S);return}const z=()=>{o(P),Y&&!Y.persisted&&Y.afterLeave&&Y.afterLeave()};if(S.shapeFlag&1&&Y&&!Y.persisted){const{leave:se,delayLeave:te}=Y,N=()=>se(P,z);te?te(S.el,z,N):N()}else z()},Me=(S,k)=>{let P;for(;S!==k;)P=p(S),o(S),S=P;o(k)},Ue=(S,k,P)=>{const{bum:G,scope:Y,job:z,subTree:se,um:te,m:N,a:T}=S;kl(N),kl(T),G&&To(G),Y.stop(),z&&(z.flags|=8,ee(se,S,k,P)),te&&pt(te,k),pt(()=>{S.isUnmounted=!0},k)},Fe=(S,k,P,G=!1,Y=!1,z=0)=>{for(let se=z;se<S.length;se++)ee(S[se],k,P,G,Y)},J=S=>{if(S.shapeFlag&6)return J(S.component.subTree);if(S.shapeFlag&128)return S.suspense.next();const k=p(S.anchor||S.el),P=k&&k[sc];return P?p(P):k};let re=!1;const ne=(S,k,P)=>{let G;S==null?k._vnode&&(ee(k._vnode,null,null,!0),G=k._vnode.component):y(k._vnode||null,S,k,null,null,null,P),k._vnode=S,re||(re=!0,fl(G),Xi(),re=!1)},ce={p:y,um:ee,m:D,r:ke,mt:Se,mc:X,pc:O,pbc:ue,n:J,o:e};return{render:ne,hydrate:void 0,createApp:mf(ne)}}function $a({type:e,props:t},s){return s==="svg"&&e==="foreignObject"||s==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:s}function Ss({effect:e,job:t},s){s?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function Ef(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function Br(e,t,s=!1){const n=e.children,o=t.children;if(he(n)&&he(o))for(let a=0;a<n.length;a++){const r=n[a];let i=o[a];i.shapeFlag&1&&!i.dynamicChildren&&((i.patchFlag<=0||i.patchFlag===32)&&(i=o[a]=ds(o[a]),i.el=r.el),!s&&i.patchFlag!==-2&&Br(r,i)),i.type===ua&&(i.patchFlag!==-1?i.el=r.el:i.__elIndex=a+(e.type===Q?1:0)),i.type===as&&!i.el&&(i.el=r.el)}}function Of(e){const t=e.slice(),s=[0];let n,o,a,r,i;const c=e.length;for(n=0;n<c;n++){const u=e[n];if(u!==0){if(o=s[s.length-1],e[o]<u){t[n]=o,s.push(n);continue}for(a=0,r=s.length-1;a<r;)i=a+r>>1,e[s[i]]<u?a=i+1:r=i;u<e[s[a]]&&(a>0&&(t[n]=s[a-1]),s[a]=n)}}for(a=s.length,r=s[a-1];a-- >0;)s[a]=r,r=t[r];return s}function Cc(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:Cc(t)}function kl(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}function Sc(e){if(e.placeholder)return e.placeholder;const t=e.component;return t?Sc(t.subTree):null}const $c=e=>e.__isSuspense;function If(e,t){t&&t.pendingBranch?he(e)?t.effects.push(...e):t.effects.push(e):Ld(e)}const Q=Symbol.for("v-fgt"),ua=Symbol.for("v-txt"),as=Symbol.for("v-cmt"),Oo=Symbol.for("v-stc"),jn=[];let kt=null;function m(e=!1){jn.push(kt=e?null:[])}function Rf(){jn.pop(),kt=jn[jn.length-1]||null}let Zn=1;function jo(e,t=!1){Zn+=e,e<0&&kt&&t&&(kt.hasOnce=!0)}function kc(e){return e.dynamicChildren=Zn>0?kt||tn:null,Rf(),Zn>0&&kt&&kt.push(e),e}function v(e,t,s,n,o,a){return kc(l(e,t,s,n,o,a,!0))}function Le(e,t,s,n,o){return kc(ge(e,t,s,n,o,!0))}function eo(e){return e?e.__v_isVNode===!0:!1}function $n(e,t){return e.type===t.type&&e.key===t.key}const xc=({key:e})=>e??null,Io=({ref:e,ref_key:t,ref_for:s})=>(typeof e=="number"&&(e=""+e),e!=null?Ge(e)||dt(e)||we(e)?{i:ot,r:e,k:t,f:!!s}:e:null);function l(e,t=null,s=null,n=0,o=null,a=e===Q?0:1,r=!1,i=!1){const c={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&xc(t),ref:t&&Io(t),scopeId:Zi,slotScopeIds:null,children:s,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:a,patchFlag:n,dynamicProps:o,dynamicChildren:null,appContext:null,ctx:ot};return i?(Mr(c,s),a&128&&e.normalize(c)):s&&(c.shapeFlag|=Ge(s)?8:16),Zn>0&&!r&&kt&&(c.patchFlag>0||a&6)&&c.patchFlag!==32&&kt.push(c),c}const ge=Pf;function Pf(e,t=null,s=null,n=0,o=null,a=!1){if((!e||e===nf)&&(e=as),eo(e)){const i=cn(e,t,!0);return s&&Mr(i,s),Zn>0&&!a&&kt&&(i.shapeFlag&6?kt[kt.indexOf(e)]=i:kt.push(i)),i.patchFlag=-2,i}if(Gf(e)&&(e=e.__vccOpts),t){t=Df(t);let{class:i,style:c}=t;i&&!Ge(i)&&(t.class=le(i)),Oe(c)&&(Er(c)&&!he(c)&&(c=rt({},c)),t.style=st(c))}const r=Ge(e)?1:$c(e)?128:jd(e)?64:Oe(e)?4:we(e)?2:0;return l(e,t,s,n,o,r,a,!0)}function Df(e){return e?Er(e)||hc(e)?rt({},e):e:null}function cn(e,t,s=!1,n=!1){const{props:o,ref:a,patchFlag:r,children:i,transition:c}=e,u=t?Lf(o||{},t):o,f={__v_isVNode:!0,__v_skip:!0,type:e.type,props:u,key:u&&xc(u),ref:t&&t.ref?s&&a?he(a)?a.concat(Io(t)):[a,Io(t)]:Io(t):a,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:i,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Q?r===-1?16:r|16:r,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:c,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&cn(e.ssContent),ssFallback:e.ssFallback&&cn(e.ssFallback),placeholder:e.placeholder,el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return c&&n&&Ir(f,c.clone(f)),f}function Ne(e=" ",t=0){return ge(ua,null,e,t)}function to(e,t){const s=ge(Oo,null,e);return s.staticCount=t,s}function F(e="",t=!1){return t?(m(),Le(as,null,e)):ge(as,null,e)}function jt(e){return e==null||typeof e=="boolean"?ge(as):he(e)?ge(Q,null,e.slice()):eo(e)?ds(e):ge(ua,null,String(e))}function ds(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:cn(e)}function Mr(e,t){let s=0;const{shapeFlag:n}=e;if(t==null)t=null;else if(he(t))s=16;else if(typeof t=="object")if(n&65){const o=t.default;o&&(o._c&&(o._d=!1),Mr(e,o()),o._c&&(o._d=!0));return}else{s=32;const o=t._;!o&&!hc(t)?t._ctx=ot:o===3&&ot&&(ot.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else we(t)?(t={default:t,_ctx:ot},s=32):(t=String(t),n&64?(s=16,t=[Ne(t)]):s=8);e.children=t,e.shapeFlag|=s}function Lf(...e){const t={};for(let s=0;s<e.length;s++){const n=e[s];for(const o in n)if(o==="class")t.class!==n.class&&(t.class=le([t.class,n.class]));else if(o==="style")t.style=st([t.style,n.style]);else if(ta(o)){const a=t[o],r=n[o];r&&a!==r&&!(he(a)&&a.includes(r))&&(t[o]=a?[].concat(a,r):r)}else o!==""&&(t[o]=n[o])}return t}function Mt(e,t,s,n=null){Kt(e,t,7,[s,n])}const Bf=fc();let Mf=0;function Uf(e,t,s){const n=e.type,o=(t?t.appContext:e.appContext)||Bf,a={uid:Mf++,vnode:e,type:n,parent:t,appContext:o,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new rd(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(o.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:yc(n,o),emitsOptions:pc(n,o),emit:null,emitted:null,propsDefaults:Ee,inheritAttrs:n.inheritAttrs,ctx:Ee,data:Ee,props:Ee,attrs:Ee,slots:Ee,refs:Ee,setupState:Ee,setupContext:null,suspense:s,suspenseId:s?s.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return a.ctx={_:a},a.root=t?t.root:a,a.emit=hf.bind(null,a),e.ce&&e.ce(a),a}let ut=null;const Ff=()=>ut||ot;let Ho,Xa;{const e=aa(),t=(s,n)=>{let o;return(o=e[s])||(o=e[s]=[]),o.push(n),a=>{o.length>1?o.forEach(r=>r(a)):o[0](a)}};Ho=t("__VUE_INSTANCE_SETTERS__",s=>ut=s),Xa=t("__VUE_SSR_SETTERS__",s=>so=s)}const fo=e=>{const t=ut;return Ho(e),e.scope.on(),()=>{e.scope.off(),Ho(t)}},xl=()=>{ut&&ut.scope.off(),Ho(null)};function Ac(e){return e.vnode.shapeFlag&4}let so=!1;function jf(e,t=!1,s=!1){t&&Xa(t);const{props:n,children:o}=e.vnode,a=Ac(e);Cf(e,n,a,t),xf(e,o,s||t);const r=a?Hf(e,t):void 0;return t&&Xa(!1),r}function Hf(e,t){const s=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,rf);const{setup:n}=s;if(n){ss();const o=e.setupContext=n.length>1?Vf(e):null,a=fo(e),r=uo(n,e,0,[e.props,o]),i=ki(r);if(ns(),a(),(i||e.sp)&&!on(e)&&rc(e),i){if(r.then(xl,xl),t)return r.then(c=>{Al(e,c)}).catch(c=>{la(c,e,0)});e.asyncDep=r}else Al(e,r)}else Tc(e)}function Al(e,t,s){we(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:Oe(t)&&(e.setupState=Ji(t)),Tc(e)}function Tc(e,t,s){const n=e.type;e.render||(e.render=n.render||Wt);{const o=fo(e);ss();try{lf(e)}finally{ns(),o()}}}const Wf={get(e,t){return ct(e,"get",""),e[t]}};function Vf(e){const t=s=>{e.exposed=s||{}};return{attrs:new Proxy(e.attrs,Wf),slots:e.slots,emit:e.emit,expose:t}}function da(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(Ji(xd(e.exposed)),{get(t,s){if(s in t)return t[s];if(s in Fn)return Fn[s](e)},has(t,s){return s in t||s in Fn}})):e.proxy}function Kf(e,t=!0){return we(e)?e.displayName||e.name:e.name||t&&e.__name}function Gf(e){return we(e)&&"__vccOpts"in e}const E=(e,t)=>Od(e,t,so);function Nc(e,t,s){try{jo(-1);const n=arguments.length;return n===2?Oe(t)&&!he(t)?eo(t)?ge(e,null,[t]):ge(e,t):ge(e,null,t):(n>3?s=Array.prototype.slice.call(arguments,2):n===3&&eo(s)&&(s=[s]),ge(e,t,s))}finally{jo(1)}}const zf="3.5.27";/**
* @vue/runtime-dom v3.5.27
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Qa;const Tl=typeof window<"u"&&window.trustedTypes;if(Tl)try{Qa=Tl.createPolicy("vue",{createHTML:e=>e})}catch{}const Ec=Qa?e=>Qa.createHTML(e):e=>e,Jf="http://www.w3.org/2000/svg",Yf="http://www.w3.org/1998/Math/MathML",qt=typeof document<"u"?document:null,Nl=qt&&qt.createElement("template"),qf={insert:(e,t,s)=>{t.insertBefore(e,s||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,s,n)=>{const o=t==="svg"?qt.createElementNS(Jf,e):t==="mathml"?qt.createElementNS(Yf,e):s?qt.createElement(e,{is:s}):qt.createElement(e);return e==="select"&&n&&n.multiple!=null&&o.setAttribute("multiple",n.multiple),o},createText:e=>qt.createTextNode(e),createComment:e=>qt.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>qt.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,s,n,o,a){const r=s?s.previousSibling:t.lastChild;if(o&&(o===a||o.nextSibling))for(;t.insertBefore(o.cloneNode(!0),s),!(o===a||!(o=o.nextSibling)););else{Nl.innerHTML=Ec(n==="svg"?`<svg>${e}</svg>`:n==="mathml"?`<math>${e}</math>`:e);const i=Nl.content;if(n==="svg"||n==="mathml"){const c=i.firstChild;for(;c.firstChild;)i.appendChild(c.firstChild);i.removeChild(c)}t.insertBefore(i,s)}return[r?r.nextSibling:t.firstChild,s?s.previousSibling:t.lastChild]}},Xf=Symbol("_vtc");function Qf(e,t,s){const n=e[Xf];n&&(t=(t?[t,...n]:[...n]).join(" ")),t==null?e.removeAttribute("class"):s?e.setAttribute("class",t):e.className=t}const Wo=Symbol("_vod"),Oc=Symbol("_vsh"),Zf={name:"show",beforeMount(e,{value:t},{transition:s}){e[Wo]=e.style.display==="none"?"":e.style.display,s&&t?s.beforeEnter(e):kn(e,t)},mounted(e,{value:t},{transition:s}){s&&t&&s.enter(e)},updated(e,{value:t,oldValue:s},{transition:n}){!t!=!s&&(n?t?(n.beforeEnter(e),kn(e,!0),n.enter(e)):n.leave(e,()=>{kn(e,!1)}):kn(e,t))},beforeUnmount(e,{value:t}){kn(e,t)}};function kn(e,t){e.style.display=t?e[Wo]:"none",e[Oc]=!t}const ep=Symbol(""),tp=/(?:^|;)\s*display\s*:/;function sp(e,t,s){const n=e.style,o=Ge(s);let a=!1;if(s&&!o){if(t)if(Ge(t))for(const r of t.split(";")){const i=r.slice(0,r.indexOf(":")).trim();s[i]==null&&Ro(n,i,"")}else for(const r in t)s[r]==null&&Ro(n,r,"");for(const r in s)r==="display"&&(a=!0),Ro(n,r,s[r])}else if(o){if(t!==s){const r=n[ep];r&&(s+=";"+r),n.cssText=s,a=tp.test(s)}}else t&&e.removeAttribute("style");Wo in e&&(e[Wo]=a?n.display:"",e[Oc]&&(n.display="none"))}const El=/\s*!important$/;function Ro(e,t,s){if(he(s))s.forEach(n=>Ro(e,t,n));else if(s==null&&(s=""),t.startsWith("--"))e.setProperty(t,s);else{const n=np(e,t);El.test(s)?e.setProperty(_s(n),s.replace(El,""),"important"):e[n]=s}}const Ol=["Webkit","Moz","ms"],ka={};function np(e,t){const s=ka[t];if(s)return s;let n=Et(t);if(n!=="filter"&&n in e)return ka[t]=n;n=na(n);for(let o=0;o<Ol.length;o++){const a=Ol[o]+n;if(a in e)return ka[t]=a}return t}const Il="http://www.w3.org/1999/xlink";function Rl(e,t,s,n,o,a=od(t)){n&&t.startsWith("xlink:")?s==null?e.removeAttributeNS(Il,t.slice(6,t.length)):e.setAttributeNS(Il,t,s):s==null||a&&!Ni(s)?e.removeAttribute(t):e.setAttribute(t,a?"":Dt(s)?String(s):s)}function Pl(e,t,s,n,o){if(t==="innerHTML"||t==="textContent"){s!=null&&(e[t]=t==="innerHTML"?Ec(s):s);return}const a=e.tagName;if(t==="value"&&a!=="PROGRESS"&&!a.includes("-")){const i=a==="OPTION"?e.getAttribute("value")||"":e.value,c=s==null?e.type==="checkbox"?"on":"":String(s);(i!==c||!("_value"in e))&&(e.value=c),s==null&&e.removeAttribute(t),e._value=s;return}let r=!1;if(s===""||s==null){const i=typeof e[t];i==="boolean"?s=Ni(s):s==null&&i==="string"?(s="",r=!0):i==="number"&&(s=0,r=!0)}try{e[t]=s}catch{}r&&e.removeAttribute(o||t)}function Zt(e,t,s,n){e.addEventListener(t,s,n)}function op(e,t,s,n){e.removeEventListener(t,s,n)}const Dl=Symbol("_vei");function ap(e,t,s,n,o=null){const a=e[Dl]||(e[Dl]={}),r=a[t];if(n&&r)r.value=n;else{const[i,c]=rp(t);if(n){const u=a[t]=cp(n,o);Zt(e,i,u,c)}else r&&(op(e,i,r,c),a[t]=void 0)}}const Ll=/(?:Once|Passive|Capture)$/;function rp(e){let t;if(Ll.test(e)){t={};let n;for(;n=e.match(Ll);)e=e.slice(0,e.length-n[0].length),t[n[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):_s(e.slice(2)),t]}let xa=0;const lp=Promise.resolve(),ip=()=>xa||(lp.then(()=>xa=0),xa=Date.now());function cp(e,t){const s=n=>{if(!n._vts)n._vts=Date.now();else if(n._vts<=s.attached)return;Kt(up(n,s.value),t,5,[n])};return s.value=e,s.attached=ip(),s}function up(e,t){if(he(t)){const s=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{s.call(e),e._stopped=!0},t.map(n=>o=>!o._stopped&&n&&n(o))}else return t}const Bl=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,dp=(e,t,s,n,o,a)=>{const r=o==="svg";t==="class"?Qf(e,n,r):t==="style"?sp(e,s,n):ta(t)?_r(t)||ap(e,t,s,n,a):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):fp(e,t,n,r))?(Pl(e,t,n),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&Rl(e,t,n,r,a,t!=="value")):e._isVueCE&&(/[A-Z]/.test(t)||!Ge(n))?Pl(e,Et(t),n,a,t):(t==="true-value"?e._trueValue=n:t==="false-value"&&(e._falseValue=n),Rl(e,t,n,r))};function fp(e,t,s,n){if(n)return!!(t==="innerHTML"||t==="textContent"||t in e&&Bl(t)&&we(s));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="autocorrect"||t==="sandbox"&&e.tagName==="IFRAME"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const o=e.tagName;if(o==="IMG"||o==="VIDEO"||o==="CANVAS"||o==="SOURCE")return!1}return Bl(t)&&Ge(s)?!1:t in e}const ys=e=>{const t=e.props["onUpdate:modelValue"]||!1;return he(t)?s=>To(t,s):t};function pp(e){e.target.composing=!0}function Ml(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const Nt=Symbol("_assign");function Ul(e,t,s){return t&&(e=e.trim()),s&&(e=oa(e)),e}const bt={created(e,{modifiers:{lazy:t,trim:s,number:n}},o){e[Nt]=ys(o);const a=n||o.props&&o.props.type==="number";Zt(e,t?"change":"input",r=>{r.target.composing||e[Nt](Ul(e.value,s,a))}),(s||a)&&Zt(e,"change",()=>{e.value=Ul(e.value,s,a)}),t||(Zt(e,"compositionstart",pp),Zt(e,"compositionend",Ml),Zt(e,"change",Ml))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,oldValue:s,modifiers:{lazy:n,trim:o,number:a}},r){if(e[Nt]=ys(r),e.composing)return;const i=(a||e.type==="number")&&!/^0\d/.test(e.value)?oa(e.value):e.value,c=t??"";i!==c&&(document.activeElement===e&&e.type!=="range"&&(n&&t===s||o&&e.value.trim()===c)||(e.value=c))}},Ur={deep:!0,created(e,t,s){e[Nt]=ys(s),Zt(e,"change",()=>{const n=e._modelValue,o=un(e),a=e.checked,r=e[Nt];if(he(n)){const i=Sr(n,o),c=i!==-1;if(a&&!c)r(n.concat(o));else if(!a&&c){const u=[...n];u.splice(i,1),r(u)}}else if(yn(n)){const i=new Set(n);a?i.add(o):i.delete(o),r(i)}else r(Ic(e,a))})},mounted:Fl,beforeUpdate(e,t,s){e[Nt]=ys(s),Fl(e,t,s)}};function Fl(e,{value:t,oldValue:s},n){e._modelValue=t;let o;if(he(t))o=Sr(t,n.props.value)>-1;else if(yn(t))o=t.has(n.props.value);else{if(t===s)return;o=Bs(t,Ic(e,!0))}e.checked!==o&&(e.checked=o)}const jl={created(e,{value:t},s){e.checked=Bs(t,s.props.value),e[Nt]=ys(s),Zt(e,"change",()=>{e[Nt](un(e))})},beforeUpdate(e,{value:t,oldValue:s},n){e[Nt]=ys(n),t!==s&&(e.checked=Bs(t,n.props.value))}},Hn={deep:!0,created(e,{value:t,modifiers:{number:s}},n){const o=yn(t);Zt(e,"change",()=>{const a=Array.prototype.filter.call(e.options,r=>r.selected).map(r=>s?oa(un(r)):un(r));e[Nt](e.multiple?o?new Set(a):a:a[0]),e._assigning=!0,Xn(()=>{e._assigning=!1})}),e[Nt]=ys(n)},mounted(e,{value:t}){Hl(e,t)},beforeUpdate(e,t,s){e[Nt]=ys(s)},updated(e,{value:t}){e._assigning||Hl(e,t)}};function Hl(e,t){const s=e.multiple,n=he(t);if(!(s&&!n&&!yn(t))){for(let o=0,a=e.options.length;o<a;o++){const r=e.options[o],i=un(r);if(s)if(n){const c=typeof i;c==="string"||c==="number"?r.selected=t.some(u=>String(u)===String(i)):r.selected=Sr(t,i)>-1}else r.selected=t.has(i);else if(Bs(un(r),t)){e.selectedIndex!==o&&(e.selectedIndex=o);return}}!s&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}}function un(e){return"_value"in e?e._value:e.value}function Ic(e,t){const s=t?"_trueValue":"_falseValue";return s in e?e[s]:t}const mp=["ctrl","shift","alt","meta"],vp={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>mp.some(s=>e[`${s}Key`]&&!t.includes(s))},_t=(e,t)=>{const s=e._withMods||(e._withMods={}),n=t.join(".");return s[n]||(s[n]=(o,...a)=>{for(let r=0;r<t.length;r++){const i=vp[t[r]];if(i&&i(o,t))return}return e(o,...a)})},hp={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},Vo=(e,t)=>{const s=e._withKeys||(e._withKeys={}),n=t.join(".");return s[n]||(s[n]=o=>{if(!("key"in o))return;const a=_s(o.key);if(t.some(r=>r===a||hp[r]===a))return e(o)})},gp=rt({patchProp:dp},qf);let Wl;function yp(){return Wl||(Wl=Tf(gp))}const bp=(...e)=>{const t=yp().createApp(...e),{mount:s}=t;return t.mount=n=>{const o=wp(n);if(!o)return;const a=t._component;!we(a)&&!a.render&&!a.template&&(a.template=o.innerHTML),o.nodeType===1&&(o.textContent="");const r=s(o,!1,_p(o));return o instanceof Element&&(o.removeAttribute("v-cloak"),o.setAttribute("data-v-app","")),r},t};function _p(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function wp(e){return Ge(e)?document.querySelector(e):e}const be=(e,t)=>{const s=e.__vccOpts||e;for(const[n,o]of t)s[n]=o;return s},Cp={};function Sp(e,t){const s=sf("router-view");return m(),Le(s)}const $p=be(Cp,[["render",Sp]]),kp="modulepreload",xp=function(e){return"/"+e},Vl={},Ap=function(t,s,n){let o=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const r=document.querySelector("meta[property=csp-nonce]"),i=(r==null?void 0:r.nonce)||(r==null?void 0:r.getAttribute("nonce"));o=Promise.allSettled(s.map(c=>{if(c=xp(c),c in Vl)return;Vl[c]=!0;const u=c.endsWith(".css"),f=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${f}`))return;const d=document.createElement("link");if(d.rel=u?"stylesheet":kp,u||(d.as="script"),d.crossOrigin="",d.href=c,i&&d.setAttribute("nonce",i),document.head.appendChild(d),u)return new Promise((p,h)=>{d.addEventListener("load",p),d.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${c}`)))})}))}function a(r){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=r,window.dispatchEvent(i),!i.defaultPrevented)throw r}return o.then(r=>{for(const i of r||[])i.status==="rejected"&&a(i.reason);return t().catch(a)})};/*!
 * vue-router v4.6.4
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */const Gs=typeof document<"u";function Rc(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function Tp(e){return e.__esModule||e[Symbol.toStringTag]==="Module"||e.default&&Rc(e.default)}const xe=Object.assign;function Aa(e,t){const s={};for(const n in t){const o=t[n];s[n]=Bt(o)?o.map(e):e(o)}return s}const Wn=()=>{},Bt=Array.isArray;function Kl(e,t){const s={};for(const n in e)s[n]=n in t?t[n]:e[n];return s}const Pc=/#/g,Np=/&/g,Ep=/\//g,Op=/=/g,Ip=/\?/g,Dc=/\+/g,Rp=/%5B/g,Pp=/%5D/g,Lc=/%5E/g,Dp=/%60/g,Bc=/%7B/g,Lp=/%7C/g,Mc=/%7D/g,Bp=/%20/g;function Fr(e){return e==null?"":encodeURI(""+e).replace(Lp,"|").replace(Rp,"[").replace(Pp,"]")}function Mp(e){return Fr(e).replace(Bc,"{").replace(Mc,"}").replace(Lc,"^")}function Za(e){return Fr(e).replace(Dc,"%2B").replace(Bp,"+").replace(Pc,"%23").replace(Np,"%26").replace(Dp,"`").replace(Bc,"{").replace(Mc,"}").replace(Lc,"^")}function Up(e){return Za(e).replace(Op,"%3D")}function Fp(e){return Fr(e).replace(Pc,"%23").replace(Ip,"%3F")}function jp(e){return Fp(e).replace(Ep,"%2F")}function no(e){if(e==null)return null;try{return decodeURIComponent(""+e)}catch{}return""+e}const Hp=/\/$/,Wp=e=>e.replace(Hp,"");function Ta(e,t,s="/"){let n,o={},a="",r="";const i=t.indexOf("#");let c=t.indexOf("?");return c=i>=0&&c>i?-1:c,c>=0&&(n=t.slice(0,c),a=t.slice(c,i>0?i:t.length),o=e(a.slice(1))),i>=0&&(n=n||t.slice(0,i),r=t.slice(i,t.length)),n=zp(n??t,s),{fullPath:n+a+r,path:n,query:o,hash:no(r)}}function Vp(e,t){const s=t.query?e(t.query):"";return t.path+(s&&"?")+s+(t.hash||"")}function Gl(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function Kp(e,t,s){const n=t.matched.length-1,o=s.matched.length-1;return n>-1&&n===o&&dn(t.matched[n],s.matched[o])&&Uc(t.params,s.params)&&e(t.query)===e(s.query)&&t.hash===s.hash}function dn(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function Uc(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(var s in e)if(!Gp(e[s],t[s]))return!1;return!0}function Gp(e,t){return Bt(e)?zl(e,t):Bt(t)?zl(t,e):(e==null?void 0:e.valueOf())===(t==null?void 0:t.valueOf())}function zl(e,t){return Bt(t)?e.length===t.length&&e.every((s,n)=>s===t[n]):e.length===1&&e[0]===t}function zp(e,t){if(e.startsWith("/"))return e;if(!e)return t;const s=t.split("/"),n=e.split("/"),o=n[n.length-1];(o===".."||o===".")&&n.push("");let a=s.length-1,r,i;for(r=0;r<n.length;r++)if(i=n[r],i!==".")if(i==="..")a>1&&a--;else break;return s.slice(0,a).join("/")+"/"+n.slice(r).join("/")}const is={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};let er=function(e){return e.pop="pop",e.push="push",e}({}),Na=function(e){return e.back="back",e.forward="forward",e.unknown="",e}({});function Jp(e){if(!e)if(Gs){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),Wp(e)}const Yp=/^[^#]+#/;function qp(e,t){return e.replace(Yp,"#")+t}function Xp(e,t){const s=document.documentElement.getBoundingClientRect(),n=e.getBoundingClientRect();return{behavior:t.behavior,left:n.left-s.left-(t.left||0),top:n.top-s.top-(t.top||0)}}const fa=()=>({left:window.scrollX,top:window.scrollY});function Qp(e){let t;if("el"in e){const s=e.el,n=typeof s=="string"&&s.startsWith("#"),o=typeof s=="string"?n?document.getElementById(s.slice(1)):document.querySelector(s):s;if(!o)return;t=Xp(o,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.scrollX,t.top!=null?t.top:window.scrollY)}function Jl(e,t){return(history.state?history.state.position-t:-1)+e}const tr=new Map;function Zp(e,t){tr.set(e,t)}function em(e){const t=tr.get(e);return tr.delete(e),t}function tm(e){return typeof e=="string"||e&&typeof e=="object"}function Fc(e){return typeof e=="string"||typeof e=="symbol"}let He=function(e){return e[e.MATCHER_NOT_FOUND=1]="MATCHER_NOT_FOUND",e[e.NAVIGATION_GUARD_REDIRECT=2]="NAVIGATION_GUARD_REDIRECT",e[e.NAVIGATION_ABORTED=4]="NAVIGATION_ABORTED",e[e.NAVIGATION_CANCELLED=8]="NAVIGATION_CANCELLED",e[e.NAVIGATION_DUPLICATED=16]="NAVIGATION_DUPLICATED",e}({});const jc=Symbol("");He.MATCHER_NOT_FOUND+"",He.NAVIGATION_GUARD_REDIRECT+"",He.NAVIGATION_ABORTED+"",He.NAVIGATION_CANCELLED+"",He.NAVIGATION_DUPLICATED+"";function fn(e,t){return xe(new Error,{type:e,[jc]:!0},t)}function Jt(e,t){return e instanceof Error&&jc in e&&(t==null||!!(e.type&t))}const sm=["params","query","hash"];function nm(e){if(typeof e=="string")return e;if(e.path!=null)return e.path;const t={};for(const s of sm)s in e&&(t[s]=e[s]);return JSON.stringify(t,null,2)}function om(e){const t={};if(e===""||e==="?")return t;const s=(e[0]==="?"?e.slice(1):e).split("&");for(let n=0;n<s.length;++n){const o=s[n].replace(Dc," "),a=o.indexOf("="),r=no(a<0?o:o.slice(0,a)),i=a<0?null:no(o.slice(a+1));if(r in t){let c=t[r];Bt(c)||(c=t[r]=[c]),c.push(i)}else t[r]=i}return t}function Yl(e){let t="";for(let s in e){const n=e[s];if(s=Up(s),n==null){n!==void 0&&(t+=(t.length?"&":"")+s);continue}(Bt(n)?n.map(o=>o&&Za(o)):[n&&Za(n)]).forEach(o=>{o!==void 0&&(t+=(t.length?"&":"")+s,o!=null&&(t+="="+o))})}return t}function am(e){const t={};for(const s in e){const n=e[s];n!==void 0&&(t[s]=Bt(n)?n.map(o=>o==null?null:""+o):n==null?n:""+n)}return t}const rm=Symbol(""),ql=Symbol(""),pa=Symbol(""),jr=Symbol(""),sr=Symbol("");function xn(){let e=[];function t(n){return e.push(n),()=>{const o=e.indexOf(n);o>-1&&e.splice(o,1)}}function s(){e=[]}return{add:t,list:()=>e.slice(),reset:s}}function fs(e,t,s,n,o,a=r=>r()){const r=n&&(n.enterCallbacks[o]=n.enterCallbacks[o]||[]);return()=>new Promise((i,c)=>{const u=p=>{p===!1?c(fn(He.NAVIGATION_ABORTED,{from:s,to:t})):p instanceof Error?c(p):tm(p)?c(fn(He.NAVIGATION_GUARD_REDIRECT,{from:t,to:p})):(r&&n.enterCallbacks[o]===r&&typeof p=="function"&&r.push(p),i())},f=a(()=>e.call(n&&n.instances[o],t,s,u));let d=Promise.resolve(f);e.length<3&&(d=d.then(u)),d.catch(p=>c(p))})}function Ea(e,t,s,n,o=a=>a()){const a=[];for(const r of e)for(const i in r.components){let c=r.components[i];if(!(t!=="beforeRouteEnter"&&!r.instances[i]))if(Rc(c)){const u=(c.__vccOpts||c)[t];u&&a.push(fs(u,s,n,r,i,o))}else{let u=c();a.push(()=>u.then(f=>{if(!f)throw new Error(`Couldn't resolve component "${i}" at "${r.path}"`);const d=Tp(f)?f.default:f;r.mods[i]=f,r.components[i]=d;const p=(d.__vccOpts||d)[t];return p&&fs(p,s,n,r,i,o)()}))}}return a}function lm(e,t){const s=[],n=[],o=[],a=Math.max(t.matched.length,e.matched.length);for(let r=0;r<a;r++){const i=t.matched[r];i&&(e.matched.find(u=>dn(u,i))?n.push(i):s.push(i));const c=e.matched[r];c&&(t.matched.find(u=>dn(u,c))||o.push(c))}return[s,n,o]}/*!
 * vue-router v4.6.4
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */let im=()=>location.protocol+"//"+location.host;function Hc(e,t){const{pathname:s,search:n,hash:o}=t,a=e.indexOf("#");if(a>-1){let r=o.includes(e.slice(a))?e.slice(a).length:1,i=o.slice(r);return i[0]!=="/"&&(i="/"+i),Gl(i,"")}return Gl(s,e)+n+o}function cm(e,t,s,n){let o=[],a=[],r=null;const i=({state:p})=>{const h=Hc(e,location),g=s.value,y=t.value;let $=0;if(p){if(s.value=h,t.value=p,r&&r===g){r=null;return}$=y?p.position-y.position:0}else n(h);o.forEach(C=>{C(s.value,g,{delta:$,type:er.pop,direction:$?$>0?Na.forward:Na.back:Na.unknown})})};function c(){r=s.value}function u(p){o.push(p);const h=()=>{const g=o.indexOf(p);g>-1&&o.splice(g,1)};return a.push(h),h}function f(){if(document.visibilityState==="hidden"){const{history:p}=window;if(!p.state)return;p.replaceState(xe({},p.state,{scroll:fa()}),"")}}function d(){for(const p of a)p();a=[],window.removeEventListener("popstate",i),window.removeEventListener("pagehide",f),document.removeEventListener("visibilitychange",f)}return window.addEventListener("popstate",i),window.addEventListener("pagehide",f),document.addEventListener("visibilitychange",f),{pauseListeners:c,listen:u,destroy:d}}function Xl(e,t,s,n=!1,o=!1){return{back:e,current:t,forward:s,replaced:n,position:window.history.length,scroll:o?fa():null}}function um(e){const{history:t,location:s}=window,n={value:Hc(e,s)},o={value:t.state};o.value||a(n.value,{back:null,current:n.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function a(c,u,f){const d=e.indexOf("#"),p=d>-1?(s.host&&document.querySelector("base")?e:e.slice(d))+c:im()+e+c;try{t[f?"replaceState":"pushState"](u,"",p),o.value=u}catch(h){console.error(h),s[f?"replace":"assign"](p)}}function r(c,u){a(c,xe({},t.state,Xl(o.value.back,c,o.value.forward,!0),u,{position:o.value.position}),!0),n.value=c}function i(c,u){const f=xe({},o.value,t.state,{forward:c,scroll:fa()});a(f.current,f,!0),a(c,xe({},Xl(n.value,c,null),{position:f.position+1},u),!1),n.value=c}return{location:n,state:o,push:i,replace:r}}function dm(e){e=Jp(e);const t=um(e),s=cm(e,t.state,t.location,t.replace);function n(a,r=!0){r||s.pauseListeners(),history.go(a)}const o=xe({location:"",base:e,go:n,createHref:qp.bind(null,e)},t,s);return Object.defineProperty(o,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(o,"state",{enumerable:!0,get:()=>t.state.value}),o}function fm(e){return e=location.host?e||location.pathname+location.search:"",e.includes("#")||(e+="#"),dm(e)}let Rs=function(e){return e[e.Static=0]="Static",e[e.Param=1]="Param",e[e.Group=2]="Group",e}({});var Qe=function(e){return e[e.Static=0]="Static",e[e.Param=1]="Param",e[e.ParamRegExp=2]="ParamRegExp",e[e.ParamRegExpEnd=3]="ParamRegExpEnd",e[e.EscapeNext=4]="EscapeNext",e}(Qe||{});const pm={type:Rs.Static,value:""},mm=/[a-zA-Z0-9_]/;function vm(e){if(!e)return[[]];if(e==="/")return[[pm]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(h){throw new Error(`ERR (${s})/"${u}": ${h}`)}let s=Qe.Static,n=s;const o=[];let a;function r(){a&&o.push(a),a=[]}let i=0,c,u="",f="";function d(){u&&(s===Qe.Static?a.push({type:Rs.Static,value:u}):s===Qe.Param||s===Qe.ParamRegExp||s===Qe.ParamRegExpEnd?(a.length>1&&(c==="*"||c==="+")&&t(`A repeatable param (${u}) must be alone in its segment. eg: '/:ids+.`),a.push({type:Rs.Param,value:u,regexp:f,repeatable:c==="*"||c==="+",optional:c==="*"||c==="?"})):t("Invalid state to consume buffer"),u="")}function p(){u+=c}for(;i<e.length;){if(c=e[i++],c==="\\"&&s!==Qe.ParamRegExp){n=s,s=Qe.EscapeNext;continue}switch(s){case Qe.Static:c==="/"?(u&&d(),r()):c===":"?(d(),s=Qe.Param):p();break;case Qe.EscapeNext:p(),s=n;break;case Qe.Param:c==="("?s=Qe.ParamRegExp:mm.test(c)?p():(d(),s=Qe.Static,c!=="*"&&c!=="?"&&c!=="+"&&i--);break;case Qe.ParamRegExp:c===")"?f[f.length-1]=="\\"?f=f.slice(0,-1)+c:s=Qe.ParamRegExpEnd:f+=c;break;case Qe.ParamRegExpEnd:d(),s=Qe.Static,c!=="*"&&c!=="?"&&c!=="+"&&i--,f="";break;default:t("Unknown state");break}}return s===Qe.ParamRegExp&&t(`Unfinished custom RegExp for param "${u}"`),d(),r(),o}const Ql="[^/]+?",hm={sensitive:!1,strict:!1,start:!0,end:!0};var mt=function(e){return e[e._multiplier=10]="_multiplier",e[e.Root=90]="Root",e[e.Segment=40]="Segment",e[e.SubSegment=30]="SubSegment",e[e.Static=40]="Static",e[e.Dynamic=20]="Dynamic",e[e.BonusCustomRegExp=10]="BonusCustomRegExp",e[e.BonusWildcard=-50]="BonusWildcard",e[e.BonusRepeatable=-20]="BonusRepeatable",e[e.BonusOptional=-8]="BonusOptional",e[e.BonusStrict=.7000000000000001]="BonusStrict",e[e.BonusCaseSensitive=.25]="BonusCaseSensitive",e}(mt||{});const gm=/[.+*?^${}()[\]/\\]/g;function ym(e,t){const s=xe({},hm,t),n=[];let o=s.start?"^":"";const a=[];for(const u of e){const f=u.length?[]:[mt.Root];s.strict&&!u.length&&(o+="/");for(let d=0;d<u.length;d++){const p=u[d];let h=mt.Segment+(s.sensitive?mt.BonusCaseSensitive:0);if(p.type===Rs.Static)d||(o+="/"),o+=p.value.replace(gm,"\\$&"),h+=mt.Static;else if(p.type===Rs.Param){const{value:g,repeatable:y,optional:$,regexp:C}=p;a.push({name:g,repeatable:y,optional:$});const b=C||Ql;if(b!==Ql){h+=mt.BonusCustomRegExp;try{`${b}`}catch(A){throw new Error(`Invalid custom RegExp for param "${g}" (${b}): `+A.message)}}let w=y?`((?:${b})(?:/(?:${b}))*)`:`(${b})`;d||(w=$&&u.length<2?`(?:/${w})`:"/"+w),$&&(w+="?"),o+=w,h+=mt.Dynamic,$&&(h+=mt.BonusOptional),y&&(h+=mt.BonusRepeatable),b===".*"&&(h+=mt.BonusWildcard)}f.push(h)}n.push(f)}if(s.strict&&s.end){const u=n.length-1;n[u][n[u].length-1]+=mt.BonusStrict}s.strict||(o+="/?"),s.end?o+="$":s.strict&&!o.endsWith("/")&&(o+="(?:/|$)");const r=new RegExp(o,s.sensitive?"":"i");function i(u){const f=u.match(r),d={};if(!f)return null;for(let p=1;p<f.length;p++){const h=f[p]||"",g=a[p-1];d[g.name]=h&&g.repeatable?h.split("/"):h}return d}function c(u){let f="",d=!1;for(const p of e){(!d||!f.endsWith("/"))&&(f+="/"),d=!1;for(const h of p)if(h.type===Rs.Static)f+=h.value;else if(h.type===Rs.Param){const{value:g,repeatable:y,optional:$}=h,C=g in u?u[g]:"";if(Bt(C)&&!y)throw new Error(`Provided param "${g}" is an array but it is not repeatable (* or + modifiers)`);const b=Bt(C)?C.join("/"):C;if(!b)if($)p.length<2&&(f.endsWith("/")?f=f.slice(0,-1):d=!0);else throw new Error(`Missing required param "${g}"`);f+=b}}return f||"/"}return{re:r,score:n,keys:a,parse:i,stringify:c}}function bm(e,t){let s=0;for(;s<e.length&&s<t.length;){const n=t[s]-e[s];if(n)return n;s++}return e.length<t.length?e.length===1&&e[0]===mt.Static+mt.Segment?-1:1:e.length>t.length?t.length===1&&t[0]===mt.Static+mt.Segment?1:-1:0}function Wc(e,t){let s=0;const n=e.score,o=t.score;for(;s<n.length&&s<o.length;){const a=bm(n[s],o[s]);if(a)return a;s++}if(Math.abs(o.length-n.length)===1){if(Zl(n))return 1;if(Zl(o))return-1}return o.length-n.length}function Zl(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const _m={strict:!1,end:!0,sensitive:!1};function wm(e,t,s){const n=ym(vm(e.path),s),o=xe(n,{record:e,parent:t,children:[],alias:[]});return t&&!o.record.aliasOf==!t.record.aliasOf&&t.children.push(o),o}function Cm(e,t){const s=[],n=new Map;t=Kl(_m,t);function o(d){return n.get(d)}function a(d,p,h){const g=!h,y=ti(d);y.aliasOf=h&&h.record;const $=Kl(t,d),C=[y];if("alias"in d){const A=typeof d.alias=="string"?[d.alias]:d.alias;for(const L of A)C.push(ti(xe({},y,{components:h?h.record.components:y.components,path:L,aliasOf:h?h.record:y})))}let b,w;for(const A of C){const{path:L}=A;if(p&&L[0]!=="/"){const V=p.record.path,U=V[V.length-1]==="/"?"":"/";A.path=p.record.path+(L&&U+L)}if(b=wm(A,p,$),h?h.alias.push(b):(w=w||b,w!==b&&w.alias.push(b),g&&d.name&&!si(b)&&r(d.name)),Vc(b)&&c(b),y.children){const V=y.children;for(let U=0;U<V.length;U++)a(V[U],b,h&&h.children[U])}h=h||b}return w?()=>{r(w)}:Wn}function r(d){if(Fc(d)){const p=n.get(d);p&&(n.delete(d),s.splice(s.indexOf(p),1),p.children.forEach(r),p.alias.forEach(r))}else{const p=s.indexOf(d);p>-1&&(s.splice(p,1),d.record.name&&n.delete(d.record.name),d.children.forEach(r),d.alias.forEach(r))}}function i(){return s}function c(d){const p=km(d,s);s.splice(p,0,d),d.record.name&&!si(d)&&n.set(d.record.name,d)}function u(d,p){let h,g={},y,$;if("name"in d&&d.name){if(h=n.get(d.name),!h)throw fn(He.MATCHER_NOT_FOUND,{location:d});$=h.record.name,g=xe(ei(p.params,h.keys.filter(w=>!w.optional).concat(h.parent?h.parent.keys.filter(w=>w.optional):[]).map(w=>w.name)),d.params&&ei(d.params,h.keys.map(w=>w.name))),y=h.stringify(g)}else if(d.path!=null)y=d.path,h=s.find(w=>w.re.test(y)),h&&(g=h.parse(y),$=h.record.name);else{if(h=p.name?n.get(p.name):s.find(w=>w.re.test(p.path)),!h)throw fn(He.MATCHER_NOT_FOUND,{location:d,currentLocation:p});$=h.record.name,g=xe({},p.params,d.params),y=h.stringify(g)}const C=[];let b=h;for(;b;)C.unshift(b.record),b=b.parent;return{name:$,path:y,params:g,matched:C,meta:$m(C)}}e.forEach(d=>a(d));function f(){s.length=0,n.clear()}return{addRoute:a,resolve:u,removeRoute:r,clearRoutes:f,getRoutes:i,getRecordMatcher:o}}function ei(e,t){const s={};for(const n of t)n in e&&(s[n]=e[n]);return s}function ti(e){const t={path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:e.aliasOf,beforeEnter:e.beforeEnter,props:Sm(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}};return Object.defineProperty(t,"mods",{value:{}}),t}function Sm(e){const t={},s=e.props||!1;if("component"in e)t.default=s;else for(const n in e.components)t[n]=typeof s=="object"?s[n]:s;return t}function si(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function $m(e){return e.reduce((t,s)=>xe(t,s.meta),{})}function km(e,t){let s=0,n=t.length;for(;s!==n;){const a=s+n>>1;Wc(e,t[a])<0?n=a:s=a+1}const o=xm(e);return o&&(n=t.lastIndexOf(o,n-1)),n}function xm(e){let t=e;for(;t=t.parent;)if(Vc(t)&&Wc(e,t)===0)return t}function Vc({record:e}){return!!(e.name||e.components&&Object.keys(e.components).length||e.redirect)}function ni(e){const t=Pt(pa),s=Pt(jr),n=E(()=>{const c=B(e.to);return t.resolve(c)}),o=E(()=>{const{matched:c}=n.value,{length:u}=c,f=c[u-1],d=s.matched;if(!f||!d.length)return-1;const p=d.findIndex(dn.bind(null,f));if(p>-1)return p;const h=oi(c[u-2]);return u>1&&oi(f)===h&&d[d.length-1].path!==h?d.findIndex(dn.bind(null,c[u-2])):p}),a=E(()=>o.value>-1&&Om(s.params,n.value.params)),r=E(()=>o.value>-1&&o.value===s.matched.length-1&&Uc(s.params,n.value.params));function i(c={}){if(Em(c)){const u=t[B(e.replace)?"replace":"push"](B(e.to)).catch(Wn);return e.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>u),u}return Promise.resolve()}return{route:n,href:E(()=>n.value.href),isActive:a,isExactActive:r,navigate:i}}function Am(e){return e.length===1?e[0]:e}const Tm=ac({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:ni,setup(e,{slots:t}){const s=Vt(ni(e)),{options:n}=Pt(pa),o=E(()=>({[ai(e.activeClass,n.linkActiveClass,"router-link-active")]:s.isActive,[ai(e.exactActiveClass,n.linkExactActiveClass,"router-link-exact-active")]:s.isExactActive}));return()=>{const a=t.default&&Am(t.default(s));return e.custom?a:Nc("a",{"aria-current":s.isExactActive?e.ariaCurrentValue:null,href:s.href,onClick:s.navigate,class:o.value},a)}}}),Nm=Tm;function Em(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function Om(e,t){for(const s in t){const n=t[s],o=e[s];if(typeof n=="string"){if(n!==o)return!1}else if(!Bt(o)||o.length!==n.length||n.some((a,r)=>a.valueOf()!==o[r].valueOf()))return!1}return!0}function oi(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const ai=(e,t,s)=>e??t??s,Im=ac({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:s}){const n=Pt(sr),o=E(()=>e.route||n.value),a=Pt(ql,0),r=E(()=>{let u=B(a);const{matched:f}=o.value;let d;for(;(d=f[u])&&!d.components;)u++;return u}),i=E(()=>o.value.matched[r.value]);No(ql,E(()=>r.value+1)),No(rm,i),No(sr,o);const c=R();return yt(()=>[c.value,i.value,e.name],([u,f,d],[p,h,g])=>{f&&(f.instances[d]=u,h&&h!==f&&u&&u===p&&(f.leaveGuards.size||(f.leaveGuards=h.leaveGuards),f.updateGuards.size||(f.updateGuards=h.updateGuards))),u&&f&&(!h||!dn(f,h)||!p)&&(f.enterCallbacks[d]||[]).forEach(y=>y(u))},{flush:"post"}),()=>{const u=o.value,f=e.name,d=i.value,p=d&&d.components[f];if(!p)return ri(s.default,{Component:p,route:u});const h=d.props[f],g=h?h===!0?u.params:typeof h=="function"?h(u):h:null,$=Nc(p,xe({},g,t,{onVnodeUnmounted:C=>{C.component.isUnmounted&&(d.instances[f]=null)},ref:c}));return ri(s.default,{Component:$,route:u})||$}}});function ri(e,t){if(!e)return null;const s=e(t);return s.length===1?s[0]:s}const Rm=Im;function Pm(e){const t=Cm(e.routes,e),s=e.parseQuery||om,n=e.stringifyQuery||Yl,o=e.history,a=xn(),r=xn(),i=xn(),c=Ad(is);let u=is;Gs&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const f=Aa.bind(null,J=>""+J),d=Aa.bind(null,jp),p=Aa.bind(null,no);function h(J,re){let ne,ce;return Fc(J)?(ne=t.getRecordMatcher(J),ce=re):ce=J,t.addRoute(ce,ne)}function g(J){const re=t.getRecordMatcher(J);re&&t.removeRoute(re)}function y(){return t.getRoutes().map(J=>J.record)}function $(J){return!!t.getRecordMatcher(J)}function C(J,re){if(re=xe({},re||c.value),typeof J=="string"){const P=Ta(s,J,re.path),G=t.resolve({path:P.path},re),Y=o.createHref(P.fullPath);return xe(P,G,{params:p(G.params),hash:no(P.hash),redirectedFrom:void 0,href:Y})}let ne;if(J.path!=null)ne=xe({},J,{path:Ta(s,J.path,re.path).path});else{const P=xe({},J.params);for(const G in P)P[G]==null&&delete P[G];ne=xe({},J,{params:d(P)}),re.params=d(re.params)}const ce=t.resolve(ne,re),Ce=J.hash||"";ce.params=f(p(ce.params));const S=Vp(n,xe({},J,{hash:Mp(Ce),path:ce.path})),k=o.createHref(S);return xe({fullPath:S,hash:Ce,query:n===Yl?am(J.query):J.query||{}},ce,{redirectedFrom:void 0,href:k})}function b(J){return typeof J=="string"?Ta(s,J,c.value.path):xe({},J)}function w(J,re){if(u!==J)return fn(He.NAVIGATION_CANCELLED,{from:re,to:J})}function A(J){return U(J)}function L(J){return A(xe(b(J),{replace:!0}))}function V(J,re){const ne=J.matched[J.matched.length-1];if(ne&&ne.redirect){const{redirect:ce}=ne;let Ce=typeof ce=="function"?ce(J,re):ce;return typeof Ce=="string"&&(Ce=Ce.includes("?")||Ce.includes("#")?Ce=b(Ce):{path:Ce},Ce.params={}),xe({query:J.query,hash:J.hash,params:Ce.path!=null?{}:J.params},Ce)}}function U(J,re){const ne=u=C(J),ce=c.value,Ce=J.state,S=J.force,k=J.replace===!0,P=V(ne,ce);if(P)return U(xe(b(P),{state:typeof P=="object"?xe({},Ce,P.state):Ce,force:S,replace:k}),re||ne);const G=ne;G.redirectedFrom=re;let Y;return!S&&Kp(n,ce,ne)&&(Y=fn(He.NAVIGATION_DUPLICATED,{to:G,from:ce}),D(ce,ce,!0,!1)),(Y?Promise.resolve(Y):ue(G,ce)).catch(z=>Jt(z)?Jt(z,He.NAVIGATION_GUARD_REDIRECT)?z:j(z):O(z,G,ce)).then(z=>{if(z){if(Jt(z,He.NAVIGATION_GUARD_REDIRECT))return U(xe({replace:k},b(z.to),{state:typeof z.to=="object"?xe({},Ce,z.to.state):Ce,force:S}),re||G)}else z=de(G,ce,!0,k,Ce);return ve(G,ce,z),z})}function X(J,re){const ne=w(J,re);return ne?Promise.reject(ne):Promise.resolve()}function q(J){const re=Me.values().next().value;return re&&typeof re.runWithContext=="function"?re.runWithContext(J):J()}function ue(J,re){let ne;const[ce,Ce,S]=lm(J,re);ne=Ea(ce.reverse(),"beforeRouteLeave",J,re);for(const P of ce)P.leaveGuards.forEach(G=>{ne.push(fs(G,J,re))});const k=X.bind(null,J,re);return ne.push(k),Fe(ne).then(()=>{ne=[];for(const P of a.list())ne.push(fs(P,J,re));return ne.push(k),Fe(ne)}).then(()=>{ne=Ea(Ce,"beforeRouteUpdate",J,re);for(const P of Ce)P.updateGuards.forEach(G=>{ne.push(fs(G,J,re))});return ne.push(k),Fe(ne)}).then(()=>{ne=[];for(const P of S)if(P.beforeEnter)if(Bt(P.beforeEnter))for(const G of P.beforeEnter)ne.push(fs(G,J,re));else ne.push(fs(P.beforeEnter,J,re));return ne.push(k),Fe(ne)}).then(()=>(J.matched.forEach(P=>P.enterCallbacks={}),ne=Ea(S,"beforeRouteEnter",J,re,q),ne.push(k),Fe(ne))).then(()=>{ne=[];for(const P of r.list())ne.push(fs(P,J,re));return ne.push(k),Fe(ne)}).catch(P=>Jt(P,He.NAVIGATION_CANCELLED)?P:Promise.reject(P))}function ve(J,re,ne){i.list().forEach(ce=>q(()=>ce(J,re,ne)))}function de(J,re,ne,ce,Ce){const S=w(J,re);if(S)return S;const k=re===is,P=Gs?history.state:{};ne&&(ce||k?o.replace(J.fullPath,xe({scroll:k&&P&&P.scroll},Ce)):o.push(J.fullPath,Ce)),c.value=J,D(J,re,ne,k),j()}let ye;function Se(){ye||(ye=o.listen((J,re,ne)=>{if(!Ue.listening)return;const ce=C(J),Ce=V(ce,Ue.currentRoute.value);if(Ce){U(xe(Ce,{replace:!0,force:!0}),ce).catch(Wn);return}u=ce;const S=c.value;Gs&&Zp(Jl(S.fullPath,ne.delta),fa()),ue(ce,S).catch(k=>Jt(k,He.NAVIGATION_ABORTED|He.NAVIGATION_CANCELLED)?k:Jt(k,He.NAVIGATION_GUARD_REDIRECT)?(U(xe(b(k.to),{force:!0}),ce).then(P=>{Jt(P,He.NAVIGATION_ABORTED|He.NAVIGATION_DUPLICATED)&&!ne.delta&&ne.type===er.pop&&o.go(-1,!1)}).catch(Wn),Promise.reject()):(ne.delta&&o.go(-ne.delta,!1),O(k,ce,S))).then(k=>{k=k||de(ce,S,!1),k&&(ne.delta&&!Jt(k,He.NAVIGATION_CANCELLED)?o.go(-ne.delta,!1):ne.type===er.pop&&Jt(k,He.NAVIGATION_ABORTED|He.NAVIGATION_DUPLICATED)&&o.go(-1,!1)),ve(ce,S,k)}).catch(Wn)}))}let fe=xn(),ie=xn(),H;function O(J,re,ne){j(J);const ce=ie.list();return ce.length?ce.forEach(Ce=>Ce(J,re,ne)):console.error(J),Promise.reject(J)}function M(){return H&&c.value!==is?Promise.resolve():new Promise((J,re)=>{fe.add([J,re])})}function j(J){return H||(H=!J,Se(),fe.list().forEach(([re,ne])=>J?ne(J):re()),fe.reset()),J}function D(J,re,ne,ce){const{scrollBehavior:Ce}=e;if(!Gs||!Ce)return Promise.resolve();const S=!ne&&em(Jl(J.fullPath,0))||(ce||!ne)&&history.state&&history.state.scroll||null;return Xn().then(()=>Ce(J,re,S)).then(k=>k&&Qp(k)).catch(k=>O(k,J,re))}const ee=J=>o.go(J);let ke;const Me=new Set,Ue={currentRoute:c,listening:!0,addRoute:h,removeRoute:g,clearRoutes:t.clearRoutes,hasRoute:$,getRoutes:y,resolve:C,options:e,push:A,replace:L,go:ee,back:()=>ee(-1),forward:()=>ee(1),beforeEach:a.add,beforeResolve:r.add,afterEach:i.add,onError:ie.add,isReady:M,install(J){J.component("RouterLink",Nm),J.component("RouterView",Rm),J.config.globalProperties.$router=Ue,Object.defineProperty(J.config.globalProperties,"$route",{enumerable:!0,get:()=>B(c)}),Gs&&!ke&&c.value===is&&(ke=!0,A(o.location).catch(ce=>{}));const re={};for(const ce in is)Object.defineProperty(re,ce,{get:()=>c.value[ce],enumerable:!0});J.provide(pa,Ue),J.provide(jr,Gi(re)),J.provide(sr,c);const ne=J.unmount;Me.add(J),J.unmount=function(){Me.delete(J),Me.size<1&&(u=is,ye&&ye(),ye=null,c.value=is,ke=!1,H=!1),ne()}}};function Fe(J){return J.reduce((re,ne)=>re.then(()=>q(ne)),Promise.resolve())}return Ue}function Dm(){return Pt(pa)}function lT(e){return Pt(jr)}function So(e){const t=[],s=e.split(`
`);let n=null,o=[],a=!1,r="";for(let i=0;i<s.length;i++){const c=s[i];if(c.startsWith("%"))continue;if(a){c.includes("}")?(r+=c.substring(0,c.indexOf("}")),o.push(r.trim()),r="",a=!1):r+=c+`
`;continue}if(c.includes("{")){const d=c.indexOf("{");if(c.includes("}")){const p=c.indexOf("}");o.push(c.substring(d+1,p).trim())}else r=c.substring(d+1)+`
`,a=!0;continue}const u=c.match(/\[Play\s+"([NESW])"\](\w+)/);if(u&&n){n.openingLeader=u[1],n.openingLead=u[2];continue}const f=c.match(/\[(\w+)\s+"([^"]*)"\]/);if(f){const[,d,p]=f;if(d==="Board")n&&(n.commentary=ci(o),n.steps=li(o),n.auction=ii(n.auction),t.push(n)),n=Lm(),n.boardNumber=parseInt(p,10),o=[];else if(n)switch(d){case"Dealer":n.dealer=p;break;case"Vulnerable":n.vulnerable=p;break;case"Contract":n.contract=p;break;case"Declarer":n.declarer=p;break;case"Student":n.studentSeat=p;break;case"Deal":n.hands=Bm(p);break;case"Auction":n.auctionDealer=p;break;case"Result":n.result=p;break;case"Event":n.event=p;break;case"SkillPath":n.skillPath=p;break;case"Category":n.category=p;break;case"Difficulty":n.difficulty=p;break}continue}if(n&&n.auctionDealer){const d=c.trim();if(d&&!d.startsWith("[")&&!d.startsWith("{")){const p=Um(d);n.auction.push(...p)}}}return n&&(n.commentary=ci(o),n.steps=li(o),n.auction=ii(n.auction),t.push(n)),t}function li(e){if(!e.length)return[];const t=e.join(`

`),s=/(\[BID\s+[^\]]+\]|\[NEXT\]|\[ROTATE\]|\[choose-card\s+[^\]]+\])/gi,n=t.split(s);if(n.length===1)return[];const o=[];let a="";for(let r=0;r<n.length;r++){const i=n[r],c=i.match(/^\[BID\s+([^\]]+)\]$/i),u=/^\[NEXT\]$/i.test(i),f=/^\[ROTATE\]$/i.test(i),d=i.match(/^\[choose-card\s+([^\]]+)\]$/i);if(c){const p=Hr(c[1]).replace(/!/g,"").trim(),h=a.trim();a="";let g="";if(r+1<n.length){const C=n[r+1];C.match(/^\[(?:BID|NEXT|ROTATE|choose-card)\b/i)||(g=C.trim(),r++)}const y=An(h,"bid"),$=An(g,"bid");o.push({...y,type:"bid",bid:p,explanationText:$.text,showSeatsAfter:$.showSeats})}else if(u||f){const p=u?"next":"rotate";a.trim()&&o.push(An(a.trim(),p)),a=""}else if(d){const p=d[1].trim();let h;if(p.toLowerCase().startsWith("any:")?h={cards:p.substring(4).split(",").map(y=>Ko(y.trim())),anyOf:!0}:h={card:Ko(p)},a.trim()){const g=An(a.trim(),"choose-card");g.chooseCard=h,o.push(g)}a=""}else a+=i}if(a.trim()){const r=An(a.trim(),"end");o.push(r)}return o}function An(e,t){let s=null;const n=e.match(/\[SHOW\s+([^\]]+)\]/i);if(n){const b=n[1].toUpperCase().trim();if(b==="ALL")s=["N","E","S","W"];else{const w=[];b.includes("N")&&w.push("N"),b.includes("E")&&w.push("E"),b.includes("S")&&w.push("S"),b.includes("W")&&w.push("W"),w.length>0&&(s=w)}}const o=[],a=/\[PLAY\s+([^\]]+)\]/gi;let r;for(;(r=a.exec(e))!==null;)o.push(r[1]);const i=/\[RESET\]/i.test(e);let c=null;const u=e.match(/\[choose-card\s+([^\]]+)\]/i);if(u){const b=u[1].trim();b.toLowerCase().startsWith("any:")?c={cards:b.substring(4).split(",").map(A=>Ko(A.trim())),anyOf:!0}:c={card:Ko(b)}}let f=null;const d=/\[AUCTION\s+off\]/i.test(e),p=/\[AUCTION\s+on\]/i.test(e);d&&(f=!1),p&&(f=!0);const h=/\[SHOW_LEAD\]/i.test(e),g=/\[clear-commentary\]/i.test(e);let y=null;const $=e.match(/\[showcards\s+([^\]]+)\]/i);if($){const b=$[1].trim();y={};const w=/([NESW]):([^,\s]+(?:,[^,\s]+)*)/gi;let A;for(;(A=w.exec(b))!==null;){const L=A[1].toUpperCase(),V=A[2].split(",").map(U=>U.trim().toUpperCase());y[L]=V}Object.keys(y).length===0&&(y=null)}let C=e.replace(/\[SHOW\s+[^\]]*\]/gi,"").replace(/\[PLAY\s+[^\]]*\]/gi,"").replace(/\[RESET\]/gi,"").replace(/\[AUCTION\s+(?:on|off)\]/gi,"").replace(/\[SHOW_LEAD\]/gi,"").replace(/\[showcards\s+[^\]]*\]/gi,"").replace(/\[choose-card\s+[^\]]*\]/gi,"").replace(/\[clear-commentary\]/gi,"").replace(/^[A-Z][a-zA-Z-]*(?:\s+[A-Z][a-zA-Z-]*)?\s+\d+\s*$/gim,"").trim();return{text:Hr(C),type:t,showSeats:s,plays:o,reset:i,showAuction:f,showLead:h,clearCommentary:g,showcards:y,chooseCard:c}}function Lm(){return{boardNumber:0,dealer:"N",vulnerable:"None",contract:"",declarer:"",studentSeat:"S",hands:{N:null,E:null,S:null,W:null},auction:[],auctionDealer:"",result:"",commentary:"",steps:[],openingLeader:null,openingLead:null,event:"",skillPath:null,category:null,difficulty:null}}function Ko(e){return e.toUpperCase().replace("10","T")}function Bm(e){const t={N:null,E:null,S:null,W:null},s=e.split(" ");if(s.length!==4)return t;const n=["W","N","E","S"];let o=0;const a=s[0],r=a.indexOf(":");if(r!==-1){const i=a.charAt(0).toUpperCase();o=n.indexOf(i),s[0]=a.substring(r+1)}for(let i=0;i<4;i++){const c=(o+i)%4,u=n[c];t[u]=Mm(s[i])}return t}function Mm(e){const t=e.split(".");return t.length!==4?null:{spades:$o(t[0]),hearts:$o(t[1]),diamonds:$o(t[2]),clubs:$o(t[3])}}function $o(e){return e?e.split(""):[]}function ii(e){let t=-1;for(let s=0;s<e.length;s++)e[s]!=="Pass"&&(t=s);return t===-1?e.slice(0,4):e.slice(0,t+4)}function Um(e){return e.split(/\s+/).filter(t=>t.length>0).filter(t=>!/^=\d+=?$/.test(t)).map(t=>Fm(t))}function Fm(e){const t=e.replace(/!/g,"").toUpperCase();return t==="PASS"||t==="P"?"Pass":t==="X"||t==="DBL"||t==="DOUBLE"?"X":t==="XX"||t==="RDBL"||t==="REDOUBLE"?"XX":t}function ci(e){return e.length?Hr(e.join(`

`)):""}function Hr(e){return e.replace(/\\S/g,"").replace(/\\H/g,"").replace(/\\D/g,"").replace(/\\C/g,"").replace(/\\s/g,"").replace(/\\h/g,"").replace(/\\d/g,"").replace(/\\c/g,"")}function jm(e){const t=["N","E","S","W"],s=t.indexOf(e);return[...t.slice(s),...t.slice(0,s)]}function ko(e,t){return jm(t)[e%4]}const Wr={spades:"",hearts:"",diamonds:"",clubs:"",S:"",H:"",D:"",C:""},ui={spades:"black",hearts:"red",diamonds:"red",clubs:"black"},Kc=["spades","hearts","diamonds","clubs"];function Oa(e){return e==="T"?"10":e}function Vr(e){if(!e)return{text:"",html:""};const t=e.toUpperCase();if(t==="PASS"||t==="P")return{text:"Pass",html:"Pass"};if(t==="X")return{text:"X",html:'<span class="double">X</span>'};if(t==="XX")return{text:"XX",html:'<span class="redouble">XX</span>'};const s=e.match(/^(\d)(C|D|H|S|NT?)$/i);if(s){const n=s[1],o=s[2].toUpperCase();if(o==="NT"||o==="N")return{text:`${n}NT`,html:`${n}NT`};const a=Wr[o],r=o==="H"||o==="D"?"red":"black";return{text:`${n}${a}`,html:`${n}<span class="${r}">${a}</span>`}}return{text:e,html:e}}function Hm(e){return(ui[e.toLowerCase()]||ui[e])==="red"?"suit-red":"suit-black"}function Wm(e){if(!e)return"None";const t=e.toUpperCase();return t==="NONE"||t==="-"||t==="LOVE"?"None":t==="NS"||t==="N-S"?"N-S Vul":t==="EW"||t==="E-W"?"E-W Vul":t==="BOTH"||t==="ALL"?"Both Vul":e}function nr(e){return{N:"North",E:"East",S:"South",W:"West"}[e]||e}function Vm(e){if(!e)return 0;const t={A:4,K:3,Q:2,J:1};let s=0;for(const n of Kc)for(const o of e[n]||[])s+=t[o]||0;return s}function Km(e){if(!e)return{text:"",html:""};const t=e[0].toUpperCase();let s=e.slice(1).toUpperCase();s==="T"&&(s="10");const n=Wr[t]||t,o=t==="H"||t==="D"?"suit-red":"suit-black";return{text:`${n}${s}`,html:`<span class="${o}">${n}</span>${s}`}}function Tn(e){return e?e.replace(/(\s*\n\s*){2,}/g,`

`).split(`

`).map(n=>n.replace(/\s*\n\s*/g," ").replace(/\s+/g," ").trim()).filter(n=>n.length>0).join(`

`):""}function Gm(e){return e?e.replace(/\[BID\s+[^\]]*\]/gi,"").replace(/\[NEXT\]/gi,"").replace(/\[ROTATE\]/gi,"").replace(/\[PLAY\s+[^\]]*\]/gi,"").replace(/\[SHOW\s+[^\]]*\]/gi,"").replace(/\[choose-card\s+[^\]]*\]/gi,"").replace(/\n{3,}/g,`

`).trim():""}function zs(e){return e?e.replace(//g,'<span class="suit-black"></span>').replace(//g,'<span class="suit-black"></span>').replace(//g,'<span class="suit-red"></span>').replace(//g,'<span class="suit-red"></span>'):""}function zm({userId:e,sessionId:t,deal:s,promptIndex:n,auctionSoFar:o,expectedBid:a,studentBid:r,correct:i,attemptNumber:c,timeTakenMs:u,skillPath:f,assignment:d=null,prompts:p=null}){var $,C,b,w,A,L,V,U,X,q,ue;const h=(($=s.steps)==null?void 0:$.filter(ve=>ve.type==="bid").length)||1,g=s.studentSeat||"S",y=((C=s.hands)==null?void 0:C[g.toLowerCase()])||"";return{observation_id:crypto.randomUUID(),timestamp:new Date().toISOString(),user_id:e,session_id:t,deal:{subfolder:s.subfolder||s.category||"Unknown",filename:s.filename||null,deal_number:s.boardNumber||s.dealNumber||null,kind:s.kind||null,dealer:s.dealer||"N",vulnerability:s.vulnerable||"None",student_seat:g,hands:{north:((b=s.hands)==null?void 0:b.N)||((w=s.hands)==null?void 0:w.north)||"",east:((A=s.hands)==null?void 0:A.E)||((L=s.hands)==null?void 0:L.east)||"",south:((V=s.hands)==null?void 0:V.S)||((U=s.hands)==null?void 0:U.south)||"",west:((X=s.hands)==null?void 0:X.W)||((q=s.hands)==null?void 0:q.west)||""},full_auction:((ue=s.auction)==null?void 0:ue.join(" "))||"",contract:s.contract||null,declarer:s.declarer||null,lead:s.lead||null},bid_prompt:{prompt_index:n,total_prompts:h,auction_so_far:[...o],expected_bid:a,student_hand:y},result:{student_bid:r,correct:i,attempt_number:c,time_taken_ms:u},skill_path:f,assignment:d,prompts:p||[]}}function Gc(e,t){return{observation_id:e.observation_id,user_id:e.user_id,session_id:e.session_id,timestamp:e.timestamp,skill_path:e.skill_path,correct:e.result.correct,classroom:t||null,deal_subfolder:e.deal.subfolder,deal_number:e.deal.deal_number}}function Jm(e){const t=[];return e?(e.observation_id||t.push("Missing observation_id"),e.timestamp||t.push("Missing timestamp"),e.user_id||t.push("Missing user_id"),e.session_id||t.push("Missing session_id"),e.deal?(e.deal.dealer||t.push("Missing deal.dealer"),e.deal.student_seat||t.push("Missing deal.student_seat"),e.deal.hands||t.push("Missing deal.hands")):t.push("Missing deal object"),e.bid_prompt?(e.bid_prompt.prompt_index===void 0&&t.push("Missing bid_prompt.prompt_index"),e.bid_prompt.prompt_index!==-1&&!e.bid_prompt.expected_bid&&t.push("Missing bid_prompt.expected_bid")):t.push("Missing bid_prompt object"),e.result?e.result.correct===void 0&&t.push("Missing result.correct"):t.push("Missing result object"),e.skill_path||t.push("Missing skill_path"),{valid:t.length===0,errors:t}):{valid:!1,errors:["Observation is null or undefined"]}}function Ym(){return crypto.randomUUID()}function qm(e){return`uncategorized/${e.toLowerCase().replace(/[^a-z0-9]/g,"_").replace(/_+/g,"_").replace(/^_|_$/g,"")||"unknown"}`}function zc(e){if(!e)return{path:"uncategorized/unknown",name:"Unknown",category:"Uncategorized"};const t=e.split("/"),s=t[0]||"uncategorized",n=t[t.length-1]||"unknown",o=a=>a.split("_").map(r=>r.charAt(0).toUpperCase()+r.slice(1)).join(" ");return{path:e,name:o(n),category:o(s)}}function Xm(e){const[t]=e.split("/");return t||"uncategorized"}function Qm(e){if(!e)return{id:"uncategorized",name:"Uncategorized"};const t=e.split("_").map(s=>s.charAt(0).toUpperCase()+s.slice(1)).join(" ");return{id:e,name:t}}const Jc={name:"AES-GCM",length:256},Kr={name:"RSA-OAEP",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:"SHA-256"};async function Zm(){const e=await crypto.subtle.generateKey(Jc,!0,["encrypt","decrypt"]),t=await crypto.subtle.exportKey("raw",e);return Ms(t)}async function Yc(e){const t=Us(e);return crypto.subtle.importKey("raw",t,Jc,!0,["encrypt","decrypt"])}async function Gr(e,t){const s=await Yc(t),n=crypto.getRandomValues(new Uint8Array(12)),a=new TextEncoder().encode(JSON.stringify(e)),r=await crypto.subtle.encrypt({name:"AES-GCM",iv:n},s,a);return{encrypted_data:Ms(r),iv:Ms(n)}}async function zr(e,t,s){const n=await Yc(s),o=Us(e),a=Us(t),r=await crypto.subtle.decrypt({name:"AES-GCM",iv:a},n,o),i=new TextDecoder;return JSON.parse(i.decode(r))}async function ev(e){const t=Us(e);return crypto.subtle.importKey("spki",t,Kr,!0,["encrypt"])}async function tv(e){const t=Us(e);return crypto.subtle.importKey("pkcs8",t,Kr,!0,["decrypt"])}async function sv(){const e=await crypto.subtle.generateKey(Kr,!0,["encrypt","decrypt"]),t=await crypto.subtle.exportKey("spki",e.publicKey),s=await crypto.subtle.exportKey("pkcs8",e.privateKey);return{publicKey:Ms(t),privateKey:Ms(s)}}async function qc(e,t){const s=await ev(t),n=Us(e),o=await crypto.subtle.encrypt({name:"RSA-OAEP"},s,n);return Ms(o)}async function nv(e,t){const s=await tv(t),n=Us(e),o=await crypto.subtle.decrypt({name:"RSA-OAEP"},s,n);return Ms(o)}function ov(e){return{bridge_practice_backup:!0,version:"2.0",user_id:e.id,name:`${e.firstName} ${e.lastName}`,email:e.email,secret_key:e.secretKey,created:new Date().toISOString().split("T")[0],note:"Keep this file safe. Import it to restore your practice history on a new device."}}function av(e){if(!e||typeof e!="object")return{valid:!1,error:"Invalid backup file format"};if(!e.bridge_practice_backup)return{valid:!1,error:"Not a Bridge Practice backup file"};if(e.version==="2.0"){if(!e.secret_key)return{valid:!1,error:"Backup file is missing secret key"}}else if(e.version==="1.0"||!e.version)return{valid:!1,error:"Legacy backup format (v1.0) is no longer supported. Please re-register."};return e.user_id?{valid:!0}:{valid:!1,error:"Backup file is missing user ID"}}async function rv(e){try{const t={test:"validation",timestamp:Date.now()},{encrypted_data:s,iv:n}=await Gr(t,e);return(await zr(s,n,e)).test==="validation"}catch(t){return console.error("Key validation failed:",t),!1}}function Ms(e){const t=new Uint8Array(e);let s="";for(let n=0;n<t.length;n++)s+=String.fromCharCode(t[n]);return btoa(s)}function Us(e){const t=atob(e),s=new Uint8Array(t.length);for(let n=0;n<t.length;n++)s[n]=t.charCodeAt(n);return s.buffer}const or="bridgePractice",Pe=R({}),Ye=R(null),bs=R(null),oo=R(!1),ma=R(!1);function Xc(){try{const e=localStorage.getItem(or);if(e){const t=JSON.parse(e);Pe.value=t.users||{},Ye.value=t.currentUserId||null,bs.value=t.adminViewerId||null}oo.value=!0}catch(e){console.error("Failed to load user store from storage:",e),oo.value=!0}}function Ot(){try{const e=localStorage.getItem(or),t=e?JSON.parse(e):{};t.users=Pe.value,t.currentUserId=Ye.value,bs.value&&(t.adminViewerId=bs.value),localStorage.setItem(or,JSON.stringify(t))}catch(e){console.error("Failed to save user store to storage:",e)}}async function lv({firstName:e,lastName:t,email:s,classrooms:n=[],dataConsent:o=!0,apiUrl:a}){const r=crypto.randomUUID(),i=new Date().toISOString(),c=await Zm();let u=null;if(a)try{const d=await fetch(`${a}/keys/admin`);if(d.ok){const p=await d.json();bs.value=p.viewer_id,u={grantee_id:p.viewer_id,encrypted_payload:await qc(c,p.public_key)}}}catch(d){console.warn("Failed to create admin sharing grant:",d)}const f={id:r,firstName:e.trim(),lastName:t.trim(),email:s.trim().toLowerCase(),classrooms:n,dataConsent:o,secretKey:c,role:"student",serverRegistered:!1,adminGrantPayload:u,createdAt:i,updatedAt:i};return Pe.value[r]=f,Ye.value=r,Ot(),ma.value=!0,f}function iv(e,t){if(!Pe.value[e])return console.error("User not found:",e),null;const s=Pe.value[e];return t.firstName!==void 0&&(s.firstName=t.firstName.trim()),t.lastName!==void 0&&(s.lastName=t.lastName.trim()),t.email!==void 0&&(s.email=t.email.trim().toLowerCase()),t.classrooms!==void 0&&(s.classrooms=t.classrooms),t.dataConsent!==void 0&&(s.dataConsent=t.dataConsent),t.serverRegistered!==void 0&&(s.serverRegistered=t.serverRegistered),t.role!==void 0&&(s.role=t.role),s.updatedAt=new Date().toISOString(),Ot(),s}function cv(e){if(!Pe.value[e])return!1;if(delete Pe.value[e],Ye.value===e){const t=Object.keys(Pe.value);Ye.value=t.length>0?t[0]:null}return Ot(),!0}function uv(e){return Pe.value[e]?(Ye.value=e,Ot(),!0):(console.error("User not found:",e),!1)}function dv(e,t){const s=e.trim().toLowerCase(),n=t.trim().toLowerCase();for(const o of Object.values(Pe.value))if(o.firstName.toLowerCase()===s&&o.lastName.toLowerCase()===n)return o;return null}function fv(e){const t=e.trim().toLowerCase();for(const s of Object.values(Pe.value))if(s.email&&s.email.toLowerCase()===t)return s;return null}function pv(e){return Pe.value[e]||null}function mv(){Pe.value={},Ye.value=null,bs.value=null,ma.value=!1,Ot(),oo.value=!1}function vv(){oo.value||Xc()}async function hv(e){const t=av(e);if(!t.valid)return{success:!1,error:t.error};if(!await rv(e.secret_key))return{success:!1,error:"The secret key in this backup file is invalid or corrupted"};const n=Pe.value[e.user_id];if(n)return n.secretKey=e.secret_key,n.updatedAt=new Date().toISOString(),Ye.value=e.user_id,Ot(),{success:!0,user:n};const o=(e.name||"Restored User").split(" "),a=o[0]||"Restored",r=o.slice(1).join(" ")||"User",i={id:e.user_id,firstName:a,lastName:r,email:e.email||"",classrooms:[],dataConsent:!0,secretKey:e.secret_key,serverRegistered:!1,restoredFromBackup:!0,createdAt:e.created||new Date().toISOString(),updatedAt:new Date().toISOString()};return Pe.value[i.id]=i,Ye.value=i.id,Ot(),{success:!0,user:i}}function gv(){const e=Pe.value[Ye.value];return!e||!e.secretKey?null:ov(e)}function yv(){ma.value=!1}function bv(){return bs.value}function _v(e){bs.value=e,Ot()}async function wv(e){const t=Pe.value[Ye.value];return!t||!t.secretKey?null:qc(t.secretKey,e)}async function Cv(e,t){try{const s=await fetch(`${t}/recovery/request`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})});if(s.status===404)return{success:!1,message:"No account found with this email address."};const n=await s.text();if(!n)return{success:!1,message:"No account found with this email address."};try{return JSON.parse(n)}catch(o){return console.error("Failed to parse recovery response:",o),{success:!1,message:"No account found with this email address."}}}catch(s){return console.error("Recovery request failed:",s),{success:!1,message:"Unable to connect to server. Please try again."}}}async function Sv(e,t,s){try{const o=await(await fetch(`${s}/recovery/claim`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:e,token:t})})).json();if(!o.success||!o.user)return{success:!1,error:o.error||"Recovery failed"};const a={id:o.user.id,firstName:o.user.first_name,lastName:o.user.last_name,email:o.user.email,classrooms:o.user.classroom?[o.user.classroom]:[],dataConsent:!0,secretKey:o.user.secret_key,role:o.user.role||"student",serverRegistered:!0,recoveredAt:new Date().toISOString(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return Pe.value[a.id]=a,Ye.value=a.id,Ot(),{success:!0,user:a}}catch(n){return console.error("Recovery claim failed:",n),{success:!1,error:"Unable to connect to server. Please try again."}}}async function $v(e,t,s){try{const o=await(await fetch(`${s}/recovery/claim-code`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,code:t})})).json();if(!o.success||!o.user)return{success:!1,error:o.error||"Invalid code"};const a={id:o.user.id,firstName:o.user.first_name,lastName:o.user.last_name,email:o.user.email,classrooms:o.user.classroom?[o.user.classroom]:[],dataConsent:!0,secretKey:o.user.secret_key,role:o.user.role||"student",serverRegistered:!0,recoveredAt:new Date().toISOString(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return Pe.value[a.id]=a,Ye.value=a.id,Ot(),{success:!0,user:a}}catch(n){return console.error("Recovery claim by code failed:",n),{success:!1,error:"Unable to connect to server. Please try again."}}}async function kv(){if(!Ye.value)return;const e=Pe.value[Ye.value];if(!e)return;const t="https://api.bridge-classroom.com/api",s="8a3ccc23767bdcbe6bb1709dfe3f20194dc0b8b4874939244e802dc71a21a568";try{const n=await fetch(`${t}/users/${encodeURIComponent(e.id)}`,{headers:{"x-api-key":s}});if(!n.ok)return;const o=await n.json();if(!o.success||!o.user)return;let a=!1;o.user.role&&o.user.role!==e.role&&(e.role=o.user.role,a=!0),o.user.name_corrected_at&&o.user.name_corrected_at!==e.nameCorrectedAt&&(e.firstName=o.user.first_name,e.lastName=o.user.last_name,e.nameCorrectedAt=o.user.name_corrected_at,a=!0),a&&Ot()}catch{}}function ze(){const e=E(()=>Ye.value&&Pe.value[Ye.value]||null),t=E(()=>Object.values(Pe.value)),s=E(()=>Object.keys(Pe.value).length>0),n=E(()=>Object.keys(Pe.value).length),o=E(()=>Ye.value!==null&&!!Pe.value[Ye.value]);return{users:Pe,currentUserId:Ye,adminViewerId:bs,initialized:oo,showKeyBackupModal:ma,currentUser:e,allUsers:t,hasUsers:s,userCount:n,isAuthenticated:o,initialize:vv,loadFromStorage:Xc,saveToStorage:Ot,createUser:lv,updateUser:iv,deleteUser:cv,switchUser:uv,findUserByName:dv,findUserByEmail:fv,getUser:pv,clearUsers:mv,restoreFromBackup:hv,getKeyBackup:gv,dismissKeyBackupModal:yv,getAdminViewerId:bv,setAdminViewerId:_v,createGrantForViewer:wv,requestRecovery:Cv,claimRecovery:Sv,claimRecoveryByCode:$v,syncRole:kv}}const ar="bridgePractice",lt=R({}),We=R(null),It=R(!1),pn=R(!1);function Qc(){const e=new URLSearchParams(window.location.search),t=e.get("assignment"),s=e.get("lessons"),n=e.get("due"),o=e.get("teacher"),a=e.get("classrooms");if(!t||!s)return null;const r=s.split(",").map(c=>c.trim()).filter(Boolean),i=a?a.split(",")[0].trim():null;return{name:t,lessons:r,dueDate:n||null,teacherName:o||null,classroom:i}}function Zc(){try{const e=localStorage.getItem(ar);if(e){const t=JSON.parse(e);lt.value=t.assignments||{},We.value=t.currentAssignmentId||null,We.value&&lt.value[We.value]&&(It.value=!0)}pn.value=!0}catch(e){console.error("Failed to load assignment store from storage:",e),pn.value=!0}}function Fs(){try{const e=localStorage.getItem(ar),t=e?JSON.parse(e):{};t.assignments=lt.value,t.currentAssignmentId=We.value,localStorage.setItem(ar,JSON.stringify(t))}catch(e){console.error("Failed to save assignment store to storage:",e)}}function eu({name:e,teacherName:t,classroom:s,lessons:n,dueDate:o}){const a=Object.values(lt.value).find(u=>u.name===e);if(a){const u=new Set(a.lessons);for(const f of n)u.add(f);return a.lessons=Array.from(u),o&&(a.dueDate=o),a.updatedAt=new Date().toISOString(),We.value=a.id,It.value=!0,Fs(),a}const r=crypto.randomUUID(),i=new Date().toISOString(),c={id:r,name:e,teacherName:t,classroom:s,lessons:n,assignedAt:i,dueDate:o,totalDeals:0,completedDeals:0,completedDealIds:[],completionPercent:0,startedAt:null,lastPracticedAt:null,createdAt:i,updatedAt:i};return lt.value[r]=c,We.value=r,It.value=!0,Fs(),c}function xv(){if(pn.value)return;Zc();const e=Qc();e&&eu(e),pn.value=!0}function Av(e){if(!It.value||!We.value)return!1;const t=lt.value[We.value];return t?t.lessons.some(s=>s.toLowerCase()===e.toLowerCase()):!1}function Tv(e){if(!We.value)return;const t=lt.value[We.value];t&&(t.totalDeals=e,t.completionPercent=e>0?Math.round(t.completedDeals/e*100):0,t.updatedAt=new Date().toISOString(),Fs())}function Nv(e){if(!We.value||!It.value)return!1;const t=lt.value[We.value];if(!t||t.completedDealIds.includes(e))return!1;t.completedDealIds.push(e),t.completedDeals=t.completedDealIds.length,t.completionPercent=t.totalDeals>0?Math.round(t.completedDeals/t.totalDeals*100):0;const s=new Date().toISOString();return t.startedAt||(t.startedAt=s),t.lastPracticedAt=s,t.updatedAt=s,Fs(),!0}function Ev(){if(!It.value||!We.value)return null;const e=lt.value[We.value];return e?{id:e.id,name:e.name,teacherName:e.teacherName,assignedAt:e.assignedAt}:null}function Ov(){It.value=!1}function Iv(){We.value&&lt.value[We.value]&&(It.value=!0)}function Rv(e){return lt.value[e]||null}function Pv(){return Object.values(lt.value)}function Dv(e){return lt.value[e]?(delete lt.value[e],We.value===e&&(We.value=null,It.value=!1),Fs(),!0):!1}function Lv(){lt.value={},We.value=null,It.value=!1,pn.value=!1,Fs()}function va(){const e=E(()=>We.value&&lt.value[We.value]||null),t=E(()=>It.value&&e.value!==null),s=E(()=>{const o=e.value;return o?{completed:o.completedDeals,total:o.totalDeals,percent:o.completionPercent}:{completed:0,total:0,percent:0}}),n=E(()=>{const o=e.value;return o?o.completedDeals>=o.totalDeals&&o.totalDeals>0:!1});return{assignments:lt,currentAssignmentId:We,inAssignmentMode:It,initialized:pn,currentAssignment:e,hasActiveAssignment:t,assignmentProgress:s,isAssignmentComplete:n,initializeFromUrl:xv,loadFromStorage:Zc,saveToStorage:Fs,createAssignment:eu,isLessonInAssignment:Av,setTotalDeals:Tv,recordDealCompletion:Nv,getAssignmentTag:Ev,exitAssignmentMode:Ov,returnToAssignmentMode:Iv,getAssignment:Rv,getAllAssignments:Pv,deleteAssignment:Dv,clearAssignments:Lv,parseAssignmentFromUrl:Qc}}const rr="bridgePractice",at=R([]),mn=R(null),vn=R(!1),Ls=R({totalObservations:0,correctCount:0,wrongCount:0,startedAt:null});function tu(){try{const e=localStorage.getItem(rr);if(e){const t=JSON.parse(e);at.value=t.pendingObservations||[]}vn.value=!0}catch(e){console.error("Failed to load observation store from storage:",e),vn.value=!0}}function js(){try{const e=localStorage.getItem(rr),t=e?JSON.parse(e):{};t.pendingObservations=at.value,localStorage.setItem(rr,JSON.stringify(t))}catch(e){console.error("Failed to save observation store to storage:",e)}}function su(){vn.value||tu(),mn.value||nu()}function nu(){mn.value=Ym(),Ls.value={totalObservations:0,correctCount:0,wrongCount:0,startedAt:new Date().toISOString()}}async function Bv({deal:e,promptIndex:t,auctionSoFar:s,expectedBid:n,studentBid:o,correct:a,attemptNumber:r,timeTakenMs:i,prompts:c}){var $,C;const u=ze(),f=va();vn.value||su();const d=u.currentUser.value;if(!d)return{success:!1,error:"No authenticated user"};let p=e.skillPath;if(!p){const b=e.subfolder||e.category||"Unknown";p=qm(b)}const h=f.getAssignmentTag(),g=zm({userId:d.id,sessionId:mn.value,deal:e,promptIndex:t,auctionSoFar:s,expectedBid:n,studentBid:o,correct:a,attemptNumber:r,timeTakenMs:i,skillPath:p,assignment:h,prompts:c}),y=Jm(g);if(!y.valid)return console.error("Invalid observation:",y.errors),{success:!1,error:y.errors.join(", ")};if(Ls.value.totalObservations++,a?Ls.value.correctCount++:Ls.value.wrongCount++,d.dataConsent&&d.secretKey){const b=await Mv(g,d);b.success||(console.warn("Failed to encrypt observation, storing unencrypted:",b.error),di(g,(($=d.classrooms)==null?void 0:$[0])||null))}else di(g,((C=d.classrooms)==null?void 0:C[0])||null);return{success:!0,observation:g}}async function Mv(e,t){var s;try{const{encrypted_data:n,iv:o}=await Gr(e,t.secretKey),a=((s=t.classrooms)==null?void 0:s[0])||null,r=Gc(e,a);return at.value.push({encrypted_data:n,iv:o,metadata:r,encrypted:!0,queuedAt:new Date().toISOString()}),js(),{success:!0}}catch(n){return console.error("Failed to encrypt observation:",n),{success:!1,error:n.message}}}function di(e,t){const s=Gc(e,t);at.value.push({observation:e,metadata:s,encrypted:!1,queuedAt:new Date().toISOString()}),js()}async function Uv(){const t=ze().currentUser.value;if(!(t!=null&&t.secretKey))return 0;let s=0;for(let n=0;n<at.value.length;n++){const o=at.value[n];if(!o.encrypted&&o.observation)try{const{encrypted_data:a,iv:r}=await Gr(o.observation,t.secretKey);at.value[n]={encrypted_data:a,iv:r,metadata:o.metadata,encrypted:!0,queuedAt:o.queuedAt,encryptedAt:new Date().toISOString()},s++}catch(a){console.error("Failed to encrypt observation:",a)}}return s>0&&js(),s}function Fv(){return at.value.length}function jv(){return[...at.value]}function Hv(e){at.value=at.value.filter(t=>{var s;return!e.includes((s=t.metadata)==null?void 0:s.observation_id)}),js()}function Wv(){at.value=[],js()}function Vv(){return{...Ls.value}}function Kv(){at.value=[],mn.value=null,Ls.value={totalObservations:0,correctCount:0,wrongCount:0,startedAt:null},vn.value=!1,js()}function ws(){const e=E(()=>at.value.length),t=E(()=>at.value.length>0),s=E(()=>at.value.some(o=>!o.encrypted)),n=E(()=>mn.value);return{pendingObservations:at,sessionId:mn,sessionStats:Ls,initialized:vn,pendingCount:e,hasPendingObservations:t,hasUnencryptedObservations:s,currentSessionId:n,initialize:su,startNewSession:nu,recordObservation:Bv,encryptPendingObservations:Uv,getPendingCount:Fv,getPendingObservations:jv,removeSyncedObservations:Hv,clearPendingObservations:Wv,getSessionStats:Vv,reset:Kv,loadFromStorage:tu,saveToStorage:js}}function Gv(){const e=ws(),t=R(null),s=R(0),n=R(!1),o=R(!1),a=Vt({displayedBids:[],currentBidIndex:0,wrongBid:null,correctBid:null,wrongBidIndex:-1,correctBidIndex:-1,auctionComplete:!1}),r=Vt({answered:{},wrongCard:null,correctCard:null}),i=Vt({boardHadWrong:!1,correctCount:0,wrongCount:0,wrongStepIndices:{},promptHistory:[]}),c=R({N:[],E:[],S:[],W:[]}),u=R(null),f=R(1),d=E(()=>{var N;return((N=t.value)==null?void 0:N.steps)||[]}),p=E(()=>d.value.length>0),h=E(()=>d.value[s.value]||null),g=E(()=>d.value.some(N=>N.type==="bid")),y=E(()=>{var N;return((N=h.value)==null?void 0:N.type)==="bid"}),$=E(()=>{var N;for(let T=s.value;T>=0;T--)if((N=d.value[T])!=null&&N.clearCommentary)return T;return 0}),C=E(()=>{var N;return((N=t.value)==null?void 0:N.studentSeat)||"S"}),b=E(()=>t.value?ko(a.currentBidIndex,t.value.auctionDealer||t.value.dealer):null),w=E(()=>b.value===C.value),A=E(()=>{var W,x;if(!y.value||!w.value||a.auctionComplete||o.value)return!1;const N=h.value;if(!(N!=null&&N.bid))return!1;const T=(x=(W=t.value)==null?void 0:W.auction)==null?void 0:x[a.currentBidIndex];return T?te(N.bid)===te(T):!1}),L=E(()=>{for(let N=a.displayedBids.length-1;N>=0;N--){const T=a.displayedBids[N];if(T&&T!=="Pass"&&T!=="X"&&T!=="XX")return T}return null}),V=E(()=>{if(!t.value||a.displayedBids.length===0)return!1;const N=a.displayedBids[a.displayedBids.length-1];if(N==="X"||N==="XX"||!L.value)return!1;let T=-1;for(let K=a.displayedBids.length-1;K>=0;K--){const Z=a.displayedBids[K];if(Z&&Z!=="Pass"&&Z!=="X"&&Z!=="XX"){T=K;break}}if(T===-1)return!1;const W=ko(T,t.value.auctionDealer||t.value.dealer),x=b.value;return(x==="N"||x==="S")&&(W==="E"||W==="W")||(x==="E"||x==="W")&&(W==="N"||W==="S")}),U=E(()=>{if(!t.value||a.displayedBids.length===0)return!1;for(let N=a.displayedBids.length-1;N>=0;N--){const T=a.displayedBids[N];if(T!=="Pass"){if(T==="XX")return!1;if(T==="X"){const W=ko(N,t.value.auctionDealer||t.value.dealer),x=b.value;return!(x==="N"&&W==="S"||x==="S"&&W==="N"||x==="E"&&W==="W"||x==="W"&&W==="E")}return!1}}return!1}),X=E(()=>{const N=h.value;return N!=null&&N.chooseCard?!r.answered[s.value]:!1}),q=E(()=>{var N;return((N=h.value)==null?void 0:N.chooseCard)||null}),ue=E(()=>{if(!t.value)return[];const N=["N","E","S","W"];if(!p.value)return[];let T=null;const W=d.value;for(let x=0;x<=s.value&&x<W.length;x++){const I=W[x];I!=null&&I.showSeats&&(T=I.showSeats),I!=null&&I.showSeatsAfter&&(x<s.value||x===s.value&&o.value)&&(T=I.showSeatsAfter)}return T?N.filter(x=>!T.includes(x)):N}),ve=E(()=>{if(!t.value||!p.value)return null;let N={};const T=d.value;for(let W=0;W<=s.value&&W<T.length;W++){const x=T[W];if(x!=null&&x.showcards)for(const[I,K]of Object.entries(x.showcards))N[I]=K;if(x!=null&&x.showSeats)for(const I of x.showSeats)delete N[I];if(x!=null&&x.showSeatsAfter&&(W<s.value||W===s.value&&o.value))for(const I of x.showSeatsAfter)delete N[I]}return Object.keys(N).length>0?N:null}),de=E(()=>{if(!t.value||!p.value)return{};let N={},T=new Set;const W=d.value;for(let I=0;I<=s.value&&I<W.length;I++){const K=W[I];if(K!=null&&K.showcards)for(const[Z,oe]of Object.entries(K.showcards))N[Z]=oe;if(K!=null&&K.showSeats)for(const Z of K.showSeats)T.add(Z)}const x={};for(const[I,K]of Object.entries(N))T.has(I)&&(x[I]=K);return x}),ye=E(()=>{const N=ve.value;return N?Object.keys(N):[]}),Se=E(()=>{const N=ue.value,T=ye.value;return T.length?N.filter(W=>!T.includes(W)):N});function fe(N){const T={spades:[],hearts:[],diamonds:[],clubs:[]},W={S:"spades",H:"hearts",D:"diamonds",C:"clubs"};for(const x of N){const I=x[0].toUpperCase(),K=x.slice(1).toUpperCase(),Z=W[I];Z&&T[Z].push(K)}return T}const ie=E(()=>{var W,x;if(!((W=t.value)!=null&&W.hands))return{};if((x=h.value)!=null&&x.reset)return t.value.hands;const N=ve.value,T={};for(const I of["N","E","S","W"]){if(N&&N[I]){T[I]=fe(N[I]);continue}const K=t.value.hands[I];if(!K){T[I]=null;continue}T[I]={spades:[...K.spades||[]],hearts:[...K.hearts||[]],diamonds:[...K.diamonds||[]],clubs:[...K.clubs||[]]};for(const Z of c.value[I]){const oe={S:"spades",H:"hearts",D:"diamonds",C:"clubs"}[Z.suit];if(oe&&T[I][oe]){const pe=T[I][oe].indexOf(Z.card);pe!==-1&&T[I][oe].splice(pe,1)}}}return T}),H=E(()=>!(g.value&&!a.auctionComplete)),O=E(()=>{if(!p.value)return!0;let N=!0;const T=d.value;for(let W=0;W<=s.value&&W<T.length;W++){const x=T[W];(x==null?void 0:x.showAuction)!==null&&(x==null?void 0:x.showAuction)!==void 0&&(N=x.showAuction)}return N}),M=E(()=>{var T;if(!p.value)return!1;const N=d.value;for(let W=0;W<=s.value&&W<N.length;W++)if((T=N[W])!=null&&T.showLead)return!0;return!1}),j=E(()=>{var N;return(N=t.value)!=null&&N.openingLead?{leader:t.value.openingLeader,card:t.value.openingLead}:null}),D=E(()=>{if(!p.value||n.value)return!0;const N=h.value;return(N==null?void 0:N.type)==="end"&&!X.value}),ee=E(()=>p.value?!!(o.value||s.value>0||y.value&&a.currentBidIndex>0):!1);function ke(){var T;c.value={N:[],E:[],S:[],W:[]};const N=d.value;for(let W=0;W<=s.value&&W<N.length;W++){const x=N[W];if((T=x==null?void 0:x.plays)!=null&&T.length)for(const I of x.plays){const K=I.split(/[,\s]+/);for(const Z of K){if(!Z)continue;const oe=Z.trim().match(/^([NESW]):([SHDC])(.+)$/i);if(oe){const pe=oe[1].toUpperCase(),_e=oe[2].toUpperCase();let me=oe[3].toUpperCase();me==="10"&&(me="T"),c.value[pe].push({suit:_e,card:me})}}}}}function Me(){if(!t.value)return;const N=t.value.auction||[],T=Ue(s.value);if(T===-1){for(;a.currentBidIndex<N.length;)a.displayedBids.push(N[a.currentBidIndex]),a.currentBidIndex++;a.auctionComplete=!0,u.value=null;return}const W=d.value[T],x=te(W.bid);for(;a.currentBidIndex<N.length;){const I=ko(a.currentBidIndex,t.value.auctionDealer||t.value.dealer),K=te(N[a.currentBidIndex]);if(I===C.value&&K===x){u.value=Date.now(),f.value=1;return}a.displayedBids.push(N[a.currentBidIndex]),a.currentBidIndex++}a.auctionComplete=!0,u.value=null}function Ue(N){const T=d.value;for(let W=N;W<T.length;W++)if(T[W].type==="bid")return W;return-1}function Fe(N){if(!t.value||a.auctionComplete||!y.value)return!1;const T=t.value.auction[a.currentBidIndex],W=te(N)===te(T),x=s.value;W?x in i.wrongStepIndices&&delete i.wrongStepIndices[x]:(i.wrongStepIndices[x]=!0,i.boardHadWrong=!0);const I=d.value.slice(0,x+1).filter(pe=>pe.type==="bid").length-1;i.promptHistory.push({type:"bid",prompt_index:I,auction_so_far:[...a.displayedBids],expected_bid:T,student_bid:N,correct:W});const K=a.currentBidIndex;a.displayedBids.push(t.value.auction[a.currentBidIndex]),a.currentBidIndex++,u.value=null,f.value=1,W?(a.wrongBid=null,a.correctBid=null,a.wrongBidIndex=-1):(a.wrongBid=N,a.correctBid=T,a.wrongBidIndex=K);const Z=s.value+1,oe=d.value[Z];return(oe==null?void 0:oe.type)==="bid"?(s.value=Z,o.value=!1,Me()):(o.value=!0,J(),s.value>=d.value.length-1&&S()),W}function J(){var T;if(a.auctionComplete)return;if(Ue(s.value+1)===-1){const W=((T=t.value)==null?void 0:T.auction)||[];for(;a.currentBidIndex<W.length;)a.displayedBids.push(W[a.currentBidIndex]),a.currentBidIndex++;a.auctionComplete=!0}}function re(){a.wrongBid=null,a.correctBid=null,a.wrongBidIndex=-1,a.correctBidIndex=-1}function ne(N,T){if(!t.value||!X.value)return!1;const W=q.value;if(!W)return!1;const x=(N+T).toUpperCase(),I=s.value;let K=!1,Z="";return W.anyOf?(K=W.cards.includes(x),Z=W.cards[0]):(K=x===W.card,Z=W.card),K?I in i.wrongStepIndices&&delete i.wrongStepIndices[I]:(i.wrongStepIndices[I]=!0,i.boardHadWrong=!0),i.promptHistory.push({type:"card",expected_card:Z,student_card:x,correct:K}),r.answered[I]=!0,K?(r.wrongCard=null,r.correctCard=null):(r.wrongCard=x,r.correctCard=Z),Ce(),K}function ce(){r.wrongCard=null,r.correctCard=null}function Ce(){var N;if(A.value||X.value)return!1;if(o.value&&(o.value=!1),s.value<d.value.length-1){if(s.value++,ke(),((N=d.value[s.value])==null?void 0:N.type)==="bid"&&Me(),s.value>=d.value.length-1){const T=d.value[s.value];(T==null?void 0:T.type)!=="bid"&&(T==null?void 0:T.type)!=="choose-card"&&S()}return!0}return S(),!1}function S(){n.value=!0,k()}function k(){if(d.value.some(T=>T.type==="bid"||T.type==="choose-card"))if(i.boardHadWrong){i.wrongCount++;const T=Object.keys(i.wrongStepIndices).length===0;Y(!1),Y(T)}else i.correctCount++,Y(!0)}function P(){if(re(),ce(),o.value)return o.value=!1,G(s.value),!0;if(s.value>0){const N=s.value-1,T=d.value[N];return r.answered[N]&&delete r.answered[N],(T==null?void 0:T.type)==="bid"&&G(N),s.value=N,n.value=!1,o.value=!1,ke(),!0}return!1}function G(N){var K;const T=d.value[N];if(!T||T.type!=="bid")return;const W=te(T.bid),x=((K=t.value)==null?void 0:K.auction)||[];let I=0;for(let Z=0;Z<x.length;Z++)if(te(x[Z])===W){I=Z;break}a.currentBidIndex=I,a.displayedBids=x.slice(0,I),a.auctionComplete=!1,u.value=Date.now(),f.value=1}async function Y(N){if(t.value)try{await e.recordObservation({deal:t.value,promptIndex:-1,auctionSoFar:[...a.displayedBids],expectedBid:"BOARD",studentBid:N?"PASS":"FAIL",correct:N,attemptNumber:1,timeTakenMs:0,prompts:[...i.promptHistory]})}catch(T){console.error("Failed to record board observation:",T)}}function z(N){var T,W;t.value=N,s.value=0,n.value=!1,o.value=!1,a.displayedBids=[],a.currentBidIndex=0,a.wrongBid=null,a.correctBid=null,a.wrongBidIndex=-1,a.correctBidIndex=-1,a.auctionComplete=!1,r.answered={},r.wrongCard=null,r.correctCard=null,i.boardHadWrong=!1,i.wrongStepIndices={},i.promptHistory=[],c.value={N:[],E:[],S:[],W:[]},u.value=null,f.value=1,(T=N==null?void 0:N.steps)!=null&&T.length&&(ke(),((W=N.steps[0])==null?void 0:W.type)==="bid"&&Me())}function se(){i.correctCount=0,i.wrongCount=0}function te(N){if(!N)return"";const W=N.replace(/!/g,"").replace(//g,"S").replace(//g,"H").replace(//g,"D").replace(//g,"C").toUpperCase();return W==="PASS"||W==="P"?"PASS":W==="X"||W==="DBL"||W==="DOUBLE"?"X":W==="XX"||W==="RDBL"||W==="REDOUBLE"?"XX":W.replace(/(\d)N$/,"$1NT")}return{currentDeal:t,currentStepIndex:s,bidAnswered:o,auctionState:a,cardChoiceState:r,boardState:i,steps:d,hasSteps:p,currentStep:h,hasBidSteps:g,isBidStep:y,commentaryStartIndex:$,studentSeat:C,currentTurnSeat:b,isStudentTurn:w,hasBidPrompt:A,lastContractBid:L,canDouble:V,canRedouble:U,canGoBack:ee,hasCardChoice:X,currentChooseCard:q,hiddenSeats:Se,hands:ie,showHcp:H,showcardsPlayedCards:de,isComplete:D,showAuctionTable:O,showOpeningLead:M,openingLead:j,advance:Ce,makeBid:Fe,clearFeedback:re,goBack:P,makeCardChoice:ne,clearCardFeedback:ce,loadDeal:z,resetStats:se,observationStore:e}}const Go="bridgePractice",ou="bridgePracticeUIPrefs",it=R({teacherName:null,availableClassrooms:[],configuredAt:null}),hn=R({showLoadPbnOption:!1}),zo=R(!1);function au(e){return e.split("-").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ")}function ru(){const e=new URLSearchParams(window.location.search),t=e.get("teacher"),s=e.get("classrooms"),n=e.get("collection"),o=s?s.split(",").map(a=>({id:a.trim(),name:au(a.trim())})):[];return{teacher:t,classrooms:o,collection:n}}function zv(){return new URLSearchParams(window.location.search).get("collection")}function Jv(){return new URLSearchParams(window.location.search).get("lesson")}function Yv(e){const t=new URL(window.location.href);e?t.searchParams.set("collection",e):t.searchParams.delete("collection"),window.history.pushState({},"",t.toString())}function qv(e){const t=new URL(window.location.href);e?t.searchParams.set("lesson",e):(t.searchParams.delete("lesson"),t.searchParams.delete("deal")),window.history.pushState({},"",t.toString())}function Xv(){const t=new URLSearchParams(window.location.search).get("deal");return t?parseInt(t,10):null}function Qv(e){const t=new URL(window.location.href);e&&e>1?t.searchParams.set("deal",e):t.searchParams.delete("deal"),window.history.replaceState({},"",t.toString())}const Zv=[{id:"baker-bridge",name:"Baker Bridge",description:"Classic bridge lessons covering bidding conventions and play",icon:"",tocUrl:"https://raw.githubusercontent.com/Rick-Wilson/Baker-Bridge/main/Package/toc.json",baseUrl:"https://raw.githubusercontent.com/Rick-Wilson/Baker-Bridge/main/Package"},{id:"andrew-rowberg",name:"Rowberg Collection",description:"Precision with transfer positive responses to strong 1 opening bids",icon:"",tocUrl:"https://raw.githubusercontent.com/Rick-Wilson/Bridge-Lessons-by-Andrew-Rowberg/main/Lock-Step%20Lessons/toc.json",baseUrl:"https://raw.githubusercontent.com/Rick-Wilson/Bridge-Lessons-by-Andrew-Rowberg/main/Lock-Step%20Lessons"}];function lu(){try{const e=localStorage.getItem(Go);if(e){const t=JSON.parse(e);t.appConfig&&(it.value=t.appConfig)}}catch(e){console.error("Failed to load app config from storage:",e)}}function eh(){try{const e=localStorage.getItem(ou);if(e){const t=JSON.parse(e);hn.value={...hn.value,...t}}}catch(e){console.error("Failed to load UI prefs from storage:",e)}}function th(){try{localStorage.setItem(ou,JSON.stringify(hn.value))}catch(e){console.error("Failed to save UI prefs to storage:",e)}}function sh(e,t){hn.value[e]=t,th()}function Jr(){try{const e=localStorage.getItem(Go),t=e?JSON.parse(e):{};t.appConfig=it.value,localStorage.setItem(Go,JSON.stringify(t))}catch(e){console.error("Failed to save app config to storage:",e)}}function iu(e,t){const s=new Set(e.map(o=>o.id)),n=[...e];for(const o of t)s.has(o.id)||n.push(o);return n}function nh(){if(zo.value)return;lu(),eh();const{teacher:e,classrooms:t}=ru();(e||t.length>0)&&(e&&!it.value.teacherName&&(it.value.teacherName=e),t.length>0&&(it.value.availableClassrooms=iu(it.value.availableClassrooms||[],t)),it.value.configuredAt||(it.value.configuredAt=new Date().toISOString()),Jr()),zo.value=!0}function oh(){try{const e=localStorage.getItem(Go);return e?JSON.parse(e):null}catch{return null}}function ah(){it.value={teacherName:null,availableClassrooms:[],configuredAt:null},Jr(),zo.value=!1}function po(){const e=E(()=>it.value.availableClassrooms.length===0),t=E(()=>it.value.availableClassrooms.length>1),s=E(()=>it.value.availableClassrooms.length===1),n=E(()=>s.value?it.value.availableClassrooms[0]:null),o=E(()=>it.value.teacherName),a=E(()=>it.value.availableClassrooms),r=E(()=>hn.value.showLoadPbnOption);return{appConfig:it,initialized:zo,uiPrefs:hn,isAdHoc:e,hasMultipleClassrooms:t,hasSingleClassroom:s,singleClassroom:n,teacherName:o,availableClassrooms:a,showLoadPbnOption:r,initializeFromUrl:nh,loadFromStorage:lu,saveToStorage:Jr,clearConfig:ah,getStorageData:oh,getCollectionFromUrl:zv,setCollectionInUrl:Yv,getLessonFromUrl:Jv,setLessonInUrl:qv,getDealFromUrl:Xv,setDealInUrl:Qv,setUIPref:sh,COLLECTIONS:Zv,parseUrlParams:ru,classroomIdToName:au,mergeClassrooms:iu}}const rh="https://api.bridge-classroom.com/api",lh="8a3ccc23767bdcbe6bb1709dfe3f20194dc0b8b4874939244e802dc71a21a568",Yr=R([]),nt=R([]),Jo=R(!1),Yo=R(null),Vn=R(null),qo=R(!1),ih=5*60*1e3;async function ch(e){const t=await fetch(`${rh}/observations?user_id=${e}&limit=10000`,{headers:{"x-api-key":lh}});if(!t.ok)throw new Error(`Server error: ${t.status}`);return(await t.json()).observations||[]}async function uh(e,t){try{return{...await zr(e.encrypted_data,e.iv,t),id:e.id,timestamp:e.timestamp,skill_path:e.skill_path,correct:e.correct,classroom:e.classroom,deal_subfolder:e.deal_subfolder,deal_number:e.deal_number}}catch(s){return console.error("Failed to decrypt observation:",e.id,s),null}}function dh(){return ws().getPendingObservations().map(s=>{const n=s.metadata||{};return{id:n.observation_id||"local-"+Math.random().toString(36).slice(2),timestamp:n.timestamp||s.queuedAt,skill_path:n.skill_path,correct:n.correct,classroom:n.classroom,deal_subfolder:n.deal_subfolder,deal_number:n.deal_number,session_id:n.session_id,_local:!0,_pending:!0}})}async function cu(e=!1){const s=ze().currentUser.value;if(!s)return{success:!1,error:"No authenticated user"};const n=dh();if(!e&&Vn.value&&Date.now()-new Date(Vn.value).getTime()<ih&&nt.value.length>0)return fh(n),{success:!0,cached:!0};Jo.value=!0,Yo.value=null;let o=[];try{const i=await ch(s.id);if(Yr.value=i,s.secretKey&&i.length>0){const c=i.map(f=>uh(f,s.secretKey));o=(await Promise.all(c)).filter(f=>f!==null)}}catch(i){console.error("Failed to fetch from server (will use local data):",i),n.length===0&&(Yo.value=i.message)}const a=new Set(o.map(i=>i.id)),r=n.filter(i=>!a.has(i.id));return nt.value=[...o,...r],Vn.value=new Date().toISOString(),Jo.value=!1,{success:!0,count:nt.value.length}}function fh(e){const t=new Set(nt.value.map(n=>n.id)),s=e.filter(n=>!t.has(n.id));s.length>0&&(nt.value=[...nt.value,...s])}async function ph(){if(qo.value)return;ze().isAuthenticated.value&&await cu(),qo.value=!0}function mh(){Yr.value=[],nt.value=[],Vn.value=null,qo.value=!1}function uu(){const e={};for(const t of nt.value){const s=t.timestamp.split("T")[0];e[s]||(e[s]=[]),e[s].push(t)}return e}function fi(){const e={};for(const t of nt.value){const s=t.skill_path||"unknown";e[s]||(e[s]={total:0,correct:0,incorrect:0}),e[s].total++,t.correct?e[s].correct++:e[s].incorrect++}for(const t in e){const s=e[t];s.accuracy=s.total>0?Math.round(s.correct/s.total*100):0}return e}function pi(){const e={};for(const t of nt.value){const s=t.session_id||"unknown";e[s]||(e[s]={id:s,observations:[],startTime:t.timestamp,endTime:t.timestamp,correct:0,incorrect:0});const n=e[s];n.observations.push(t),t.timestamp<n.startTime&&(n.startTime=t.timestamp),t.timestamp>n.endTime&&(n.endTime=t.timestamp),t.correct?n.correct++:n.incorrect++}return Object.values(e).map(t=>({...t,total:t.correct+t.incorrect,accuracy:t.correct+t.incorrect>0?Math.round(t.correct/(t.correct+t.incorrect)*100):0})).sort((t,s)=>new Date(s.startTime)-new Date(t.startTime))}function mi(e=10){return[...nt.value].sort((t,s)=>new Date(s.timestamp)-new Date(t.timestamp)).slice(0,e)}function vi(){const e=new Date().toISOString().split("T")[0];return nt.value.filter(t=>t.timestamp.startsWith(e))}function hi(){const e=new Date,s=new Date(e.getTime()-7*24*60*60*1e3).toISOString();return nt.value.filter(n=>n.timestamp>=s)}function vh(){const e=uu(),t=Object.keys(e).sort().reverse();if(t.length===0)return 0;const s=new Date().toISOString().split("T")[0],n=new Date(Date.now()-24*60*60*1e3).toISOString().split("T")[0];if(t[0]!==s&&t[0]!==n)return 0;let o=1,a=new Date(t[0]);for(let r=1;r<t.length;r++){const i=new Date(t[r]);if(Math.round((a-i)/(24*60*60*1e3))===1)o++,a=i;else break}return o}function qr(){const e=E(()=>nt.value.length),t=E(()=>nt.value.filter(h=>h.correct).length),s=E(()=>nt.value.filter(h=>!h.correct).length),n=E(()=>e.value===0?0:Math.round(t.value/e.value*100)),o=E(()=>{const h=vi(),g=h.filter($=>$.correct).length,y=h.length;return{total:y,correct:g,incorrect:y-g,accuracy:y>0?Math.round(g/y*100):0}}),a=E(()=>{const h=hi(),g=h.filter($=>$.correct).length,y=h.length;return{total:y,correct:g,incorrect:y-g,accuracy:y>0?Math.round(g/y*100):0}}),r=E(()=>vh()),i=E(()=>fi()),c=E(()=>pi()),u=E(()=>mi(20)),f=E(()=>nt.value.length>0),d=E(()=>Jo.value),p=E(()=>Yo.value!==null);return{observations:Yr,decryptedObservations:nt,loading:Jo,error:Yo,lastFetchedAt:Vn,initialized:qo,totalObservations:e,totalCorrect:t,totalIncorrect:s,overallAccuracy:n,todayStats:o,weekStats:a,streak:r,skillStats:i,sessions:c,recentObservations:u,hasData:f,isLoading:d,hasError:p,initialize:ph,fetchProgress:cu,clearCache:mh,getObservationsByDate:uu,getStatsBySkill:fi,getSessions:pi,getRecentObservations:mi,getTodayObservations:vi,getThisWeekObservations:hi}}const Is={GREY:"grey",RED:"red",YELLOW:"yellow",ORANGE:"orange",GREEN:"green"},St={NONE:"none",SILVER:"silver",GOLD:"gold"},hh=6;function gh(e){return e.slice(0,10)}function du(e,t){const s=new Date(e+"T00:00:00Z"),n=new Date(t+"T00:00:00Z");return Math.round(Math.abs(n-s)/864e5)}function fu(e){if(e.length===0)return[];const t={};for(const s of e){const n=s.session_id||s.id||"unknown";t[n]||(t[n]={observations:[],latestTimestamp:s.timestamp}),t[n].observations.push(s),s.timestamp>t[n].latestTimestamp&&(t[n].latestTimestamp=s.timestamp)}return Object.values(t).map(s=>({timestamp:s.latestTimestamp,correct:s.observations.every(n=>n.correct),sessionId:s.observations[0].session_id||s.observations[0].id})).sort((s,n)=>s.timestamp.localeCompare(n.timestamp))}const gi=60*60*1e3;function pu(e){if(e.length===0)return Is.GREY;const t=e[e.length-1];if(!t.correct)return Is.RED;const s=Date.now()-gi;if(e.some(i=>!i.correct&&new Date(i.timestamp).getTime()>s))return Is.YELLOW;const o=e.filter(i=>!i.correct).pop();if(!o)return Is.GREEN;const a=new Date(o.timestamp).getTime();return new Date(t.timestamp).getTime()-a<=gi?Is.ORANGE:Is.GREEN}function mu(e,t){const s=e.filter(n=>n.timestamp.startsWith(t));return s.length===0?!1:s.every(n=>n.correct)}function vu(e){if(e.length===0)return St.NONE;const t=new Set;for(const r of e)t.add(gh(r.timestamp));const s=[...t].filter(r=>mu(e,r)).sort();if(s.length<2)return St.NONE;let n=1,o=1,a=s[0];for(let r=1;r<s.length;r++)du(a,s[r])>=hh&&(o++,a=s[r],o>n&&(n=o));return n>=3?St.GOLD:n>=2?St.SILVER:St.NONE}function yh(e){const t=e.observations.value||[];let s=[];try{s=ws().getPendingObservations().filter(i=>i.metadata).map(i=>{const c=i.metadata;return{id:c.observation_id||"local-"+Math.random().toString(36).slice(2),timestamp:c.timestamp||i.queuedAt,skill_path:c.skill_path,correct:c.correct,deal_subfolder:c.deal_subfolder,deal_number:c.deal_number,session_id:c.session_id,_local:!0}})}catch{}const n=new Set(t.map(a=>a.id)),o=s.filter(a=>!n.has(a.id));return[...t,...o]}function bh(e,t,s){if(!t||!s||s.length===0)return[];const n=e.filter(o=>{var a;return(o.deal_subfolder||((a=o.deal)==null?void 0:a.subfolder))===t});return s.map(o=>{const a=n.filter(i=>{var c;return(i.deal_number??((c=i.deal)==null?void 0:c.deal_number))===o}).sort((i,c)=>i.timestamp.localeCompare(c.timestamp)),r=fu(a);return{boardNumber:o,status:pu(a),achievement:vu(a),attemptCount:r.length,lastAttemptTime:a.length>0?a[a.length-1].timestamp:null}})}function _h(e){return!e||e.length===0?{achievement:St.NONE}:e.every(n=>n.achievement===St.GOLD)?{achievement:St.GOLD}:e.every(n=>n.achievement===St.SILVER||n.achievement===St.GOLD)?{achievement:St.SILVER}:{achievement:St.NONE}}const hu="bridgeLessonBoards",ao=R(wh()),Ia=new Set;function wh(){try{const e=localStorage.getItem(hu);return e?JSON.parse(e):{}}catch{return{}}}function Ch(){try{localStorage.setItem(hu,JSON.stringify(ao.value))}catch{}}function gu(e,t){ao.value={...ao.value,[e]:t},Ch()}function Sh(e){const t=[],s=/\[Board\s+"?(\d+)"?\]/g;let n;for(;(n=s.exec(e))!==null;)t.push(parseInt(n[1],10));return t.sort((o,a)=>o-a)}async function $h(e){const t=po(),s=e.filter(n=>!ao.value[n]&&!Ia.has(n));if(s.length!==0){for(const n of s)Ia.add(n);await Promise.all(s.map(async n=>{try{for(const o of t.COLLECTIONS){const a=n.includes("/")?n.split("/").pop():n,r=`${o.baseUrl}/${a}.pbn`;try{const i=await fetch(r);if(!i.ok)continue;const c=await i.text(),u=Sh(c);if(u.length>0){gu(n,u);break}}catch{continue}}}finally{Ia.delete(n)}}))}}function kh(e){var n,o;const t=ao.value,s={};for(const a of e){const r=a.deal_subfolder||((n=a.deal)==null?void 0:n.subfolder),i=a.deal_number??((o=a.deal)==null?void 0:o.deal_number);!r||i==null||(s[r]||(s[r]={boards:new Set,lastActivity:a.timestamp}),s[r].boards.add(i),a.timestamp>s[r].lastActivity&&(s[r].lastActivity=a.timestamp))}return Object.entries(s).map(([a,r])=>{const i=t[a];if(i)return{subfolder:a,boardNumbers:i,lastActivity:r.lastActivity};const c=Math.max(...r.boards),u=[];for(let f=1;f<=c;f++)u.push(f);return{subfolder:a,boardNumbers:u,lastActivity:r.lastActivity}})}function vs(){const e=gs();function t(){return yh(e)}return{STATUS:Is,ACHIEVEMENT:St,getObservations:t,computeBoardMastery:bh,computeLessonAchievement:_h,extractLessonsFromObservations:kh,saveLessonBoardNumbers:gu,fetchMissingBoardCounts:$h,groupIntoBoardAttempts:fu,calculateCurrentStatus:pu,calculateAchievement:vu,hasGreenDay:mu,daysBetween:du}}const Ys="https://api.bridge-classroom.com/api",qs="8a3ccc23767bdcbe6bb1709dfe3f20194dc0b8b4874939244e802dc71a21a568",Xo=R(!1),ro=R(null),ha=R([]),hs=R({}),lo=R({}),Qo=R(!1),Zo=R(null),Xr=R(!1),ea={},xh=2*60*1e3,Kn={};let Po=null;async function Ah(){var s;const e=ze(),t=e.currentUser.value;if(!t||!t.email){Xo.value=!1;return}try{const n=await fetch(`${Ys}/viewers?email=${encodeURIComponent(t.email)}`,{headers:{"x-api-key":qs}});if(!n.ok)return;const o=await n.json(),a=Array.isArray(o)?o[0]:null;if(!a)return;ro.value=a.id;const r=await fetch(`${Ys}/grants?grantee_id=${a.id}`,{headers:{"x-api-key":qs}});if(!r.ok)return;const c=(await r.json()).grants||[],u=new Set(c.filter(g=>g.grantor_id!==t.id).map(g=>g.grantor_id));if(u.size===0)return;const f=await fetch(`${Ys}/users`,{headers:{"x-api-key":qs}});if(!f.ok)return;const p=(await f.json()).users||[],h=(s=t.email)==null?void 0:s.toLowerCase();if(ha.value=p.filter(g=>{var y;return u.has(g.id)&&g.id!==t.id&&((y=g.email)==null?void 0:y.toLowerCase())!==h}).sort((g,y)=>`${g.first_name} ${g.last_name}`.localeCompare(`${y.first_name} ${y.last_name}`)),Xo.value=!0,Xr.value=!0,t.role==="student"){e.updateUser(t.id,{role:"teacher"});try{await fetch(`${Ys}/users/me`,{method:"PATCH",headers:{"Content-Type":"application/json","x-api-key":qs},body:JSON.stringify({user_id:t.id,action:"become_teacher"})})}catch{}}}catch(n){console.error("Failed to check teacher status:",n)}}async function yu(e){const t=hs.value[e],s=ea[e];if(t&&s&&Date.now()-s<xh)return t;try{const n=await fetch(`${Ys}/observations?user_id=${encodeURIComponent(e)}&limit=10000`,{headers:{"x-api-key":qs}});if(!n.ok)throw new Error(`HTTP ${n.status}`);const a=(await n.json()).observations||[],r=a.map(i=>({id:i.id||i.observation_id,timestamp:i.timestamp,skill_path:i.skill_path,correct:i.correct,deal_subfolder:i.deal_subfolder,deal_number:i.deal_number}));return lo.value={...lo.value,[e]:a},hs.value={...hs.value,[e]:r},ea[e]=Date.now(),r}catch(n){return console.error(`Failed to fetch observations for ${e}:`,n),[]}}async function Th(){Qo.value=!0,Zo.value=null;try{await Promise.allSettled(ha.value.map(s=>yu(s.id)));const e=vs(),t=new Set;for(const s of Object.values(hs.value))for(const n of s)n.deal_subfolder&&t.add(n.deal_subfolder);t.size>0&&e.fetchMissingBoardCounts([...t])}catch(e){Zo.value=e.message,console.error("Failed to load student summaries:",e)}finally{Qo.value=!1}}function Nh(e){const t=hs.value[e]||[];if(t.length===0)return{green:0,orange:0,yellow:0,red:0,grey:0,total:0,lastObservationTime:null};const s=vs(),n=s.extractLessonsFromObservations(t),o={green:0,orange:0,yellow:0,red:0,grey:0};for(const r of n){const i=s.computeBoardMastery(t,r.subfolder,r.boardNumbers);for(const c of i)o[c.status]=(o[c.status]||0)+1}let a=null;for(const r of t)(!a||r.timestamp>a)&&(a=r.timestamp);return{...o,total:o.green+o.orange+o.yellow+o.red+o.grey,lastObservationTime:a}}function Eh(e,t=3){const s=hs.value[e]||[],n=gs(),o={};for(const a of s){const r=a.deal_subfolder;r&&(!o[r]||a.timestamp>o[r])&&(o[r]=a.timestamp)}return Object.entries(o).sort(([,a],[,r])=>r.localeCompare(a)).slice(0,t).map(([a])=>n.formatLessonName(a))}function Oh(e){if(!e)return"Never";const t=new Date,s=new Date(e),n=t-s,o=Math.floor(n/6e4),a=Math.floor(n/36e5),r=Math.floor(n/864e5);return o<1?"Just now":o<60?`${o}m ago`:a<24?`${a}h ago`:r<7?`${r}d ago`:s.toLocaleDateString()}function Ih(){try{const e=JSON.parse(sessionStorage.getItem("bridgeTeacherSession")||"null");return!e||!e.privateKeyBase64||e.expiry&&new Date(e.expiry)<new Date?null:e.privateKeyBase64}catch{return null}}async function bu(e){if(Kn[e])return Kn[e];const t=Ih();if(!t)return null;if(!Po&&ro.value)try{const n=await fetch(`${Ys}/grants?grantee_id=${ro.value}`,{headers:{"x-api-key":qs}});n.ok&&(Po=(await n.json()).grants||[])}catch{return null}const s=(Po||[]).find(n=>n.grantor_id===e);if(!s)return null;try{const n=await nv(s.encrypted_payload,t);return Kn[e]=n,n}catch(n){return console.error(`Failed to decrypt grant for student ${e}:`,n),null}}async function _u(e,t){if(!t.encrypted_data||!t.iv)return null;const s=await bu(e);if(!s)return null;try{return{...await zr(t.encrypted_data,t.iv,s),id:t.id,timestamp:t.timestamp,skill_path:t.skill_path,correct:t.correct,deal_subfolder:t.deal_subfolder,deal_number:t.deal_number}}catch(n){return console.error("Failed to decrypt observation:",t.id,n),null}}async function Rh(e,t,s,n){const a=(lo.value[e]||[]).find(r=>{const i=new Date(r.timestamp).getTime();return Math.abs(i-t)<1e3&&r.deal_number===s&&r.correct===n});return a?_u(e,a):null}function Ph(){Xo.value=!1,ro.value=null,ha.value=[],hs.value={},lo.value={},Qo.value=!1,Zo.value=null,Xr.value=!1,Po=null;for(const e of Object.keys(Kn))delete Kn[e];for(const e of Object.keys(ea))delete ea[e]}function bn(){return{isTeacher:Xo,viewerId:ro,students:ha,studentObservations:hs,loading:Qo,error:Zo,initialized:Xr,checkTeacherStatus:Ah,fetchStudentObservations:yu,loadAllStudentSummaries:Th,getStudentMasterySummary:Nh,getStudentRecentLessons:Eh,formatTimeSince:Oh,findAndDecryptObservation:Rh,decryptStudentObservation:_u,getStudentKey:bu,studentRawObservations:lo,reset:Ph}}const lr="https://api.bridge-classroom.com/api",ir="8a3ccc23767bdcbe6bb1709dfe3f20194dc0b8b4874939244e802dc71a21a568",cr=R(!1),Xs=R(null),es=R(null),io=R([]),gn=R([]),Qr=R("lessons"),ga=R(!0),_n=R(!1),mo=R([]);function Dh(e){_n.value=!0,mo.value=e}function Lh(){_n.value=!1,mo.value=[]}function vo(){return _n.value?mo.value:io.value}async function wu(){const e=ze(),t=bn(),s=e.currentUser.value;if(!s){gn.value=[];return}const n=[{id:s.id,name:`${s.firstName} ${s.lastName}`,email:s.email,isSelf:!0}];if(t.isTeacher.value&&t.viewerId.value)try{const o=await fetch(`${lr}/grants?grantee_id=${t.viewerId.value}`,{headers:{"x-api-key":ir}});if(o.ok){const{grants:a}=await o.json(),r=await fetch(`${lr}/users`,{headers:{"x-api-key":ir}});if(r.ok){const{users:i}=await r.json(),c=new Set(a.map(u=>u.grantor_id));for(const u of i)c.has(u.id)&&u.id!==s.id&&n.push({id:u.id,name:`${u.first_name} ${u.last_name}`,email:u.email,isSelf:!1})}}}catch(o){console.error("Failed to fetch accessible users:",o)}gn.value=n}async function Zr(e=!1){if(_n.value)return{success:!0};const t=ze(),s=qr(),n=t.currentUser.value;if(!n)return Xs.value="No authenticated user",{success:!1,error:Xs.value};cr.value=!0,Xs.value=null;try{if(!es.value||es.value===n.id)es.value=n.id,await s.fetchProgress(e),io.value=s.decryptedObservations.value;else{const o=await fetch(`${lr}/observations?user_id=${es.value}&limit=10000`,{headers:{"x-api-key":ir}});if(!o.ok)throw new Error(`Failed to fetch observations: ${o.status}`);const a=await o.json();io.value=a.observations||[]}return{success:!0}}catch(o){return Xs.value=o.message,{success:!1,error:o.message}}finally{cr.value=!1}}async function Bh(e){es.value=e,await Zr(!0)}const ur=E(()=>{var n;const e=vo(),t={};for(const o of e){const a=o.deal_subfolder||((n=o.deal)==null?void 0:n.subfolder)||"Unknown";t[a]||(t[a]={lesson:a,displayName:$u(a),total:0,correct:0,incorrect:0,observations:[]}),t[a].total++,o.correct?t[a].correct++:t[a].incorrect++,t[a].observations.push(o)}const s=Object.values(t).map(o=>({...o,successRate:o.total>0?Math.round(o.correct/o.total*100):0}));return s.sort((o,a)=>o.displayName.localeCompare(a.displayName)),s}),dr=E(()=>{const e=vo(),t={};for(const n of e){const o=n.skill_path||"uncategorized/unknown",a=Xm(o),r=zc(o);t[o]||(t[o]={skillPath:o,category:a,categoryName:Qm(a).name,skillName:r.name,total:0,correct:0,incorrect:0,observations:[]}),t[o].total++,n.correct?t[o].correct++:t[o].incorrect++,t[o].observations.push(n)}const s=Object.values(t).map(n=>({...n,successRate:n.total>0?Math.round(n.correct/n.total*100):0}));return s.sort((n,o)=>{const a=n.categoryName.localeCompare(o.categoryName);return a!==0?a:n.skillName.localeCompare(o.skillName)}),s}),Cu=E(()=>ga.value?ur.value.filter(e=>e.total>0):ur.value),Su=E(()=>ga.value?dr.value.filter(e=>e.total>0):dr.value);function $u(e){return e?e.replace(/_/g," ").replace(/([a-z])([A-Z])/g,"$1 $2").replace(/(\d)([a-zA-Z])/g,"$1 $2").split(" ").map(t=>t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()).join(" "):"Unknown"}const Mh=E(()=>Qr.value==="lessons"?Cu.value:Su.value),Uh=E(()=>gn.value.length>1),Fh=E(()=>gn.value.find(e=>e.id===es.value)||null),jh=E(()=>vo().length>0),Hh=E(()=>vo().length),Wh=E(()=>{const e=vo();if(e.length===0)return 0;const t=e.filter(s=>s.correct).length;return Math.round(t/e.length*100)});async function Vh(){const t=ze().currentUser.value;t&&(es.value=t.id,await wu(),await Zr())}function Kh(){io.value=[],gn.value=[],es.value=null,Qr.value="lessons",ga.value=!0,Xs.value=null,_n.value=!1,mo.value=[]}function gs(){return{loading:cr,error:Xs,selectedUserId:es,observations:io,accessibleUsers:gn,activeTab:Qr,onlyWithObservations:ga,useTestData:_n,testObservations:mo,enableTestMode:Dh,disableTestMode:Lh,lessonStats:ur,taxonStats:dr,filteredLessonStats:Cu,filteredTaxonStats:Su,currentStats:Mh,canViewOtherUsers:Uh,selectedUser:Fh,hasData:jh,totalObservations:Hh,overallSuccessRate:Wh,initialize:Vh,loadAccomplishments:Zr,selectUser:Bh,fetchAccessibleUsers:wu,reset:Kh,formatLessonName:$u}}const Gh="https://api.bridge-classroom.com/api",zh=5e3,fr=20;let ps=[],Gn=null;function Ht(e,t,s=null){const n={event:e,context:t,error:s instanceof Error?`${s.name}: ${s.message}`:s?String(s):null,user_agent:navigator.userAgent,timestamp:new Date().toISOString()};console.warn(`[diagnostic] ${e}:`,t,s||""),ps.push(n),ps.length>=fr?zn():Gn||(Gn=setTimeout(zn,zh))}async function zn(){if(Gn&&(clearTimeout(Gn),Gn=null),ps.length===0)return;const e=ps.splice(0);try{await fetch(`${Gh}/diagnostics`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({events:e})})}catch{ps.unshift(...e),ps.length>fr*2&&(ps=ps.slice(-fr))}}const el="https://api.bridge-classroom.com/api",ku="8a3ccc23767bdcbe6bb1709dfe3f20194dc0b8b4874939244e802dc71a21a568",$t=R("idle"),xu=R(null),Js=R(null),Qs=R(0),Zs=R(navigator.onLine),Pn=R(!1),yi=5,Jh=1e3,Yh=6e4,qh=5e3;let rn=null;function Xh(e){const t=Math.min(Jh*Math.pow(2,e),Yh);return t+Math.random()*t*.25}async function Au(e){var t;try{const s={user_id:e.id,first_name:e.firstName||"",last_name:e.lastName||"",email:e.email||"",classroom:((t=e.classrooms)==null?void 0:t[0])||null,data_consent:e.dataConsent??!0};e.adminGrantPayload&&(s.admin_grant=e.adminGrantPayload),e.secretKey&&(s.secret_key=e.secretKey);const n=await fetch(`${el}/users`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!n.ok){const a=await n.text();return Ht("server_registration_http_error",`registerUserWithServer  HTTP ${n.status} for user ${e.id} (${e.email})`,a),{success:!1,error:`Server error: ${n.status} - ${a}`}}const o=await n.json();return o.existing_user?{success:!1,error:"email_exists",existingUserId:o.user_id}:{success:o.success,userId:o.user_id}}catch(s){return Ht("server_registration_failed",`registerUserWithServer  fetch threw for user ${e.id} (${e.email})`,s),{success:!1,error:s.message}}}async function Tu(e){if(e.length===0)return{success:!0,synced:0,errors:[]};const t=e.filter(s=>s.encrypted);if(t.length===0)return{success:!0,synced:0,errors:[]};try{const s={observations:t.map(a=>({encrypted_data:a.encrypted_data,iv:a.iv,metadata:a.metadata}))},n=await fetch(`${el}/observations`,{method:"POST",headers:{"Content-Type":"application/json","x-api-key":ku},body:JSON.stringify(s)});if(!n.ok){const a=await n.text();return{success:!1,errors:[`Server error: ${n.status} - ${a}`]}}const o=await n.json();return{success:!0,synced:o.stored,errors:o.errors||[]}}catch(s){return console.error("Failed to sync observations:",s),{success:!1,errors:[s.message]}}}async function ho(){var n,o;const e=ze(),t=ws();if(!navigator.onLine)return $t.value="offline",{success:!1,offline:!0};$t.value="syncing",Js.value=null;const s={success:!0,userRegistered:!1,observationsSynced:0};try{const a=e.currentUser.value;if(a&&!a.serverRegistered){const c=await Au(a);if(c.success)e.updateUser(a.id,{serverRegistered:!0}),Pn.value=!1,s.userRegistered=!0,console.log("User registered with server");else{if(c.error==="email_exists")return Ht("server_registration_email_exists",`performSync  email already registered for user ${a.id} (${a.email})`),$t.value="error",Js.value="Account already exists. Please use recovery.",Pn.value=!0,s;Ht("server_registration_rejected",`performSync  registration failed for user ${a.id} (${a.email})`,c.error),Pn.value=!0,Js.value=`Registration failed: ${c.error}`}}const r=await t.encryptPendingObservations();r>0&&console.log(`Encrypted ${r} observations`);let i=!1;if(a!=null&&a.dataConsent){const c=t.getPendingObservations();if(c.length>0){const u=await Tu(c);if(u.success&&u.synced>0){const f=c.filter(d=>d.encrypted).slice(0,u.synced).map(d=>{var p;return(p=d.metadata)==null?void 0:p.observation_id});s.observationsSynced=u.synced,console.log(`Synced ${u.synced} observations`);try{await gs().loadAccomplishments(!0)}catch{}t.removeSyncedObservations(f)}u.success?((o=u.errors)==null?void 0:o.length)>0&&console.warn("Sync errors:",u.errors):(i=!0,Js.value=((n=u.errors)==null?void 0:n[0])||"Observation sync failed",console.warn("Observation sync failed:",u.errors))}}return Pn.value||i?$t.value="error":($t.value="idle",xu.value=new Date().toISOString(),Qs.value=0),s}catch(a){return console.error("Sync failed:",a),Js.value=a.message,$t.value="error",s.success=!1,s}}function pr(){rn&&clearTimeout(rn),rn=setTimeout(async()=>{await ho()},qh)}async function Nu(){return rn&&(clearTimeout(rn),rn=null),await ho()}async function Eu(){if(Qs.value>=yi){console.log("Max retries reached, giving up"),$t.value="error";return}const e=Xh(Qs.value);Qs.value++,console.log(`Retrying sync in ${Math.round(e/1e3)}s (attempt ${Qs.value}/${yi})`),setTimeout(async()=>{const t=await ho();!t.success&&t.offline!==!0&&Eu()},e)}function Qh(){var i;const e=ze(),t=ws(),s=(i=e.currentUser)==null?void 0:i.value;if(!(s!=null&&s.dataConsent))return;const o=t.getPendingObservations().filter(c=>c.encrypted);if(o.length===0)return;const a={observations:o.map(c=>({encrypted_data:c.encrypted_data,iv:c.iv,metadata:c.metadata}))},r=new Blob([JSON.stringify(a)],{type:"application/json"});navigator.sendBeacon(`${el}/observations?api_key=${ku}`,r),console.log("Sent beacon with",o.length,"observations")}function Zh(){window.addEventListener("online",()=>{Zs.value=!0,console.log("Back online, triggering sync"),Nu()}),window.addEventListener("offline",()=>{Zs.value=!1,$t.value="offline",console.log("Gone offline")}),document.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&Zs.value&&(console.log("Tab visible, triggering sync"),pr())}),window.addEventListener("beforeunload",Qh),setInterval(()=>{document.visibilityState==="visible"&&Zs.value&&pr()},5*60*1e3)}async function eg(){Zh(),navigator.onLine?await ho():$t.value="offline"}function Ou(){const e=E(()=>$t.value==="syncing"),t=E(()=>$t.value==="offline"||!Zs.value),s=E(()=>$t.value==="error"),n=E(()=>ws().pendingCount.value>0);return{syncState:$t,lastSyncAt:xu,lastError:Js,retryCount:Qs,isOnline:Zs,registrationFailed:Pn,isSyncing:e,isOffline:t,hasError:s,needsSync:n,initialize:eg,performSync:ho,triggerSync:pr,forceSync:Nu,retrySync:Eu,registerUserWithServer:Au,syncObservationsToServer:Tu}}const tl="https://api.bridge-classroom.com/api",Iu="8a3ccc23767bdcbe6bb1709dfe3f20194dc0b8b4874939244e802dc71a21a568",ts=R(null),mr=R(!1),go=R(null);async function tg(){mr.value=!0;try{const e=await fetch(`${tl}/announcements/active`);if(!e.ok)return;const t=await e.json(),s=ts.value;ts.value=t.announcement||null,ts.value&&(!s||s.id!==ts.value.id)&&(go.value=null)}catch{}finally{mr.value=!1}}async function sg(e,t="info",s=null){const n={message:e,type:t};s&&(n.expires_at=s);const o=await fetch(`${tl}/admin/announcement`,{method:"POST",headers:{"Content-Type":"application/json","x-api-key":Iu},body:JSON.stringify(n)});if(!o.ok)throw new Error(`Failed to set announcement: ${o.status}`);const a=await o.json();return ts.value=a.announcement||null,go.value=null,a}async function ng(){const e=await fetch(`${tl}/admin/announcement`,{method:"DELETE",headers:{"x-api-key":Iu}});if(!e.ok)throw new Error(`Failed to clear announcement: ${e.status}`);ts.value=null,go.value=null}function og(){ts.value&&(go.value=ts.value.id)}function sl(){return{announcement:ts,loading:mr,dismissed:go,loadAnnouncement:tg,setAnnouncement:sg,clearAnnouncement:ng,dismiss:og}}const $s="https://api.bridge-classroom.com/api",ks="8a3ccc23767bdcbe6bb1709dfe3f20194dc0b8b4874939244e802dc71a21a568",Nn=R([]),xs=R([]),Ra=R(null),xt=R(!1),De=R(null);function wn(){async function e(c){xt.value=!0,De.value=null;try{const u=await fetch(`${$s}/assignments?student_id=${encodeURIComponent(c)}`,{headers:{"x-api-key":ks}});if(!u.ok){const d=await u.text();return De.value=d||`Server error (${u.status})`,null}const f=await u.json();if(f.success){const d=new Map;for(const p of f.assignments){const h=d.get(p.exercise_id);(!h||p.attempted_boards>h.attempted_boards)&&d.set(p.exercise_id,p)}Nn.value=Array.from(d.values())}else De.value=f.error||"Failed to fetch assignments";return f}catch(u){return console.error("Failed to fetch student assignments:",u),De.value="Unable to connect to server",null}finally{xt.value=!1}}async function t(c){xt.value=!0,De.value=null;try{const u=await fetch(`${$s}/assignments?assigned_by=${encodeURIComponent(c)}`,{headers:{"x-api-key":ks}});if(!u.ok){const d=await u.text();return De.value=d||`Server error (${u.status})`,null}const f=await u.json();return f.success?xs.value=f.assignments:De.value=f.error||"Failed to fetch assignments",f}catch(u){return console.error("Failed to fetch teacher assignments:",u),De.value="Unable to connect to server",null}finally{xt.value=!1}}async function s(c){xt.value=!0,De.value=null;try{const u=await fetch(`${$s}/assignments?classroom_id=${encodeURIComponent(c)}`,{headers:{"x-api-key":ks}});if(!u.ok){const d=await u.text();return De.value=d||`Server error (${u.status})`,null}const f=await u.json();return f.success?f.assignments:(De.value=f.error||"Failed to fetch assignments",[])}catch(u){return console.error("Failed to fetch classroom assignments:",u),De.value="Unable to connect to server",[]}finally{xt.value=!1}}async function n(c){xt.value=!0,De.value=null;try{const u=await fetch(`${$s}/assignments/${encodeURIComponent(c)}`,{headers:{"x-api-key":ks}});if(!u.ok){const d=await u.text();return De.value=d||`Server error (${u.status})`,null}const f=await u.json();return f.success?Ra.value=f.assignment:De.value=f.error||"Failed to fetch assignment",f}catch(u){return console.error("Failed to fetch assignment detail:",u),De.value="Unable to connect to server",null}finally{xt.value=!1}}async function o({exercise_id:c,classroom_id:u,student_id:f,assigned_by:d,due_at:p,sort_order:h}){xt.value=!0,De.value=null;try{const g=await fetch(`${$s}/assignments`,{method:"POST",headers:{"Content-Type":"application/json","x-api-key":ks},body:JSON.stringify({exercise_id:c,classroom_id:u||null,student_id:f||null,assigned_by:d,due_at:p||null,sort_order:h??null})});if(!g.ok){const $=await g.text();return De.value=$||`Server error (${g.status})`,{success:!1,error:De.value}}const y=await g.json();return y.success?xs.value=[y.assignment,...xs.value]:De.value=y.error||"Failed to create assignment",y}catch(g){return console.error("Failed to create assignment:",g),De.value="Unable to connect to server",{success:!1,error:"Unable to connect to server"}}finally{xt.value=!1}}async function a(c){try{const u=await fetch(`${$s}/assignments/${encodeURIComponent(c)}`,{method:"DELETE",headers:{"x-api-key":ks}});if(!u.ok){const d=await u.text();return De.value=d||`Server error (${u.status})`,{success:!1,error:De.value}}const f=await u.json();return f.success&&(xs.value=xs.value.filter(d=>d.id!==c),Nn.value=Nn.value.filter(d=>d.id!==c)),f}catch(u){return console.error("Failed to delete assignment:",u),{success:!1,error:"Unable to connect to server"}}}async function r(c){try{const u=await fetch(`${$s}/exercises/${encodeURIComponent(c)}`,{headers:{"x-api-key":ks}});if(!u.ok)return null;const f=await u.json();return f.success?f.exercise.boards:null}catch(u){return console.error("Failed to fetch exercise boards:",u),null}}function i(){Nn.value=[],xs.value=[],Ra.value=null,xt.value=!1,De.value=null}return{studentAssignments:Nn,teacherAssignments:xs,currentAssignment:Ra,loading:xt,error:De,fetchStudentAssignments:e,fetchTeacherAssignments:t,fetchClassroomAssignments:s,fetchAssignmentDetail:n,createAssignment:o,deleteAssignment:a,fetchExerciseBoards:r,reset:i}}const ag={key:0,class:"minimal-hand"},rg={class:"seat-label-inline"},lg={class:"seat-label"},ig={key:0,class:"suits"},cg={key:0,class:"suit-row"},ug={key:0,class:"cards clickable-cards"},dg=["onClick"],fg={key:1,class:"cards"},pg={key:2,class:"cards"},mg={key:1,class:"hidden-hand"},vg={key:2,class:"hcp"},hg={__name:"HandDisplay",props:{hand:{type:Object,default:null},seat:{type:String,required:!0,validator:e=>["N","E","S","W"].includes(e)},hidden:{type:Boolean,default:!1},showHcp:{type:Boolean,default:!1},compact:{type:Boolean,default:!1},minimal:{type:Boolean,default:!1},clickable:{type:Boolean,default:!1},playedCards:{type:Array,default:null}},emits:["card-click"],setup(e){const t=e,s=Kc,n=E(()=>nr(t.seat)),o=E(()=>Vm(t.hand)),a=E(()=>t.hand?s.reduce(($,C)=>{var b;return $+(((b=t.hand[C])==null?void 0:b.length)||0)},0):0),r=E(()=>a.value>0&&a.value<5);function i($){return t.hand&&t.hand[$]&&t.hand[$].length>0}function c($){return Wr[$]}function u($){return Hm($)}const f={spades:"S",hearts:"H",diamonds:"D",clubs:"C"};function d($){return f[$]||$}function p($){if(!t.hand||!t.hand[$])return"";const C=t.hand[$];return C.length===0?"":C.map(Oa).join(" ")}const h=E(()=>t.playedCards&&t.playedCards.length>0),g=E(()=>{if(!t.playedCards)return null;const $=new Set;for(const C of t.playedCards){const b=C[0].toUpperCase(),w=C.slice(1).toUpperCase(),A={S:"spades",H:"hearts",D:"diamonds",C:"clubs"}[b];A&&$.add(`${A}:${w}`)}return $});function y($,C){return g.value?g.value.has(`${$}:${C}`):!1}return($,C)=>(m(),v("div",{class:le(["hand",{hidden:e.hidden,compact:e.compact,minimal:e.minimal,clickable:e.clickable}])},[e.minimal&&e.hidden?(m(),v("div",ag,[l("span",rg,_(e.seat),1),(m(!0),v(Q,null,ae(B(s),b=>(m(),v("span",{key:b,class:le(["suit-symbol-inline",u(b)])},_(c(b)),3))),128))])):(m(),v(Q,{key:1},[l("div",lg,_(n.value),1),!e.hidden&&e.hand?(m(),v("div",ig,[(m(!0),v(Q,null,ae(B(s),b=>(m(),v(Q,{key:b},[!r.value||i(b)?(m(),v("div",cg,[l("span",{class:le(["suit-symbol",u(b)])},_(c(b)),3),e.clickable?(m(),v("span",ug,[(m(!0),v(Q,null,ae(e.hand[b],w=>(m(),v("span",{key:w,class:le(y(b,w)?"card-played":"card-clickable"),onClick:A=>!y(b,w)&&$.$emit("card-click",{suit:d(b),rank:w})},_(B(Oa)(w)),11,dg))),128))])):h.value?(m(),v("span",fg,[(m(!0),v(Q,null,ae(e.hand[b],w=>(m(),v("span",{key:w,class:le({"card-played":y(b,w)})},_(B(Oa)(w)),3))),128))])):(m(),v("span",pg,_(p(b)),1))])):F("",!0)],64))),128))])):e.hidden?(m(),v("div",mg,[...C[0]||(C[0]=[l("div",{class:"card-back"},null,-1)])])):F("",!0),e.showHcp&&e.hand&&!e.hidden&&!r.value?(m(),v("div",vg,_(o.value)+" HCP ",1)):F("",!0)],64))],2))}},xo=be(hg,[["__scopeId","data-v-128fc7ed"]]),gg={class:"ns-column north-row"},yg={key:0,class:"position north"},bg={key:0,class:"position west"},_g={class:"center"},wg={key:1,class:"position east"},Cg={class:"ns-column south-row"},Sg={key:0,class:"position south"},$g={__name:"BridgeTable",props:{hands:{type:Object,required:!0,default:()=>({N:null,E:null,S:null,W:null})},hiddenSeats:{type:Array,default:()=>[]},showHcp:{type:Boolean,default:!1},compact:{type:Boolean,default:!1},clickableSeat:{type:String,default:null},playedCards:{type:Object,default:null}},emits:["card-click"],setup(e){return(t,s)=>{var n,o,a,r;return m(),v("div",{class:le(["bridge-table",{compact:e.compact}])},[l("div",gg,[!e.hiddenSeats.includes("N")&&e.hands.N?(m(),v("div",yg,[ge(xo,{hand:e.hands.N,seat:"N",showHcp:e.showHcp,clickable:e.clickableSeat==="N",playedCards:(n=e.playedCards)==null?void 0:n.N,onCardClick:s[0]||(s[0]=i=>t.$emit("card-click",{seat:"N",...i}))},null,8,["hand","showHcp","clickable","playedCards"])])):F("",!0)]),!e.hiddenSeats.includes("W")&&e.hands.W?(m(),v("div",bg,[ge(xo,{hand:e.hands.W,seat:"W",showHcp:e.showHcp,clickable:e.clickableSeat==="W",playedCards:(o=e.playedCards)==null?void 0:o.W,onCardClick:s[1]||(s[1]=i=>t.$emit("card-click",{seat:"W",...i}))},null,8,["hand","showHcp","clickable","playedCards"])])):F("",!0),l("div",_g,[af(t.$slots,"center",{},void 0)]),!e.hiddenSeats.includes("E")&&e.hands.E?(m(),v("div",wg,[ge(xo,{hand:e.hands.E,seat:"E",showHcp:e.showHcp,clickable:e.clickableSeat==="E",playedCards:(a=e.playedCards)==null?void 0:a.E,onCardClick:s[2]||(s[2]=i=>t.$emit("card-click",{seat:"E",...i}))},null,8,["hand","showHcp","clickable","playedCards"])])):F("",!0),l("div",Cg,[!e.hiddenSeats.includes("S")&&e.hands.S?(m(),v("div",Sg,[ge(xo,{hand:e.hands.S,seat:"S",showHcp:e.showHcp,clickable:e.clickableSeat==="S",playedCards:(r=e.playedCards)==null?void 0:r.S,onCardClick:s[3]||(s[3]=i=>t.$emit("card-click",{seat:"S",...i}))},null,8,["hand","showHcp","clickable","playedCards"])])):F("",!0)])],2)}}},kg=be($g,[["__scopeId","data-v-ec6230a9"]]),xg={class:"bidding-box"},Ag={class:"bid-section"},Tg={class:"levels"},Ng=["onClick"],Eg={class:"strains"},Og=["disabled","onClick"],Ig=["innerHTML"],Rg={class:"special-bids"},Pg=["disabled"],Dg=["disabled"],Lg={__name:"BiddingBox",props:{lastBid:{type:String,default:null},lastBidWasDouble:{type:Boolean,default:!1},lastBidWasRedouble:{type:Boolean,default:!1},canDouble:{type:Boolean,default:!1},canRedouble:{type:Boolean,default:!1}},emits:["bid"],setup(e,{emit:t}){const s=e,n=t,o=R(1),a=[{value:"C",display:"",colorClass:"suit-black"},{value:"D",display:"",colorClass:"suit-red"},{value:"H",display:"",colorClass:"suit-red"},{value:"S",display:"",colorClass:"suit-black"},{value:"NT",display:"NT",colorClass:"suit-nt"}],r=E(()=>{if(!s.lastBid)return 0;const d=s.lastBid.match(/^(\d)/);return d?parseInt(d[1],10):0}),i=E(()=>{if(!s.lastBid)return-1;const d=["C","D","H","S","NT","N"],p=s.lastBid.match(/\d([CDHSN]T?)$/i);if(!p)return-1;const h=p[1].toUpperCase();return d.indexOf(h==="N"?"NT":h)});function c(d){o.value=d}function u(d,p){if(!d)return!1;const g=["C","D","H","S","NT"].indexOf(p);return d>r.value||d===r.value&&g>i.value}function f(d,p){u(d,p)&&n("bid",`${d}${p}`)}return(d,p)=>(m(),v("div",xg,[l("div",Ag,[l("div",Tg,[(m(),v(Q,null,ae(7,h=>l("button",{key:h,class:le(["level-btn",{active:o.value===h}]),onClick:g=>c(h)},_(h),11,Ng)),64))]),l("div",Eg,[(m(),v(Q,null,ae(a,h=>l("button",{key:h.value,class:le(["strain-btn",[h.colorClass,{disabled:!u(o.value,h.value)}]]),disabled:!u(o.value,h.value),onClick:g=>f(o.value,h.value)},[l("span",{innerHTML:h.display},null,8,Ig)],10,Og)),64))])]),l("div",Rg,[l("button",{class:"special-btn pass",onClick:p[0]||(p[0]=h=>d.$emit("bid","Pass"))}," Pass "),l("button",{class:"special-btn double",disabled:!e.canDouble,onClick:p[1]||(p[1]=h=>d.$emit("bid","X"))}," Double ",8,Pg),l("button",{class:"special-btn redouble",disabled:!e.canRedouble,onClick:p[2]||(p[2]=h=>d.$emit("bid","XX"))}," Redouble ",8,Dg)])]))}},Bg=be(Lg,[["__scopeId","data-v-38ccb98f"]]),Mg={class:"auction-table"},Ug={class:"rounds"},Fg=["innerHTML"],jg={key:1,class:"turn-indicator"},Hg={__name:"AuctionTable",props:{bids:{type:Array,default:()=>[]},dealer:{type:String,default:"N"},currentBidIndex:{type:Number,default:-1},wrongBidIndex:{type:Number,default:-1},correctBidIndex:{type:Number,default:-1},showTurnIndicator:{type:Boolean,default:!1}},setup(e){const t=e,s=E(()=>["W","N","E","S"].indexOf(t.dealer)),n=E(()=>{const u=[],f=t.bids;let d=0,p=0;for(;d<f.length||p===0&&f.length>0;){const h=[null,null,null,null],g=p===0?s.value:0;for(let y=g;y<4&&d<f.length;y++)h[y]=f[d],d++;if(h.some(y=>y!==null)&&u.push(h),p++,p>20)break}if(t.currentBidIndex>=f.length){const h=u[u.length-1],g=h?h.filter(y=>y!==null).length:0;if(u.length===1&&s.value,g===4||u.length>1&&g===4){const y=[null,null,null,null];u.push(y)}}return u});function o(u,f){return u===0?f-s.value:4-s.value+(u-1)*4+f}function a(u,f){const d=o(u,f);return d===t.currentBidIndex&&d>=t.bids.length}function r(u,f){return t.wrongBidIndex<0?!1:o(u,f)===t.wrongBidIndex}function i(u,f){return t.correctBidIndex<0?!1:o(u,f)===t.correctBidIndex}function c(u){return Vr(u).html}return(u,f)=>(m(),v("div",Mg,[f[0]||(f[0]=to('<div class="header" data-v-ac265db8><div class="header-cell" data-v-ac265db8>W</div><div class="header-cell" data-v-ac265db8>N</div><div class="header-cell" data-v-ac265db8>E</div><div class="header-cell" data-v-ac265db8>S</div></div>',1)),l("div",Ug,[(m(!0),v(Q,null,ae(n.value,(d,p)=>(m(),v("div",{key:p,class:"round"},[(m(!0),v(Q,null,ae(d,(h,g)=>(m(),v("div",{key:g,class:le(["bid-cell",{"current-turn":a(p,g),"wrong-bid":r(p,g),"correct-bid":i(p,g)}])},[h?(m(),v("span",{key:0,innerHTML:c(h)},null,8,Fg)):e.showTurnIndicator&&a(p,g)?(m(),v("span",jg,"?")):F("",!0)],2))),128))]))),128))])]))}},Wg=be(Hg,[["__scopeId","data-v-ac265db8"]]),Vg={class:"deal-info"},Kg={class:"board-number"},Gg={key:0,class:"board-popup"},zg={class:"popup-list"},Jg=["onClick"],Yg={class:"info-row"},qg={class:"info-item"},Xg={class:"value"},Qg={class:"info-item"},Zg={key:0,class:"contract-row"},ey={class:"info-item"},ty=["innerHTML"],sy={key:0,class:"label"},ny={key:0,class:"info-item"},oy=["innerHTML"],ay={key:1,class:"title"},ry={__name:"DealInfo",props:{boardNumber:{type:Number,default:0},dealer:{type:String,default:"N"},vulnerable:{type:String,default:"None"},contract:{type:String,default:""},declarer:{type:String,default:""},showContract:{type:Boolean,default:!1},openingLead:{type:String,default:""},title:{type:String,default:""},totalDeals:{type:Number,default:0},currentIndex:{type:Number,default:0},dealBoardNumbers:{type:Array,default:()=>[]}},emits:["goto"],setup(e,{emit:t}){const s=e,n=t,o=R(!1);function a(p){n("goto",p),o.value=!1}const r=E(()=>nr(s.dealer)),i=E(()=>nr(s.declarer)),c=E(()=>Wm(s.vulnerable)),u=E(()=>{var h;const p=(h=s.vulnerable)==null?void 0:h.toUpperCase();return p==="BOTH"||p==="ALL"?"vul-both":p==="NS"||p==="EW"?"vul-partial":"vul-none"}),f=E(()=>s.contract?Vr(s.contract).html:""),d=E(()=>{if(!s.openingLead)return"";const p=s.openingLead[0],h=s.openingLead.slice(1),g={S:"",H:"",D:"",C:""},y={S:"black",H:"red",D:"red",C:"black"},$=g[p]||p;return`<span class="${y[p]||"black"}">${$}</span>${h==="T"?"10":h}`});return(p,h)=>(m(),v("div",Vg,[l("div",{class:"board-selector",onMouseenter:h[0]||(h[0]=g=>o.value=!0),onMouseleave:h[1]||(h[1]=g=>o.value=!1)},[l("div",Kg,"Board "+_(e.boardNumber),1),o.value&&e.totalDeals>1?(m(),v("div",Gg,[h[2]||(h[2]=l("div",{class:"popup-header"},"Select Board",-1)),l("div",zg,[(m(!0),v(Q,null,ae(e.totalDeals,g=>(m(),v("button",{key:g,class:le(["popup-item",{active:g-1===e.currentIndex}]),onClick:y=>a(g-1)}," Board "+_(e.dealBoardNumbers[g-1]||g),11,Jg))),128))])])):F("",!0)],32),l("div",Yg,[l("div",qg,[h[3]||(h[3]=l("span",{class:"label"},"Dealer:",-1)),l("span",Xg,_(r.value),1)]),l("div",Qg,[h[4]||(h[4]=l("span",{class:"label"},"Vul:",-1)),l("span",{class:le(["value",u.value])},_(c.value),3)])]),e.showContract&&e.contract?(m(),v("div",Zg,[l("div",ey,[l("span",{class:"value contract",innerHTML:f.value},null,8,ty),e.declarer?(m(),v("span",sy,"by "+_(i.value),1)):F("",!0)]),e.openingLead?(m(),v("div",ny,[h[5]||(h[5]=l("span",{class:"label"},"OL:",-1)),l("span",{class:"value lead-card",innerHTML:d.value},null,8,oy)])):F("",!0)])):F("",!0),e.title?(m(),v("div",ay,_(e.title),1)):F("",!0)]))}},ly=be(ry,[["__scopeId","data-v-5a844c49"]]),iy={class:"feedback-header"},cy={key:0,class:"icon"},uy={key:1,class:"icon"},dy={class:"title"},fy={key:0,class:"feedback-content"},py={class:"bid-comparison"},my={class:"bid-item your-bid"},vy=["innerHTML"],hy={class:"bid-item correct-bid"},gy=["innerHTML"],yy={key:1,class:"feedback-content"},by={class:"bid-comparison"},_y={class:"bid-item your-bid"},wy=["innerHTML"],Cy={class:"bid-item correct-bid"},Sy=["innerHTML"],$y=["innerHTML"],ky={class:"actions"},xy={__name:"FeedbackPanel",props:{visible:{type:Boolean,default:!1},type:{type:String,default:"wrong",validator:e=>["wrong","correct","info"].includes(e)},wrongBid:{type:String,default:""},correctBid:{type:String,default:""},wrongCardCode:{type:String,default:""},correctCardCode:{type:String,default:""},commentary:{type:String,default:""},showContinue:{type:Boolean,default:!0}},emits:["continue"],setup(e){const t=e,s=E(()=>t.type==="wrong"?"Incorrect":t.type==="correct"?"Correct!":"Information");function n(a){return Vr(a).html}function o(a){return Km(a).html}return(a,r)=>e.visible?(m(),v("div",{key:0,class:le(["feedback-panel",e.type])},[l("div",iy,[e.type==="wrong"?(m(),v("span",cy,"")):e.type==="correct"?(m(),v("span",uy,"")):F("",!0),l("span",dy,_(s.value),1)]),e.wrongBid?(m(),v("div",fy,[l("div",py,[l("div",my,[r[1]||(r[1]=l("span",{class:"label"},"Your bid:",-1)),l("span",{class:"bid",innerHTML:n(e.wrongBid)},null,8,vy)]),l("div",hy,[r[2]||(r[2]=l("span",{class:"label"},"Correct bid:",-1)),l("span",{class:"bid",innerHTML:n(e.correctBid)},null,8,gy)])])])):F("",!0),e.wrongCardCode?(m(),v("div",yy,[l("div",by,[l("div",_y,[r[3]||(r[3]=l("span",{class:"label"},"Your card:",-1)),l("span",{class:"bid",innerHTML:o(e.wrongCardCode)},null,8,wy)]),l("div",Cy,[r[4]||(r[4]=l("span",{class:"label"},"Correct card:",-1)),l("span",{class:"bid",innerHTML:o(e.correctCardCode)},null,8,Sy)])])])):F("",!0),e.commentary?(m(),v("div",{key:2,class:"commentary",innerHTML:B(zs)(e.commentary)},null,8,$y)):F("",!0),l("div",ky,[e.showContinue?(m(),v("button",{key:0,class:"btn continue",onClick:r[0]||(r[0]=i=>a.$emit("continue"))}," Continue ")):F("",!0)])],2)):F("",!0)}},bi=be(xy,[["__scopeId","data-v-04368462"]]),Ay={class:"welcome-screen"},Ty={class:"welcome-card"},Ny={class:"welcome-header"},Ey={key:0,class:"welcome-body"},Oy={class:"form-group"},Iy={key:0,class:"error-message"},Ry={class:"form-group"},Py={key:0,class:"error-message"},Dy={class:"form-group"},Ly={key:0,class:"error-message"},By={key:0,class:"form-group"},My={class:"checkbox-group"},Uy=["value","checked","onChange"],Fy={key:1,class:"form-group"},jy={class:"single-classroom"},Hy={class:"form-group consent-group"},Wy={class:"checkbox-label consent-label"},Vy={key:0,class:"consent-details"},Ky=["disabled"],Gy={key:0},zy={key:1},Jy={key:1,class:"welcome-body returning"},Yy={key:2,class:"welcome-body switcher"},qy={class:"user-list"},Xy=["onClick"],Qy={class:"user-name"},Zy={key:0,class:"user-class"},eb={key:3,class:"welcome-body recovery-sent"},tb={class:"subtitle"},sb={class:"recovery-info"},nb={class:"code-entry"},ob=["disabled"],ab={key:0},rb={key:1},lb={key:0,class:"error-message"},ib={key:4,class:"welcome-body recovery-claiming"},cb={class:"subtitle"},ub={key:0,class:"recovery-error-panel"},db={class:"error-message"},fb={key:1,class:"loading-spinner"},pb={__name:"WelcomeScreen",emits:["userReady"],setup(e,{emit:t}){const s=t,n=po(),o=ze(),a="https://api.bridge-classroom.com/api",r=R("form"),i=R(""),c=R(""),u=R(""),f=R([]),d=R(!0),p=R({firstName:"",lastName:"",email:"",classrooms:""}),h=R(!1),g=R(!1),y=R(""),$=R(""),C=R(""),b=R(""),w=R("");wt(async()=>{o.initialize(),n.initializeFromUrl();const j=new URLSearchParams(window.location.search),D=j.get("recover"),ee=j.get("user_id");if(D&&ee){await ve(ee,D),window.history.replaceState({},document.title,window.location.pathname);return}o.hasUsers.value&&o.currentUser.value?r.value="returning":o.hasUsers.value?r.value="switcher":r.value="form",n.hasSingleClassroom.value&&(f.value=[n.singleClassroom.value.id])});const A=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,L=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),V=E(()=>i.value.trim().length>0&&c.value.trim().length>0&&u.value.trim().length>0&&A.test(u.value.trim())),U=E(()=>o.currentUser.value?o.currentUser.value.firstName:""),X=E(()=>n.teacherName.value?`${n.teacherName.value}'s Bridge Classroom`:"Bridge Bidding Practice");function q(){p.value={firstName:"",lastName:"",email:"",classrooms:""};let j=!0;return i.value.trim()||(p.value.firstName="First name is required",j=!1),c.value.trim()||(p.value.lastName="Last name is required",j=!1),u.value.trim()?A.test(u.value.trim())||(p.value.email="Please enter a valid email address",j=!1):(p.value.email="Email is required",j=!1),o.findUserByEmail(u.value)&&(p.value.email="This email is already registered on this device.",j=!1),j}async function ue(){const j=u.value.trim().toLowerCase();if(!navigator.onLine)return Ht("registration_offline","checkEmailOnServer  navigator.onLine is false, skipping server check"),!0;try{const D=await o.requestRecovery(j,a);return D.success?($.value=j,b.value=D.message,r.value="recovery-sent",!1):D.message&&D.message.includes("No account found")?!0:(Ht("registration_email_check_unexpected",`checkEmailOnServer  unexpected result for ${j}`,D.message),await zn(),p.value.email=D.message||"Unable to verify email. Please try again.",!1)}catch(D){return Ht("registration_email_check_failed",`checkEmailOnServer  fetch failed for ${j}`,D),await zn(),L?p.value.email="Safari is blocking the connection. Please try Chrome or Firefox, or enable Safari Developer Tools (Settings  Advanced  Show features for web developers).":p.value.email="Unable to connect to server. Please check your connection and try again. If using a VPN, try disabling it.",!1}}async function ve(j,D){r.value="recovery-claiming",g.value=!0,y.value="Recovering your account...",C.value="";try{const ee=await o.claimRecovery(j,D,a);ee.success&&ee.user?s("userReady",ee.user):(C.value=ee.error||"Recovery failed. Please try again.",r.value="form")}catch(ee){Ht("recovery_claim_failed",`handleRecoveryClaim  claimRecovery threw for userId=${j}`,ee),C.value="Unable to complete recovery. Please try again.",r.value="form"}finally{g.value=!1,y.value=""}}async function de(){if(w.value.trim().length===6){g.value=!0,y.value="Verifying code...",C.value="";try{const j=await o.claimRecoveryByCode($.value.trim(),w.value.trim(),a);j.success&&j.user?s("userReady",j.user):C.value=j.error||"Invalid code. Please check and try again."}catch(j){Ht("recovery_code_claim_failed",`handleClaimByCode  claimRecoveryByCode threw for ${$.value.trim()}`,j),C.value="Unable to connect to server. Please try again."}finally{g.value=!1,y.value=""}}}async function ye(){if(!q())return;if(g.value=!0,y.value="Checking account...",!await ue()){g.value=!1,y.value="";return}let D=[];n.hasSingleClassroom.value?D=[n.singleClassroom.value.id]:n.hasMultipleClassrooms.value&&(D=[...f.value]),y.value="Creating your secure encryption key...";try{const ee=await o.createUser({firstName:i.value,lastName:c.value,email:u.value,classrooms:D,dataConsent:d.value,apiUrl:a});s("userReady",ee)}catch(ee){const ke=ee instanceof Error?ee.message:String(ee);Ht("registration_create_user_failed",`handleSubmit  createUser threw for ${u.value.trim()}`,ee),await zn(),p.value.email=`Failed to create account: ${ke}. Please try again.`}finally{g.value=!1,y.value=""}}function Se(){s("userReady",o.currentUser.value)}function fe(){r.value="switcher"}function ie(j){o.switchUser(j),s("userReady",o.currentUser.value)}function H(){i.value="",c.value="",u.value="",f.value=n.hasSingleClassroom.value?[n.singleClassroom.value.id]:[],d.value=!0,p.value={firstName:"",lastName:"",email:"",classrooms:""},r.value="form"}function O(){o.currentUser.value?r.value="returning":o.hasUsers.value&&(r.value="switcher")}function M(j){const D=f.value.indexOf(j);D===-1?f.value.push(j):f.value.splice(D,1)}return(j,D)=>(m(),v("div",Ay,[l("div",Ty,[l("div",Ny,[l("h1",null,_(X.value),1)]),r.value==="form"?(m(),v("div",Ey,[D[16]||(D[16]=l("h2",null,"Welcome!",-1)),D[17]||(D[17]=l("p",{class:"subtitle"},"Please enter your name to get started.",-1)),l("form",{onSubmit:_t(ye,["prevent"]),class:"user-form"},[l("div",Oy,[D[8]||(D[8]=l("label",{for:"firstName"},"First Name",-1)),Be(l("input",{id:"firstName","onUpdate:modelValue":D[0]||(D[0]=ee=>i.value=ee),type:"text",placeholder:"Enter your first name",class:le({"has-error":p.value.firstName}),autocomplete:"given-name"},null,2),[[bt,i.value]]),p.value.firstName?(m(),v("span",Iy,_(p.value.firstName),1)):F("",!0)]),l("div",Ry,[D[9]||(D[9]=l("label",{for:"lastName"},"Last Name",-1)),Be(l("input",{id:"lastName","onUpdate:modelValue":D[1]||(D[1]=ee=>c.value=ee),type:"text",placeholder:"Enter your last name",class:le({"has-error":p.value.lastName}),autocomplete:"family-name"},null,2),[[bt,c.value]]),p.value.lastName?(m(),v("span",Py,_(p.value.lastName),1)):F("",!0)]),l("div",Dy,[D[10]||(D[10]=l("label",{for:"email"},"Email Address",-1)),Be(l("input",{id:"email","onUpdate:modelValue":D[2]||(D[2]=ee=>u.value=ee),type:"email",placeholder:"Enter your email address",class:le({"has-error":p.value.email}),autocomplete:"email"},null,2),[[bt,u.value]]),p.value.email?(m(),v("span",Ly,_(p.value.email),1)):F("",!0),D[11]||(D[11]=l("span",{class:"field-hint"},"Used for account recovery and sharing with your teacher",-1))]),B(n).hasMultipleClassrooms.value?(m(),v("div",By,[D[12]||(D[12]=l("label",null,"Select Your Class(es)",-1)),l("div",My,[(m(!0),v(Q,null,ae(B(n).availableClassrooms.value,ee=>(m(),v("label",{key:ee.id,class:"checkbox-label"},[l("input",{type:"checkbox",value:ee.id,checked:f.value.includes(ee.id),onChange:ke=>M(ee.id)},null,40,Uy),l("span",null,_(ee.name),1)]))),128))])])):B(n).hasSingleClassroom.value?(m(),v("div",Fy,[D[13]||(D[13]=l("label",null,"Class",-1)),l("div",jy,_(B(n).singleClassroom.value.name),1)])):F("",!0),l("div",Hy,[l("label",Wy,[Be(l("input",{type:"checkbox","onUpdate:modelValue":D[3]||(D[3]=ee=>d.value=ee)},null,512),[[Ur,d.value]]),D[14]||(D[14]=l("span",null," Preserve my practice history ",-1))]),l("button",{type:"button",class:"details-toggle",onClick:D[4]||(D[4]=ee=>h.value=!h.value)},_(h.value?"Hide details":"What data is preserved?"),1),h.value?(m(),v("div",Vy,[...D[15]||(D[15]=[to('<p data-v-903ed78e>Your practice history is saved online so you can track your progress over time.</p><p data-v-903ed78e><strong data-v-903ed78e>How it works:</strong></p><ul data-v-903ed78e><li data-v-903ed78e>Your data is encrypted with your personal key</li><li data-v-903ed78e>Only you and people you authorize can view it</li><li data-v-903ed78e>The site administrator can also access your data</li></ul><p data-v-903ed78e><strong data-v-903ed78e>What&#39;s preserved:</strong></p><ul data-v-903ed78e><li data-v-903ed78e>Which hands you practiced</li><li data-v-903ed78e>Your bidding choices (correct and incorrect)</li><li data-v-903ed78e>When you practiced</li></ul><p class="consent-note" data-v-903ed78e>You can change this setting anytime in Settings.</p>',6)])])):F("",!0)]),l("button",{type:"submit",class:"submit-btn",disabled:!V.value||g.value},[g.value?(m(),v("span",Gy,_(y.value),1)):(m(),v("span",zy,"Start Practicing"))],8,Ky)],32),B(o).hasUsers.value?(m(),v("button",{key:0,class:"back-link",onClick:O}," Back to user selection ")):F("",!0)])):r.value==="returning"?(m(),v("div",Jy,[l("h2",null,"Welcome back, "+_(U.value)+"!",1),D[18]||(D[18]=l("p",{class:"subtitle"},"Ready to continue practicing?",-1)),l("button",{class:"submit-btn",onClick:Se}," Continue "),l("button",{class:"switch-link",onClick:fe}," Not "+_(U.value)+"? Switch user ",1)])):r.value==="switcher"?(m(),v("div",Yy,[D[19]||(D[19]=l("h2",null,"Select User",-1)),D[20]||(D[20]=l("p",{class:"subtitle"},"Choose who's practicing today:",-1)),l("div",qy,[(m(!0),v(Q,null,ae(B(o).allUsers.value,ee=>{var ke;return m(),v("button",{key:ee.id,class:le(["user-item",{"is-current":ee.id===B(o).currentUserId.value}]),onClick:Me=>ie(ee.id)},[l("span",Qy,_(ee.firstName)+" "+_(ee.lastName),1),(ke=ee.classrooms)!=null&&ke.length?(m(),v("span",Zy,_(ee.classrooms.join(", ")),1)):F("",!0)],10,Xy)}),128))]),l("button",{class:"add-user-btn",onClick:H}," + Add New User "),B(o).currentUser.value?(m(),v("button",{key:0,class:"back-link",onClick:O}," Cancel ")):F("",!0)])):r.value==="recovery-sent"?(m(),v("div",eb,[D[25]||(D[25]=l("h2",null,"Check Your Email",-1)),l("p",tb,[D[21]||(D[21]=Ne(" We found an existing account for ",-1)),l("strong",null,_($.value),1),D[22]||(D[22]=Ne(". ",-1))]),l("div",sb,[l("p",null,_(b.value),1),D[23]||(D[23]=l("p",{class:"recovery-note"}," Click the link in the email, or enter the 6-digit code below. ",-1))]),l("div",nb,[D[24]||(D[24]=l("label",{for:"recoveryCode"},"Recovery Code",-1)),Be(l("input",{id:"recoveryCode","onUpdate:modelValue":D[5]||(D[5]=ee=>w.value=ee),type:"text",inputmode:"numeric",pattern:"[0-9]*",maxlength:"6",placeholder:"000000",class:"code-input",autocomplete:"one-time-code",onKeyup:Vo(de,["enter"])},null,544),[[bt,w.value]]),l("button",{class:"submit-btn",disabled:w.value.trim().length!==6||g.value,onClick:de},[g.value?(m(),v("span",ab,_(y.value),1)):(m(),v("span",rb,"Restore Account"))],8,ob),C.value?(m(),v("span",lb,_(C.value),1)):F("",!0)]),l("button",{class:"back-link",onClick:D[6]||(D[6]=ee=>r.value="form")}," Use a different email ")])):r.value==="recovery-claiming"?(m(),v("div",ib,[D[27]||(D[27]=l("h2",null,"Restoring Your Account",-1)),l("p",cb,_(y.value),1),C.value?(m(),v("div",ub,[l("p",db,_(C.value),1),l("button",{class:"back-link",onClick:D[7]||(D[7]=ee=>r.value="form")}," Try again ")])):(m(),v("div",fb,[...D[26]||(D[26]=[l("div",{class:"spinner"},null,-1)])]))])):F("",!0)])]))}},mb=be(pb,[["__scopeId","data-v-903ed78e"]]),As="https://api.bridge-classroom.com/api",Ws="8a3ccc23767bdcbe6bb1709dfe3f20194dc0b8b4874939244e802dc71a21a568",Ts=R([]),Vs=R(null),At=R(!1),Xe=R(null);function yo(){async function e(c){At.value=!0,Xe.value=null;try{const f=await(await fetch(`${As}/classrooms?teacher_id=${encodeURIComponent(c)}`,{headers:{"x-api-key":Ws}})).json();return f.success?Ts.value=f.classrooms:Xe.value=f.error||"Failed to fetch classrooms",f}catch(u){return console.error("Failed to fetch classrooms:",u),Xe.value="Unable to connect to server",null}finally{At.value=!1}}async function t(c,u,f){At.value=!0,Xe.value=null;try{const d=await fetch(`${As}/classrooms`,{method:"POST",headers:{"Content-Type":"application/json","x-api-key":Ws},body:JSON.stringify({teacher_id:c,name:u,description:f||null})});if(!d.ok){const h=await d.text();return Xe.value=h||`Server error (${d.status})`,{success:!1,error:Xe.value}}const p=await d.json();return p.success?Ts.value=[p.classroom,...Ts.value]:Xe.value=p.error||"Failed to create classroom",p}catch(d){return console.error("Failed to create classroom:",d),Xe.value="Unable to connect to server",{success:!1,error:"Unable to connect to server"}}finally{At.value=!1}}async function s(c){At.value=!0,Xe.value=null;try{const f=await(await fetch(`${As}/classrooms/${encodeURIComponent(c)}`,{headers:{"x-api-key":Ws}})).json();return f.success?Vs.value=f.classroom:Xe.value=f.error||"Failed to fetch classroom",f}catch(u){return console.error("Failed to fetch classroom detail:",u),Xe.value="Unable to connect to server",null}finally{At.value=!1}}async function n(c,u){try{const d=await(await fetch(`${As}/classrooms/${encodeURIComponent(c)}/members/${encodeURIComponent(u)}`,{method:"DELETE",headers:{"x-api-key":Ws}})).json();if(d.success&&Vs.value){Vs.value.members=Vs.value.members.filter(h=>h.student_id!==u);const p=Ts.value.findIndex(h=>h.id===c);p!==-1&&Ts.value[p].member_count--}return d}catch(f){return console.error("Failed to remove member:",f),{success:!1,error:"Unable to connect to server"}}}async function o(c){At.value=!0,Xe.value=null;try{const u=await fetch(`${As}/join/${encodeURIComponent(c)}`);return u.status===404?(Xe.value="Classroom not found",null):await u.json()}catch(u){return console.error("Failed to fetch join info:",u),Xe.value="Unable to connect to server",null}finally{At.value=!1}}async function a(c,u,f){At.value=!0,Xe.value=null;try{const p=await(await fetch(`${As}/join/${encodeURIComponent(c)}`,{method:"POST",headers:{"Content-Type":"application/json","x-api-key":Ws},body:JSON.stringify({student_id:u,encrypted_grant_payload:f})})).json();return p.success||(Xe.value=p.error||"Failed to join classroom"),p}catch(d){return console.error("Failed to join classroom:",d),Xe.value="Unable to connect to server",{success:!1,error:"Unable to connect to server"}}finally{At.value=!1}}async function r(c,u){try{return await(await fetch(`${As}/classrooms/${encodeURIComponent(c)}/members/leave`,{method:"POST",headers:{"Content-Type":"application/json","x-api-key":Ws},body:JSON.stringify({student_id:u})})).json()}catch(f){return console.error("Failed to leave classroom:",f),{success:!1,error:"Unable to connect to server"}}}function i(){Ts.value=[],Vs.value=null,At.value=!1,Xe.value=null}return{teacherClassrooms:Ts,currentClassroom:Vs,loading:At,error:Xe,fetchTeacherClassrooms:e,createClassroom:t,fetchClassroomDetail:s,removeMember:n,fetchJoinInfo:o,joinClassroom:a,leaveClassroom:r,reset:i}}const vb={class:"settings-panel"},hb={class:"settings-body"},gb={class:"settings-section"},yb={class:"info-row"},bb={class:"info-value"},_b={class:"info-row"},wb={class:"info-value"},Cb={class:"info-row"},Sb={class:"info-row"},$b={class:"info-value"},kb={key:1,class:"edit-form"},xb={class:"form-group"},Ab={class:"form-group"},Tb={class:"form-group"},Nb={class:"checkbox-label"},Eb={key:0,class:"settings-section"},Ob={class:"assignment-list"},Ib={class:"assignment-header"},Rb={class:"assignment-name"},Pb={class:"assignment-progress"},Db={class:"progress-bar"},Lb={class:"assignment-meta"},Bb={key:0},Mb={class:"assignment-list"},Ub={class:"assignment-header"},Fb={class:"assignment-name"},jb={class:"assignment-meta"},Hb={key:1,class:"settings-section"},Wb={class:"classroom-id"},Vb=["disabled","onClick"],Kb={class:"settings-section"},Gb={class:"toggle-row"},zb={class:"toggle-label"},Jb=["checked"],Yb={__name:"SettingsPanel",props:{visible:{type:Boolean,default:!1}},emits:["close","switchUser","logout","become-teacher"],setup(e,{emit:t}){const s=t,n=ze(),o=po(),a=va(),r=yo(),i=R(!1),c=R(""),u=R(""),f=R(!0),d=E(()=>n.currentUser.value),p=E(()=>{var X;return!d.value||!((X=d.value.classrooms)!=null&&X.length)?"No classroom assigned":d.value.classrooms.map(q=>{const ue=o.availableClassrooms.value.find(ve=>ve.id===q);return ue?ue.name:q}).join(", ")}),h=E(()=>a.getAllAssignments().filter(X=>X.completionPercent<100)),g=E(()=>a.getAllAssignments().filter(X=>X.completionPercent>=100));function y(){d.value&&(c.value=d.value.firstName,u.value=d.value.lastName,f.value=d.value.dataConsent,i.value=!0)}function $(){i.value=!1}function C(){d.value&&(n.updateUser(d.value.id,{firstName:c.value,lastName:u.value,dataConsent:f.value}),i.value=!1)}function b(){s("switchUser")}function w(){i.value=!1,s("close")}const A=R(null);async function L(X){if(!d.value||!confirm("Are you sure you want to leave this classroom? Your teacher will no longer see your progress for new assignments."))return;if(A.value=X,(await r.leaveClassroom(X,d.value.id)).success){const ue=d.value.classrooms||[];n.updateUser(d.value.id,{classrooms:ue.filter(ve=>ve!==X)})}A.value=null}function V(){d.value&&confirm("Remove your account from this device? Your data on the server is not affected. You can recover your account later using your email.")&&(n.deleteUser(d.value.id),o.clearConfig(),s("close"),s("logout"))}function U(X){return X?new Date(X).toLocaleDateString():"N/A"}return(X,q)=>{var ue,ve,de,ye,Se,fe,ie;return e.visible?(m(),v("div",{key:0,class:"settings-overlay",onClick:_t(w,["self"])},[l("div",vb,[l("div",{class:"settings-header"},[q[5]||(q[5]=l("h2",null,"Settings",-1)),l("button",{class:"close-btn",onClick:w,"aria-label":"Close"},"  ")]),l("div",hb,[l("section",gb,[q[12]||(q[12]=l("h3",null,"Your Profile",-1)),i.value?(m(),v("div",kb,[l("div",xb,[q[10]||(q[10]=l("label",{for:"editFirstName"},"First Name",-1)),Be(l("input",{id:"editFirstName","onUpdate:modelValue":q[1]||(q[1]=H=>c.value=H),type:"text"},null,512),[[bt,c.value]])]),l("div",Ab,[q[11]||(q[11]=l("label",{for:"editLastName"},"Last Name",-1)),Be(l("input",{id:"editLastName","onUpdate:modelValue":q[2]||(q[2]=H=>u.value=H),type:"text"},null,512),[[bt,u.value]])]),l("div",Tb,[l("label",Nb,[Be(l("input",{type:"checkbox","onUpdate:modelValue":q[3]||(q[3]=H=>f.value=H)},null,512),[[Ur,f.value]]),l("span",null,"Share practice results with "+_(B(o).teacherName.value||"teacher"),1)])]),l("div",{class:"button-row"},[l("button",{class:"primary-btn",onClick:C}," Save Changes "),l("button",{class:"secondary-btn",onClick:$}," Cancel ")])])):(m(),v(Q,{key:0},[l("div",yb,[q[6]||(q[6]=l("span",{class:"info-label"},"Name",-1)),l("span",bb,_((ue=d.value)==null?void 0:ue.firstName)+" "+_((ve=d.value)==null?void 0:ve.lastName),1)]),l("div",_b,[q[7]||(q[7]=l("span",{class:"info-label"},"Class",-1)),l("span",wb,_(p.value),1)]),l("div",Cb,[q[8]||(q[8]=l("span",{class:"info-label"},"Data Sharing",-1)),l("span",{class:le(["info-value",(de=d.value)!=null&&de.dataConsent?"enabled":"disabled"])},_((ye=d.value)!=null&&ye.dataConsent?"Enabled":"Disabled"),3)]),l("div",Sb,[q[9]||(q[9]=l("span",{class:"info-label"},"Member Since",-1)),l("span",$b,_(U((Se=d.value)==null?void 0:Se.createdAt)),1)]),l("div",{class:"button-row"},[l("button",{class:"secondary-btn",onClick:y}," Edit Profile "),l("button",{class:"secondary-btn",onClick:b}," Switch User ")]),((fe=d.value)==null?void 0:fe.role)!=="teacher"&&((ie=d.value)==null?void 0:ie.role)!=="admin"?(m(),v("button",{key:0,class:"become-teacher-btn",onClick:q[0]||(q[0]=H=>{s("close"),s("become-teacher")})}," Become a Teacher ")):F("",!0)],64))]),h.value.length||g.value.length?(m(),v("section",Eb,[q[16]||(q[16]=l("h3",null,"Assignments",-1)),h.value.length?(m(),v(Q,{key:0},[q[13]||(q[13]=l("h4",null,"Active",-1)),l("div",Ob,[(m(!0),v(Q,null,ae(h.value,H=>(m(),v("div",{key:H.id,class:"assignment-item"},[l("div",Ib,[l("span",Rb,_(H.name),1),l("span",Pb,_(H.completionPercent)+"%",1)]),l("div",Db,[l("div",{class:"progress-fill",style:st({width:`${H.completionPercent}%`})},null,4)]),l("div",Lb,[H.dueDate?(m(),v("span",Bb," Due: "+_(U(H.dueDate)),1)):F("",!0),l("span",null,_(H.completedDeals)+"/"+_(H.totalDeals)+" deals ",1)])]))),128))])],64)):F("",!0),g.value.length?(m(),v(Q,{key:1},[q[15]||(q[15]=l("h4",null,"Completed",-1)),l("div",Mb,[(m(!0),v(Q,null,ae(g.value,H=>(m(),v("div",{key:H.id,class:"assignment-item completed"},[l("div",Ub,[l("span",Fb,_(H.name),1),q[14]||(q[14]=l("span",{class:"assignment-check"},"",-1))]),l("div",jb," Completed "+_(U(H.lastPracticedAt)),1)]))),128))])],64)):F("",!0)])):F("",!0),d.value&&d.value.classrooms&&d.value.classrooms.length?(m(),v("section",Hb,[q[17]||(q[17]=l("h3",null,"My Classrooms",-1)),(m(!0),v(Q,null,ae(d.value.classrooms,H=>(m(),v("div",{key:H,class:"classroom-row"},[l("span",Wb,_(H),1),l("button",{class:"leave-btn",disabled:A.value===H,onClick:O=>L(H)},_(A.value===H?"Leaving...":"Leave"),9,Vb)]))),128))])):F("",!0),l("section",Kb,[q[19]||(q[19]=l("h3",null,"Display Options",-1)),l("div",Gb,[l("label",zb,[l("input",{type:"checkbox",checked:B(o).showLoadPbnOption.value,onChange:q[4]||(q[4]=H=>B(o).setUIPref("showLoadPbnOption",H.target.checked))},null,40,Jb),q[18]||(q[18]=l("span",null,'Show "Load your own PBN" option in lobby',-1))])])]),l("section",{class:"settings-section"},[q[20]||(q[20]=l("h3",null,"Data & Privacy",-1)),q[21]||(q[21]=l("p",{class:"section-note"}," Key backup and data export options will be available in a future update. ",-1)),l("button",{class:"remove-device-btn",onClick:V}," Remove account from this device "),q[22]||(q[22]=l("p",{class:"remove-note"}," Removes your local data only. Your server account is not affected and can be recovered via email. ",-1))])])])])):F("",!0)}}},qb=be(Yb,[["__scopeId","data-v-57179473"]]),Xb={class:"banner-content"},Qb={class:"assignment-info"},Zb={class:"assignment-title"},e_={class:"assignment-name"},t_={class:"assignment-meta"},s_={class:"progress-text"},n_={class:"progress-bar"},o_={key:0,class:"complete-badge"},a_={class:"return-text"},r_={__name:"AssignmentBanner",setup(e){const t=va(),s=E(()=>t.currentAssignment.value),n=E(()=>t.hasActiveAssignment.value),o=E(()=>t.assignmentProgress.value),a=E(()=>t.isAssignmentComplete.value),r=E(()=>t.inAssignmentMode.value),i=E(()=>{var y;if(!((y=s.value)!=null&&y.dueDate))return null;const p=new Date(s.value.dueDate);return Math.ceil((p-new Date)/(1e3*60*60*24))}),c=E(()=>i.value===null?null:i.value<0?"Overdue":i.value===0?"Due today":i.value===1?"Due tomorrow":`Due in ${i.value} days`),u=E(()=>i.value===null?"":i.value<0?"overdue":i.value<=1?"urgent":i.value<=3?"soon":"");function f(){t.exitAssignmentMode()}function d(){t.returnToAssignmentMode()}return(p,h)=>{var g,y;return n.value&&r.value?(m(),v("div",{key:0,class:le(["assignment-banner",{complete:a.value}])},[l("div",Xb,[l("div",Qb,[l("div",Zb,[h[0]||(h[0]=l("span",{class:"assignment-label"},"Assignment:",-1)),l("span",e_,_((g=s.value)==null?void 0:g.name),1)]),l("div",t_,[l("span",s_,_(o.value.completed)+" of "+_(o.value.total)+" deals ("+_(o.value.percent)+"%) ",1),c.value?(m(),v("span",{key:0,class:le(["due-text",u.value])},_(c.value),3)):F("",!0)])]),l("div",n_,[l("div",{class:le(["progress-fill",{complete:a.value}]),style:st({width:`${o.value.percent}%`})},null,6)]),l("button",{class:"exit-btn",onClick:f,title:"Practice freely without assignment tracking"}," Free Practice ")]),a.value?(m(),v("div",o_," Complete! ")):F("",!0)],2)):s.value&&!r.value?(m(),v("div",{key:1,class:"return-banner",onClick:d},[h[1]||(h[1]=l("span",{class:"return-icon"},"",-1)),l("span",a_," Return to assignment: "+_((y=s.value)==null?void 0:y.name)+" ("+_(o.value.percent)+"% complete) ",1)])):F("",!0)}}},l_=be(r_,[["__scopeId","data-v-a4095a6a"]]),i_=["innerHTML"],c_={__name:"AnnouncementBanner",setup(e){const t=sl(),s={red:{bg:"#ef5350",fg:"white"},yellow:{bg:"#ffeb3b",fg:"#333"},orange:{bg:"#ff9800",fg:"white"},green:{bg:"#4caf50",fg:"white"},grey:{bg:"#ccc",fg:"#666"}};function n(o){return o.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/:(\w+):/g,(r,i)=>{const c=s[i.toLowerCase()];return c?`<span class="ann-circle" style="background:${c.bg};color:${c.fg}"></span>`:r})}return(o,a)=>B(t).announcement.value&&B(t).dismissed.value!==B(t).announcement.value.id?(m(),v("div",{key:0,class:le(["announcement-banner",B(t).announcement.value.type])},[l("span",{class:"announcement-text",innerHTML:n(B(t).announcement.value.message)},null,8,i_),l("button",{class:"dismiss-btn",onClick:a[0]||(a[0]=r=>B(t).dismiss()),title:"Dismiss"},"")],2)):F("",!0)}},u_=be(c_,[["__scopeId","data-v-4b12409b"]]),d_={key:0,class:"status-content"},f_={key:1,class:"status-content offline"},p_={key:0,class:"badge"},m_={key:2,class:"status-content error"},v_={class:"status-text"},h_={key:0,class:"badge"},g_={key:3,class:"status-content pending"},y_={class:"status-text"},b_={key:4,class:"status-content synced"},__={__name:"SyncStatus",setup(e){const t=Ou(),s=ws(),n=E(()=>s.pendingCount.value),o=E(()=>t.registrationFailed.value?"Not registered":"Sync failed"),a=E(()=>t.isSyncing.value?"syncing":t.isOffline.value?"offline":t.hasError.value?"error":n.value>0?"pending":"synced");function r(){!t.isSyncing.value&&n.value>0&&t.forceSync()}function i(){t.retrySync()}return(c,u)=>(m(),v("div",{class:le(["sync-status",a.value]),onClick:r},[B(t).isSyncing.value?(m(),v("div",d_,[...u[0]||(u[0]=[l("span",{class:"spinner"},null,-1),l("span",{class:"status-text"},"Syncing...",-1)])])):B(t).isOffline.value?(m(),v("div",f_,[u[1]||(u[1]=l("span",{class:"icon"},"",-1)),u[2]||(u[2]=l("span",{class:"status-text"},"Offline",-1)),n.value>0?(m(),v("span",p_,_(n.value),1)):F("",!0)])):B(t).hasError.value?(m(),v("div",m_,[u[3]||(u[3]=l("span",{class:"icon"},"",-1)),l("span",v_,_(o.value),1),n.value>0?(m(),v("span",h_,_(n.value),1)):F("",!0),l("button",{class:"retry-btn",onClick:_t(i,["stop"])},"Retry")])):n.value>0?(m(),v("div",g_,[u[4]||(u[4]=l("span",{class:"icon"},"",-1)),l("span",y_,_(n.value)+" pending",1)])):(m(),v("div",b_,[...u[5]||(u[5]=[l("span",{class:"icon"},"",-1),l("span",{class:"status-text"},"Synced",-1)])]))],2))}},w_=be(__,[["__scopeId","data-v-8457149a"]]),Ru=[{path:"basic_bidding/major_suit_openings",name:"Major Suit Openings",category:"Basic Bidding",pbn:"Major.pbn",dealCount:20},{path:"basic_bidding/minor_suit_openings",name:"Minor Suit Openings",category:"Basic Bidding",pbn:"Minor.pbn",dealCount:20},{path:"basic_bidding/notrump_openings",name:"Notrump Openings",category:"Basic Bidding",pbn:"Notrump.pbn",dealCount:25},{path:"bidding_conventions/blackwood",name:"Blackwood",category:"Bidding Conventions",pbn:"Blackwood.pbn",dealCount:20},{path:"bidding_conventions/fourth_suit_forcing",name:"Fourth Suit Forcing",category:"Bidding Conventions",pbn:"FSF.pbn",dealCount:14},{path:"bidding_conventions/help_suit_game_try",name:"Help Suit Game Try",category:"Bidding Conventions",pbn:"Help.pbn",dealCount:10},{path:"bidding_conventions/jacoby_2nt_splinters",name:"Jacoby 2NT & Splinters",category:"Bidding Conventions",pbn:"Jacoby.pbn",dealCount:25},{path:"bidding_conventions/jacoby_transfers",name:"Jacoby Transfers",category:"Bidding Conventions",pbn:"Transfers.pbn",dealCount:25},{path:"bidding_conventions/new_minor_forcing",name:"New Minor Forcing",category:"Bidding Conventions",pbn:"NMF.pbn",dealCount:14},{path:"bidding_conventions/ogust",name:"Ogust",category:"Bidding Conventions",pbn:"Ogust.pbn",dealCount:10},{path:"bidding_conventions/preemptive_bids",name:"Preemptive Bids",category:"Bidding Conventions",pbn:"Preempt.pbn",dealCount:12},{path:"bidding_conventions/reverse_bids",name:"Reverse Bids",category:"Bidding Conventions",pbn:"Reverse.pbn",dealCount:14},{path:"bidding_conventions/reverse_drury",name:"Reverse Drury",category:"Bidding Conventions",pbn:"Drury.pbn",dealCount:8},{path:"bidding_conventions/roman_keycard",name:"Roman Keycard",category:"Bidding Conventions",pbn:"Roman.pbn",dealCount:20},{path:"bidding_conventions/stayman",name:"Stayman",category:"Bidding Conventions",pbn:"Stayman.pbn",dealCount:25},{path:"bidding_conventions/strong_2c",name:"Strong 2",category:"Bidding Conventions",pbn:"2Club.pbn",dealCount:20},{path:"bidding_conventions/two_over_one",name:"2/1 Game Force",category:"Bidding Conventions",pbn:"2over1.pbn",dealCount:28},{path:"bidding_conventions/weak_2s",name:"Weak Twos",category:"Bidding Conventions",pbn:"Weak2.pbn",dealCount:20},{path:"competitive_bidding/dont",name:"DONT",category:"Competitive Bidding",pbn:"DONT.pbn",dealCount:20},{path:"competitive_bidding/lebensohl",name:"Lebensohl",category:"Competitive Bidding",pbn:"Leben.pbn",dealCount:20},{path:"competitive_bidding/michaels_unusual",name:"Michaels & Unusual 2NT",category:"Competitive Bidding",pbn:"Michaels.pbn",dealCount:20},{path:"competitive_bidding/negative_doubles",name:"Negative Doubles",category:"Competitive Bidding",pbn:"Negative.pbn",dealCount:20},{path:"competitive_bidding/overcalls",name:"Overcalls",category:"Competitive Bidding",pbn:"Overcalls.pbn",dealCount:20},{path:"competitive_bidding/support_cuebids",name:"Support Cuebids",category:"Competitive Bidding",pbn:"Cue-bid.pbn",dealCount:10},{path:"competitive_bidding/takeout_doubles",name:"Takeout Doubles",category:"Competitive Bidding",pbn:"Takeout.pbn",dealCount:25},{path:"declarer_play/elimination_plays",name:"Elimination Plays",category:"Declarer Play",pbn:"Eliminations.pbn",dealCount:25},{path:"declarer_play/entry_management",name:"Entry Management",category:"Declarer Play",pbn:"Entries.pbn",dealCount:20},{path:"declarer_play/finessing",name:"Finessing",category:"Declarer Play",pbn:"Finesse.pbn",dealCount:20},{path:"declarer_play/holdup_plays",name:"Holdup Plays",category:"Declarer Play",pbn:"Holdup.pbn",dealCount:15},{path:"declarer_play/squeeze_plays",name:"Squeeze Plays",category:"Declarer Play",pbn:"Squeeze.pbn",dealCount:20},{path:"declarer_play/suit_establishment",name:"Suit Establishment",category:"Declarer Play",pbn:"Establishment.pbn",dealCount:20},{path:"declarer_play/trump_management",name:"Trump Management",category:"Declarer Play",pbn:"Trumpmgmt.pbn",dealCount:20},{path:"defense/defensive_signals",name:"Defensive Signals",category:"Defense",pbn:"Signals.pbn",dealCount:20},{path:"defense/opening_leads",name:"Opening Leads",category:"Defense",pbn:"OLead.pbn",dealCount:20},{path:"defense/second_hand_play",name:"Second Hand Play",category:"Defense",pbn:"SecondHand.pbn",dealCount:20},{path:"defense/third_hand_play",name:"Third Hand Play",category:"Defense",pbn:"ThirdHand.pbn",dealCount:20},{path:"partnership_bidding/advanced_forcing",name:"Advanced Forcing",category:"Partnership Bidding",pbn:"Partnership-AdvancedForcing.pbn",dealCount:24},{path:"partnership_bidding/basic_bidding",name:"Basic Bidding",category:"Partnership Bidding",pbn:"Partnership-BasicBidding.pbn",dealCount:24},{path:"partnership_bidding/basic_major",name:"Basic Major",category:"Partnership Bidding",pbn:"Partnership-BasicMajor.pbn",dealCount:24},{path:"partnership_bidding/basic_notrump",name:"Basic Notrump",category:"Partnership Bidding",pbn:"Partnership-BasicNotrump.pbn",dealCount:24},{path:"partnership_bidding/blackwood",name:"Blackwood",category:"Partnership Bidding",pbn:"Partnership-Blackwood.pbn",dealCount:24},{path:"partnership_bidding/jacoby_2nt",name:"Jacoby 2NT",category:"Partnership Bidding",pbn:"Partnership-Jacoby2NT.pbn",dealCount:24},{path:"partnership_bidding/negative_doubles",name:"Negative Doubles",category:"Partnership Bidding",pbn:"Partnership-NegativeDoubles.pbn",dealCount:24},{path:"partnership_bidding/overcalls",name:"Overcalls",category:"Partnership Bidding",pbn:"Partnership-Overcalls.pbn",dealCount:24},{path:"partnership_bidding/roman_key_card",name:"Roman Key Card",category:"Partnership Bidding",pbn:"Partnership-RomanKeyCard.pbn",dealCount:24},{path:"partnership_bidding/stayman_transfers",name:"Stayman & Transfers",category:"Partnership Bidding",pbn:"Partnership-StaymanTransfers.pbn",dealCount:24},{path:"partnership_bidding/two_club",name:"Two Club",category:"Partnership Bidding",pbn:"Partnership-TwoClub.pbn",dealCount:24},{path:"partnership_bidding/weak_twos",name:"Weak Twos",category:"Partnership Bidding",pbn:"Partnership-WeakTwos.pbn",dealCount:24},{path:"practice_deals/100_miscellaneous",name:"100 Miscellaneous Deals",category:"Practice Deals",pbn:"100Deals.pbn",dealCount:100},{path:"practice_deals/100_notrump",name:"100 Notrump Deals",category:"Practice Deals",pbn:"100NT.pbn",dealCount:100}];function C_(e){return Ru.find(t=>t.path===e)||null}Ru.reduce((e,t)=>e+t.dealCount,0);const Jn=36e5;function _i(e){if(!e||e.length===0)return"untried";const t=[...e].sort((f,d)=>f.ts-d.ts);if(!t[t.length-1].correct)return"struggling";const n=t[t.length-1],a=!t.slice(0,-1).reverse().find(f=>!f.correct&&n.ts-f.ts<Jn),r=t.slice(-5),i=r.filter(f=>f.correct).length,c=r.length-i;return a&&i/r.length>=.8&&c<=1?"mastered":r.filter(f=>f.correct?!t.filter(p=>p.ts<f.ts).reverse().find(p=>!p.correct&&f.ts-p.ts<Jn):!1).length>=1?"progressing":"struggling"}function S_(e,t={},s={}){const n={};return e.forEach(a=>{n[a.skill_path]||(n[a.skill_path]={});const r=a.deal_number;n[a.skill_path][r]||(n[a.skill_path][r]=[]),n[a.skill_path][r].push({correct:a.correct,ts:new Date(a.timestamp)})}),Object.entries(n).map(([a,r])=>{var A,L;const i=Object.keys(r).map(Number).sort((V,U)=>V-U);let c=0,u=0,f=0;i.forEach(V=>{const U=_i(r[V]);U==="mastered"?c++:U==="progressing"?u++:f++});const d=i.length,p=[];i.forEach(V=>{r[V].forEach(U=>p.push({...U,dealNum:V}))}),p.sort((V,U)=>V.ts-U.ts);const h=2*Jn,g=i.map(V=>{var Se;const U=r[V].slice().sort((fe,ie)=>fe.ts-ie.ts),X=_i(U),q=((Se=U[U.length-1])==null?void 0:Se.correct)??!1,ue=U.map((fe,ie)=>{if(fe.correct){const H=U.slice(0,ie).reverse().find(O=>!O.correct&&fe.ts-O.ts<Jn);return{ts:fe.ts,y:H?.75:1,correct:!0}}else{const H=U.slice(ie+1).find(O=>O.correct&&O.ts-fe.ts<Jn);return{ts:fe.ts,y:H?.5:0,correct:!1}}}),ve=5*60*1e3,de=ue.map(fe=>({...fe,vts:fe.ts.getTime(),rawTs:fe.ts.getTime()}));let ye=0;for(;ye<de.length;){let fe=ye;for(;fe+1<de.length&&de[fe+1].vts-de[fe].vts<ve;)fe++;if(fe>ye){const ie=de[fe].vts-de[ye].vts,H=Math.max(ie,h),O=ie>0?H/ie:1,M=de[ye].vts;for(let j=ye;j<=fe;j++)de[j].vts=M+(de[j].vts-M)*O}ye=fe+1}return{dealNum:V,status:X,lastCorrect:q,points:de}}),y=g.flatMap(V=>V.points.map(U=>U.rawTs)),$=y.length?Math.min(...y):0,b=(y.length?Math.max(...y):1)-$||1;g.forEach(V=>{V.points=V.points.map(U=>({...U,x:(U.rawTs-$)/b}))});const w=(()=>{const V=Object.values(r);if(V.length===0)return 0;const U=V.reduce((q,ue)=>{const ve=ue.slice(-5);return q+ve.filter(de=>de.correct).length},0),X=V.reduce((q,ue)=>q+Math.min(ue.length,5),0);return X>0?Math.round(U/X*100):0})();return{path:a,name:s[a]||a.split("/").pop().replace(/_/g," "),tried:d,mastered:c,progressing:u,struggling:f,totalBoards:t[a]??d,totalAttempts:p.length,recentRate:w,boardLines:g,firstActivity:(A=p[0])==null?void 0:A.ts,lastActivity:(L=p[p.length-1])==null?void 0:L.ts}}).sort((a,r)=>(r.lastActivity||0)-(a.lastActivity||0))}function $_(e){const t=new Set(e.map(o=>o.skill_path).filter(Boolean)),s={},n={};for(const o of t){const a=C_(o);if(a)s[o]=a.dealCount,n[o]=a.name;else{const r=zc(o);n[o]=r.name}}return{lessonTotals:s,lessonNames:n}}const en={mastered:"#10b981",progressing:"#3b82f6",struggling:"#f59e0b",untried:"#d1d5db"};function Pu(e){return e>=.9?"#10b981":e>=.6||e>=.4?"#f59e0b":"#f43f5e"}const k_={key:0,class:"sparkline-empty"},x_=["width","height"],A_=["x1","y1","x2","y2","stroke","stroke-width","stroke-dasharray"],T_=["d","stroke"],N_=["cx","cy","r","fill"],E_=5,O_=2.5,I_={__name:"StudentProgressSparkline",props:{boardLines:{type:Array,required:!0},width:{type:Number,default:280},height:{type:Number,default:70}},setup(e){const t=e,s=[1,.5,0],n={l:4,r:4,t:8,b:8},o=E(()=>t.width-n.l-n.r),a=E(()=>t.height-n.t-n.b),r=E(()=>{const d=t.boardLines.flatMap(g=>g.points.map(y=>y.x)),p=Math.min(...d),h=Math.max(...d);return{min:p,max:h,span:h-p||1}});function i(d){return n.t+(1-d)*a.value}function c(d,p){const h=p>=.9?1:p>0?.5:0;return{px:n.l+(d-r.value.min)/r.value.span*o.value,py:n.t+(1-h)*a.value,yMapped:h}}const u=E(()=>t.boardLines.map(d=>{const p=en[d.status]||"#6b7280",h=d.points.filter(y=>y.y!==.75).map(y=>c(y.x,y.y)),g=h.length>=2?h.map((y,$)=>`${$===0?"M":"L"}${y.px.toFixed(1)},${y.py.toFixed(1)}`).join(" "):"";return{color:p,pts:h,pathD:g}})),f=E(()=>{const d=t.boardLines.flatMap(g=>g.points.filter(y=>y.y!==.75).map(y=>({...c(y.x,y.y),y:y.y}))),p=new Array(d.length).fill(!1),h=[];return d.forEach((g,y)=>{if(p[y])return;const $=[g];p[y]=!0,d.forEach((A,L)=>{if(p[L])return;const V=A.px-g.px,U=A.py-g.py;Math.sqrt(V*V+U*U)<E_&&($.push(A),p[L]=!0)});const C=$.reduce((A,L)=>A+L.px,0)/$.length,b=$.reduce((A,L)=>A+L.py,0)/$.length,w=$.sort((A,L)=>L.yMapped-A.yMapped)[0].yMapped;h.push({px:C,py:b,y:w,n:$.length})}),h});return(d,p)=>!e.boardLines||e.boardLines.length===0?(m(),v("div",k_," No data ")):(m(),v("svg",{key:1,width:e.width,height:e.height,style:{overflow:"visible"}},[(m(),v(Q,null,ae(s,h=>l("line",{key:h,x1:n.l,y1:i(h),x2:n.l+o.value,y2:i(h),stroke:h===.5?"#d1d5db":"#e5e7eb","stroke-width":h===.5?1:.5,"stroke-dasharray":h===.5?"3,3":"none"},null,8,A_)),64)),(m(!0),v(Q,null,ae(u.value,(h,g)=>Be((m(),v("path",{key:"line-"+g,d:h.pathD,fill:"none",stroke:h.color,"stroke-width":"1","stroke-linejoin":"round","stroke-linecap":"round",opacity:"0.35"},null,8,T_)),[[Zf,h.pts.length>=2]])),128)),(m(!0),v(Q,null,ae(f.value,(h,g)=>(m(),v("circle",{key:"bubble-"+g,cx:h.px,cy:h.py,r:O_*Math.sqrt(h.n),fill:B(Pu)(h.y),stroke:"#fff","stroke-width":"0.8",opacity:"0.85"},null,8,N_))),128))],8,x_))}},R_=be(I_,[["__scopeId","data-v-a14e2bb7"]]),P_={class:"details-header"},D_={class:"details-title"},L_={class:"details-subtitle"},B_=["viewBox","height"],M_=["x","y","fill"],U_=["y","width","height","fill","fill-opacity"],F_=["x","y","fill"],j_=["x1","y1","x2","y2","stroke-dasharray"],H_=["x","y"],W_=["cx","cy","fill","onClick"],V_={key:0,class:"details-activity"},K_={class:"stats-row"},G_={class:"stat-value"},z_={class:"stat-label"},J_=["viewBox"],Y_=["x","y","width","height"],q_={class:"activity-dates"},X_={class:"details-legend"},Pa=7,wi=.3,Da=110,Ns=560,Yt=28,La=40,Ci=36e5,Ct=864e5,Q_={__name:"StudentProgressDetails",props:{lesson:{type:Object,required:!0},rawData:{type:Array,required:!0}},emits:["close","dot-click"],setup(e,{emit:t}){const s=e,n=t,o={t:16,r:20,b:40,l:Da},a=E(()=>{const w=new Set(s.lesson.boardLines.map(L=>L.dealNum)),A=s.lesson.totalBoards??Math.max(...w);return Array.from({length:A},(L,V)=>V+1)}),r=E(()=>a.value.length*Yt),i=E(()=>Ns+o.l+o.r),c=E(()=>r.value+o.t+o.b),u=E(()=>new Set(s.lesson.boardLines.map(w=>w.dealNum)));function f(w){return u.value.has(w)}function d(w){const A=s.lesson.boardLines.find(L=>L.dealNum===w);return A?en[A.status]||"#6b7280":"#d1d5db"}const p=E(()=>{const w=s.rawData.filter(H=>H.skill_path===s.lesson.path),A=a.value,L=w.map(H=>{const O=new Date(H.timestamp).getTime(),M=H.deal_number,j=A.indexOf(M);return{rawTs:O,dealNum:M,boardIdx:j,correct:H.correct,y:H.correct?1:0}});if(L.forEach(H=>{const O=L.filter(j=>j.dealNum===H.dealNum).sort((j,D)=>j.rawTs-D.rawTs),M=O.findIndex(j=>j.rawTs===H.rawTs&&j.correct===H.correct);if(H.correct){const j=O.slice(0,M).reverse().find(D=>!D.correct&&H.rawTs-D.rawTs<Ci);H.y=j?.75:1}else{const j=O.slice(M+1).find(D=>D.correct&&D.rawTs-H.rawTs<Ci);H.y=j?.5:0}}),L.length===0)return[];const V=L.map(H=>H.rawTs),U=Math.min(...V),X=Math.max(...V),q=Math.floor(U/Ct)*Ct,ve=(Math.floor(X/Ct)+1)*Ct-1-q||1,de=H=>o.l+(H.rawTs-q)/ve*Ns,ye=H=>o.t+H*Yt+Yt/2,Se=Pa*2*(1-wi),fe=Pa*2*(1-wi),ie=L.map(H=>({...H,px:de(H),py:ye(H.boardIdx)}));return A.forEach(H=>{const O=ie.filter(j=>j.dealNum===H),M={};O.forEach(j=>{const D=j.rawTs;M[D]||(M[D]=[]),M[D].push(j)}),Object.values(M).forEach(j=>{if(j.length<2)return;const D=j[0].py;j.forEach((ee,ke)=>{ee.py=D+(ke-(j.length-1)/2)*fe})})}),A.forEach(H=>{const O=ie.filter(D=>D.dealNum===H).sort((D,ee)=>D.px-ee.px),M=[];let j=0;for(;j<O.length;){let D=j;for(;D+1<O.length&&O[D+1].px-O[j].px<Se;)D++;M.push({start:j,end:D}),j=D+1}M.forEach((D,ee)=>{const ke=D.end-D.start+1;if(ke===1)return;const Me=(ke-1)*Se;let Ue;ee===0?Ue=O[D.start].px:ee===M.length-1?Ue=O[D.end].px-Me:Ue=(O[D.start].px+O[D.end].px)/2-Me/2;for(let Fe=0;Fe<ke;Fe++)O[D.start+Fe].px=Ue+Fe*Se})}),ie}),h=E(()=>[...p.value].sort((w,A)=>w.y-A.y)),g=E(()=>{const w=p.value;if(w.length===0)return[];const A=w.map(ve=>ve.rawTs),L=Math.min(...A),V=Math.max(...A),U=Math.floor(L/Ct)*Ct,q=(Math.floor(V/Ct)+1)*Ct-1-U||1,ue=5;return Array.from({length:ue},(ve,de)=>{const ye=de/(ue-1),Se=new Date(U+ye*q);return{x:o.l+ye*Ns,label:Se.toLocaleDateString("en-US",{month:"short",day:"numeric"})+" "+Se.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1})}})}),y=E(()=>{const w=p.value;if(w.length===0)return null;const A={};w.forEach(de=>{const ye=Math.floor(de.rawTs/Ct);A[ye]=(A[ye]||0)+1});const L=Object.keys(A).map(Number).sort();if(L.length===0)return null;const V=L[0],U=L[L.length-1],X=U-V+1,q=Math.max(...Object.values(A)),ue=Math.max(2,Ns/X-1);return{bars:L.map(de=>({dayKey:de,x:(de-V)/X*Ns,h:A[de]/q*La,w:ue,count:A[de],dateLabel:new Date(de*Ct).toLocaleDateString("en-US",{month:"short",day:"numeric"})})),barW:Ns,firstLabel:new Date(V*Ct).toLocaleDateString("en-US",{month:"short",day:"numeric"}),lastLabel:new Date(U*Ct).toLocaleDateString("en-US",{month:"short",day:"numeric"})}}),$=E(()=>{const w=p.value,A={};return w.forEach(L=>{const V=Math.floor(L.rawTs/Ct);A[V]=!0}),[{label:"Days active",value:Object.keys(A).length},{label:"Boards tried",value:s.lesson.tried},{label:"Observations",value:w.length}]}),C=[{color:"#10b981",label:"Clean success"},{color:"#f59e0b",label:"Corrected (fail then fix within 1 hour)"},{color:"#f43f5e",label:"Fail (uncorrected)"}];function b(w){return new Date(w).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1})}return(w,A)=>(m(),v("div",{class:"details-overlay",onClick:A[2]||(A[2]=_t(L=>w.$emit("close"),["self"]))},[l("div",{class:"details-panel",onClick:A[1]||(A[1]=_t(()=>{},["stop"]))},[l("div",P_,[l("div",null,[l("h2",D_,_(e.lesson.name),1),l("p",L_,_(e.lesson.tried)+" boards  "+_(e.lesson.totalAttempts)+" attempts ",1)]),l("button",{class:"details-close-btn",onClick:A[0]||(A[0]=L=>w.$emit("close"))}," close")]),(m(),v("svg",{viewBox:`0 0 ${i.value} ${c.value}`,width:"100%",height:c.value,class:"details-chart"},[(m(!0),v(Q,null,ae(a.value,(L,V)=>(m(),v("rect",{key:"bg-"+L,x:o.l,y:o.t+V*Yt,width:Ns,height:Yt,fill:V%2===0?"#ffffff":"#f9fafb"},null,8,M_))),128)),(m(!0),v(Q,null,ae(a.value,(L,V)=>(m(),v("g",{key:"label-"+L},[l("rect",{x:2,y:o.t+V*Yt+3,width:Da-14,height:Yt-6,rx:"3",fill:d(L),"fill-opacity":f(L)?.12:.05},null,8,U_),l("text",{x:Da-16,y:o.t+V*Yt+Yt/2+4,"text-anchor":"end","font-size":"13",fill:d(L),"font-family":"monospace"}," Board "+_(L)+_(f(L)?"":" "),9,F_)]))),128)),(m(!0),v(Q,null,ae(g.value,(L,V)=>(m(),v("line",{key:"grid-"+V,x1:L.x,y1:o.t,x2:L.x,y2:o.t+r.value,stroke:"#e5e7eb","stroke-width":"1","stroke-dasharray":V===0||V===g.value.length-1?"none":"3,4"},null,8,j_))),128)),(m(!0),v(Q,null,ae(g.value,(L,V)=>(m(),v("text",{key:"tick-"+V,x:L.x,y:o.t+r.value+14,"text-anchor":"middle","font-size":"9",fill:"#6b7280","font-family":"monospace"},_(L.label),9,H_))),128)),(m(!0),v(Q,null,ae(h.value,(L,V)=>(m(),v("circle",{key:"dot-"+V,cx:L.px,cy:L.py,r:Pa,fill:B(Pu)(L.y),stroke:"#fff","stroke-width":"1.5",opacity:"0.92",class:"obs-dot",onClick:_t(U=>n("dot-click",{rawTs:L.rawTs,dealNum:L.dealNum,correct:L.correct,event:U}),["stop"])},[l("title",null,"Board "+_(L.dealNum)+"  "+_(L.correct?"Correct":"Incorrect")+"  "+_(b(L.rawTs)),1)],8,W_))),128))],8,B_)),y.value?(m(),v("div",V_,[l("div",K_,[(m(!0),v(Q,null,ae($.value,L=>(m(),v("div",{class:"stat-item",key:L.label},[l("div",G_,_(L.value),1),l("div",z_,_(L.label),1)]))),128))]),(m(),v("svg",{width:"100%",viewBox:`0 0 ${y.value.barW} ${La}`,class:"activity-chart"},[(m(!0),v(Q,null,ae(y.value.bars,L=>(m(),v("rect",{key:L.dayKey,x:L.x,y:La-L.h,width:L.w,height:L.h,fill:"#3b82f6",opacity:"0.7",rx:"1"},[l("title",null,_(L.dateLabel)+": "+_(L.count)+" observations",1)],8,Y_))),128))],8,J_)),l("div",q_,[l("span",null,_(y.value.firstLabel),1),l("span",null,_(y.value.lastLabel),1)])])):F("",!0),l("div",X_,[(m(),v(Q,null,ae(C,L=>l("span",{key:L.label,class:"legend-item"},[l("span",{class:"legend-dot",style:st({backgroundColor:L.color})},null,4),Ne(" "+_(L.label),1)])),64))])])]))}},Z_=be(Q_,[["__scopeId","data-v-9a99b752"]]),e1={class:"obs-header-left"},t1={class:"obs-id"},s1={class:"obs-header-right"},n1={class:"timestamp"},o1={class:"obs-body"},a1={class:"obs-col"},r1={class:"card"},l1={class:"hands-grid"},i1={class:"deal-meta-top"},c1={class:"meta-row"},u1={class:"meta-value"},d1={class:"meta-row"},f1={class:"meta-value"},p1={class:"meta-row"},m1={class:"meta-value"},v1={class:"meta-row"},h1={class:"meta-value"},g1={class:"compass-north"},y1={class:"seat-label"},b1={key:0,class:"you-tag"},_1={class:"cards"},w1={key:1,class:"hidden-hand"},C1={class:"seat-label"},S1={key:0,class:"you-tag"},$1={class:"cards"},k1={key:1,class:"hidden-hand"},x1={class:"seat-label"},A1={key:0,class:"you-tag"},T1={class:"cards"},N1={key:1,class:"hidden-hand"},E1={class:"deal-meta-bottom"},O1={class:"meta-row"},I1={class:"meta-contract"},R1={class:"compass-south"},P1={class:"seat-label"},D1={key:0,class:"you-tag"},L1={class:"cards"},B1={key:1,class:"hidden-hand"},M1={class:"obs-col"},U1={class:"card"},F1={class:"auction-header"},j1={key:0,class:"split-cell"},H1={class:"pill-expected"},W1={key:1,class:"split-cell"},V1={class:"pill-expected"},K1={key:0,class:"pill-student"},G1={key:2,class:"auction-bid"},z1={key:0,class:"prompts-list"},J1={class:"prompt-num"},Y1={key:0,class:"prompt-detail"},q1={class:"pill-expected-sm"},X1={class:"pill-student-sm"},Q1={key:1,class:"prompt-ok"},Z1={key:1,class:"prompt-detail"},e0={class:"pill-expected-sm"},t0={class:"pill-student-sm"},s0={key:1,class:"prompt-ok"},n0={key:1,class:"prompt-meta"},o0={class:"prompt-meta-auction"},a0={key:2,class:"auction-legend"},r0={key:0,class:"legend-item"},l0={key:3,class:"auction-legend"},i0={key:0,class:"legend-item"},c0={class:"card"},u0={class:"info-grid"},d0={class:"info-item"},f0={class:"info-value"},p0={class:"info-item"},m0={class:"info-item"},v0={class:"info-value"},h0={class:"info-item"},g0={class:"info-value"},y0={class:"info-item full-width"},b0={class:"info-value mono"},_0={__name:"ObservationViewer",props:{obs:{type:Object,required:!0},initialX:{type:Number,default:100},initialY:{type:Number,default:100},zIndex:{type:Number,default:3e3}},emits:["close","focus"],setup(e,{emit:t}){const s=e,n=t,o=R(s.initialX),a=R(s.initialY);let r=!1,i=0,c=0;function u(H){r=!0,i=H.clientX-o.value,c=H.clientY-a.value,document.addEventListener("mousemove",f),document.addEventListener("mouseup",d),n("focus")}function f(H){r&&(o.value=H.clientX-i,a.value=H.clientY-c)}function d(){r=!1,document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",d)}Rr(()=>{document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",d)});const p=E(()=>s.obs.deal||{}),h=E(()=>s.obs.bid_prompt||{}),g=E(()=>s.obs.result||{}),y=E(()=>g.value.correct),$=E(()=>p.value.hands||{}),C=E(()=>p.value.student_seat),b=E(()=>h.value.prompt_index===-1||h.value.expected_bid==="BOARD"),w=E(()=>s.obs.prompts||[]),A=E(()=>w.value.length>0),L=E(()=>{if(!A.value)return{};const H=de.indexOf(p.value.dealer),O={};for(const j of w.value){if(j.type!=="bid"||!j.auction_so_far)continue;const D=H+j.auction_so_far.length;O[D]||(O[D]=[]),O[D].push(j)}const M={};for(const[j,D]of Object.entries(O)){const ee=D.find(Me=>!Me.correct);if(!ee)continue;const ke=D.some(Me=>Me.correct);M[j]={expected:ee.expected_bid,student:ee.student_bid,correct:!1,corrected:ke}}return M}),V=E(()=>{const H=w.value,O=new Map;for(const ee of H){const ke=ee.type==="bid"?`bid-${ee.prompt_index}`:`card-${H.indexOf(ee)}`;O.has(ke)||O.set(ke,[]),O.get(ke).push(ee)}let M=O.size,j=0,D=0;for(const ee of O.values()){const ke=ee.some(Ue=>!Ue.correct),Me=ee.some(Ue=>Ue.correct);ke&&(j++,Me&&D++)}return{total:M,wrong:j,corrected:D}}),U=E(()=>h.value.expected_bid),X=E(()=>g.value.student_bid),q=E(()=>h.value.auction_so_far||[]),ue=E(()=>((s.obs.observation_id||s.obs.id||"")+"").slice(0,8)+""),ve=E(()=>s.obs.timestamp?new Date(s.obs.timestamp).toLocaleString(void 0,{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}):""),de=["W","N","E","S"],ye=E(()=>{const H=p.value.full_auction,O=(typeof H=="string"?H:Array.isArray(H)?H.join(" "):"").split(" ").filter(Boolean),M=de.indexOf(p.value.dealer);return[...Array(Math.max(0,M)).fill(null),...O]}),Se=E(()=>de.indexOf(p.value.dealer)+q.value.length),fe=E(()=>{const H=[];for(let O=0;O<ye.value.length;O+=4)H.push(ye.value.slice(O,O+4));return H});function ie(H){if(!H)return null;if(typeof H=="object"&&H.spades!==void 0)return[{suit:"",cards:(H.spades||[]).join(""),color:"black"},{suit:"",cards:(H.hearts||[]).join(""),color:"red"},{suit:"",cards:(H.diamonds||[]).join(""),color:"red"},{suit:"",cards:(H.clubs||[]).join(""),color:"black"}];if(typeof H!="string")return null;const O=H.split(".");if(O.length<4)return null;const[M,j,D,ee]=O;return[{suit:"",cards:M,color:"black"},{suit:"",cards:j,color:"red"},{suit:"",cards:D,color:"red"},{suit:"",cards:ee,color:"black"}]}return(H,O)=>(m(),v("div",{class:"obs-viewer",style:st({left:o.value+"px",top:a.value+"px",zIndex:e.zIndex}),onMousedown:O[1]||(O[1]=M=>H.$emit("focus"))},[l("div",{class:"obs-header",onMousedown:_t(u,["prevent"])},[l("div",e1,[O[2]||(O[2]=l("span",{class:"suit-icon"},"",-1)),O[3]||(O[3]=l("span",{class:"obs-title"},"Observation Detail",-1)),l("span",t1,_(ue.value),1)]),l("div",s1,[l("span",n1,_(ve.value),1),l("span",{class:le(["result-badge",y.value?"correct":"incorrect"])},_(y.value?" Correct":" Incorrect"),3),l("button",{class:"close-btn",onClick:O[0]||(O[0]=M=>H.$emit("close")),title:"Close"},"")])],32),l("div",o1,[l("div",a1,[l("div",r1,[O[16]||(O[16]=l("div",{class:"card-title"},[l("span",{class:"suit-icon-sm"},""),Ne(" Hands")],-1)),l("div",l1,[l("div",i1,[l("div",c1,[O[4]||(O[4]=l("span",{class:"meta-label"},"Lesson",-1)),l("span",u1,_(p.value.subfolder),1)]),l("div",d1,[O[5]||(O[5]=l("span",{class:"meta-label"},"Deal",-1)),l("span",f1,"#"+_(p.value.deal_number),1)]),l("div",p1,[O[6]||(O[6]=l("span",{class:"meta-label"},"Dealer",-1)),l("span",m1,_(p.value.dealer),1)]),l("div",v1,[O[7]||(O[7]=l("span",{class:"meta-label"},"Vul",-1)),l("span",h1,_(p.value.vulnerability),1)])]),l("div",g1,[l("div",{class:le(["hand-cell",{student:C.value==="N"}])},[l("div",y1,[O[8]||(O[8]=Ne("N ",-1)),C.value==="N"?(m(),v("span",b1,"YOU")):F("",!0)]),ie($.value.north)?(m(!0),v(Q,{key:0},ae(ie($.value.north),M=>(m(),v("div",{key:M.suit,class:"holding-row"},[l("span",{class:le(["suit-pip",M.color])},_(M.suit),3),l("span",_1,_(M.cards||""),1)]))),128)):(m(),v("span",w1,"Hidden"))],2)]),O[13]||(O[13]=l("div",null,null,-1)),l("div",{class:le(["hand-cell",{student:C.value==="W"}])},[l("div",C1,[O[9]||(O[9]=Ne("W ",-1)),C.value==="W"?(m(),v("span",S1,"YOU")):F("",!0)]),ie($.value.west)?(m(!0),v(Q,{key:0},ae(ie($.value.west),M=>(m(),v("div",{key:M.suit,class:"holding-row"},[l("span",{class:le(["suit-pip",M.color])},_(M.suit),3),l("span",$1,_(M.cards||""),1)]))),128)):(m(),v("span",k1,"Hidden"))],2),O[14]||(O[14]=to('<div class="compass-center" data-v-a843b41c><div class="compass-rose" data-v-a843b41c><span class="cr-n" data-v-a843b41c>N</span><span class="cr-w" data-v-a843b41c>W</span><span class="cr-e" data-v-a843b41c>E</span><span class="cr-s" data-v-a843b41c>S</span></div></div>',1)),l("div",{class:le(["hand-cell",{student:C.value==="E"}])},[l("div",x1,[O[10]||(O[10]=Ne("E ",-1)),C.value==="E"?(m(),v("span",A1,"YOU")):F("",!0)]),ie($.value.east)?(m(!0),v(Q,{key:0},ae(ie($.value.east),M=>(m(),v("div",{key:M.suit,class:"holding-row"},[l("span",{class:le(["suit-pip",M.color])},_(M.suit),3),l("span",T1,_(M.cards||""),1)]))),128)):(m(),v("span",N1,"Hidden"))],2),l("div",E1,[l("div",O1,[O[11]||(O[11]=l("span",{class:"meta-label"},"Contract",-1)),l("span",I1,_(p.value.contract)+" by "+_(p.value.declarer),1)])]),l("div",R1,[l("div",{class:le(["hand-cell",{student:C.value==="S"}])},[l("div",P1,[O[12]||(O[12]=Ne("S ",-1)),C.value==="S"?(m(),v("span",D1,"YOU")):F("",!0)]),ie($.value.south)?(m(!0),v(Q,{key:0},ae(ie($.value.south),M=>(m(),v("div",{key:M.suit,class:"holding-row"},[l("span",{class:le(["suit-pip",M.color])},_(M.suit),3),l("span",L1,_(M.cards||""),1)]))),128)):(m(),v("span",B1,"Hidden"))],2)]),O[15]||(O[15]=l("div",null,null,-1))])])]),l("div",M1,[l("div",U1,[O[28]||(O[28]=l("div",{class:"card-title"},[l("span",{class:"suit-icon-sm"},""),Ne(" Auction")],-1)),l("div",F1,[(m(),v(Q,null,ae(["W","N","E","S"],M=>l("span",{key:M,class:"auction-dir"},_(M),1)),64))]),(m(!0),v(Q,null,ae(fe.value,(M,j)=>(m(),v("div",{key:j,class:"auction-row"},[(m(!0),v(Q,null,ae(M,(D,ee)=>(m(),v(Q,{key:ee},[A.value&&L.value[j*4+ee]?(m(),v("div",j1,[l("span",H1,_(L.value[j*4+ee].expected),1),l("span",{class:le(L.value[j*4+ee].corrected?"pill-corrected":"pill-student")},_(L.value[j*4+ee].student),3)])):!b.value&&!A.value&&j*4+ee===Se.value?(m(),v("div",W1,[l("span",V1,_(U.value),1),y.value?F("",!0):(m(),v("span",K1,_(X.value),1))])):(m(),v("span",G1,_(D||""),1))],64))),128))]))),128)),A.value?(m(),v("div",z1,[(m(!0),v(Q,null,ae(w.value,(M,j)=>(m(),v("div",{key:j,class:le(["prompt-row",M.correct?"prompt-correct":"prompt-wrong"])},[l("span",J1,"#"+_(j+1),1),M.type==="bid"?(m(),v("span",Y1,[O[18]||(O[18]=Ne(" Expected ",-1)),l("span",q1,_(M.expected_bid),1),M.correct?(m(),v("span",Q1,"")):(m(),v(Q,{key:0},[O[17]||(O[17]=Ne(" got ",-1)),l("span",X1,_(M.student_bid),1)],64))])):M.type==="card"?(m(),v("span",Z1,[O[20]||(O[20]=Ne(" Expected ",-1)),l("span",e0,_(M.expected_card),1),M.correct?(m(),v("span",s0,"")):(m(),v(Q,{key:0},[O[19]||(O[19]=Ne(" got ",-1)),l("span",t0,_(M.student_card),1)],64))])):F("",!0)],2))),128))])):b.value?(m(),v("div",n0,[O[21]||(O[21]=l("span",{class:"prompt-meta-label"},"Board summary",-1)),O[22]||(O[22]=l("span",{class:"prompt-meta-sep"},"",-1)),l("span",o0,_(y.value?"All prompts answered correctly":"Student made errors on this board"),1)])):F("",!0),!b.value&&!A.value?(m(),v("div",a0,[O[24]||(O[24]=l("span",{class:"legend-item"},[l("span",{class:"legend-dot green"}),Ne(" Expected")],-1)),y.value?F("",!0):(m(),v("span",r0,[...O[23]||(O[23]=[l("span",{class:"legend-dot red"},null,-1),Ne(" Student bid",-1)])])),O[25]||(O[25]=l("span",{class:"legend-item"},[l("span",{class:"legend-dot gray"}),Ne(" After this point")],-1))])):A.value?(m(),v("div",l0,[O[27]||(O[27]=l("span",{class:"legend-item"},[l("span",{class:"legend-dot green"}),Ne(" Expected")],-1)),w.value.some(M=>!M.correct)?(m(),v("span",i0,[...O[26]||(O[26]=[l("span",{class:"legend-dot red"},null,-1),Ne(" Student response",-1)])])):F("",!0)])):F("",!0)]),l("div",c0,[O[34]||(O[34]=l("div",{class:"card-title"},[l("span",{class:"suit-icon-sm"},""),Ne(" Result & Meta")],-1)),l("div",u0,[A.value?(m(),v(Q,{key:0},[l("div",d0,[O[29]||(O[29]=l("span",{class:"info-label"},"Prompts",-1)),l("span",f0,_(V.value.total),1)]),l("div",p0,[O[30]||(O[30]=l("span",{class:"info-label"},"Result",-1)),l("span",{class:"info-value",style:st({color:V.value.wrong===0?"var(--green)":"var(--red)"})},_(V.value.wrong===0?"All correct":`${V.value.wrong} error${V.value.wrong>1?"s":""}`)+_(V.value.corrected>0?`, ${V.value.corrected} fixed`:""),5)])],64)):(m(),v(Q,{key:1},[l("div",m0,[O[31]||(O[31]=l("span",{class:"info-label"},"Attempt #",-1)),l("span",v0,_(g.value.attempt_number),1)]),l("div",h0,[O[32]||(O[32]=l("span",{class:"info-label"},"Time Taken",-1)),l("span",g0,_(g.value.time_taken_ms===0?"n/a":g.value.time_taken_ms+" ms"),1)])],64)),l("div",y0,[O[33]||(O[33]=l("span",{class:"info-label"},"Skill Path",-1)),l("span",b0,_(e.obs.skill_path),1)])])])])])],36))}},w0=be(_0,[["__scopeId","data-v-a843b41c"]]),C0=30,S0={__name:"ObservationPopupManager",setup(e,{expose:t}){const s=R([]);let n=0,o=3e3;function a(u,f){const d=s.value.length*C0,p=f?Math.min(f.clientX+20+d,window.innerWidth-700):60+d,h=f?Math.min(f.clientY-40+d,window.innerHeight-400):60+d;o++,s.value.push({id:n++,obs:u,x:Math.max(10,p),y:Math.max(10,h),zIndex:o})}function r(u){s.value=s.value.filter(f=>f.id!==u)}function i(u){o++;const f=s.value.find(d=>d.id===u);f&&(f.zIndex=o)}function c(){s.value=[]}return t({openObservation:a,closeAll:c}),(u,f)=>(m(),Le(Wd,{to:"body"},[(m(!0),v(Q,null,ae(s.value,d=>(m(),Le(w0,{key:d.id,obs:d.obs,"initial-x":d.x,"initial-y":d.y,"z-index":d.zIndex,onClose:p=>r(d.id),onFocus:p=>i(d.id)},null,8,["obs","initial-x","initial-y","z-index","onClose","onFocus"]))),128))]))}},$0={class:"student-progress-panel"},k0={key:0,class:"sp-empty"},x0={class:"sp-header"},A0={class:"sp-header-row"},T0={key:0,class:"sp-name-badge"},N0={class:"sp-meta"},E0={key:0,class:"sp-activity-chart"},O0={class:"sp-activity-header"},I0={class:"sp-activity-meta"},R0={class:"sp-activity-body"},P0={class:"sp-activity-svg-wrap"},D0=["viewBox"],L0=["x"],B0=["x","y"],M0=["x1","x2","y2"],U0=["x","y","width","height","fill"],F0=["x","y"],j0=["x","y"],H0={class:"sp-activity-legend"},W0={class:"sp-legend"},V0={class:"sp-grid"},K0=["onClick"],G0={class:"sp-card-header"},z0={class:"sp-card-info"},J0={class:"sp-card-name"},Y0={class:"sp-card-meta"},q0={class:"sp-card-rate"},X0={class:"sp-card-sparkline"},Q0={class:"sp-mastery"},Z0={class:"sp-mastery-track"},ew=["title"],tw={class:"sp-mastery-legend"},sw={__name:"StudentProgressPanel",props:{observations:{type:Array,required:!0},studentName:{type:String,default:""},studentId:{type:String,default:""}},setup(e){const t=e,s=R(null),n=R(null),o=bn(),a=E(()=>{if(!t.observations||t.observations.length===0)return[];const{lessonTotals:$,lessonNames:C}=$_(t.observations);return S_(t.observations,$,C)}),r=E(()=>a.value.reduce(($,C)=>$+C.tried,0)),i=E(()=>a.value.reduce(($,C)=>$+C.totalAttempts,0)),c=[{color:"#10b981",label:"Success (clean)"},{color:"#f59e0b",label:"Corrected (fail then fix within 1 hr)"},{color:"#f43f5e",label:"Fail (uncorrected)"}];function u($){return`hsl(${Math.round($*360/a.value.length)}, 65%, 55%)`}function f($){return $>=75?"#10b981":$>=50?"#f59e0b":"#f43f5e"}function d($){return $?$.toLocaleDateString("en-US",{month:"short",day:"numeric"}):""}function p($){if(!$.firstActivity||!$.lastActivity)return null;const C=$.lastActivity-$.firstActivity,b=C/6e4,w=C/36e5,A=C/864e5;return b<90?`${Math.round(b)} min`:w<48?`${Math.round(w)} hr`:A<14?`${Math.round(A)} days`:`${Math.round(A/7)} wks`}async function h({rawTs:$,dealNum:C,correct:b,event:w}){if(n.value)if(t.studentId){const A=await o.findAndDecryptObservation(t.studentId,$,C,b);A&&n.value.openObservation(A,w)}else{const A=t.observations.find(L=>{const V=new Date(L.timestamp).getTime();return Math.abs(V-$)<1e3&&L.deal_number===C&&L.correct===b});A&&n.value.openObservation(A,w)}}function g($){const C=Math.max(0,($.totalBoards||0)-$.tried),b=[{count:$.mastered,color:en.mastered,label:"Mastered"},{count:$.progressing,color:en.progressing,label:"Progressing"},{count:$.struggling,color:en.struggling,label:"Struggling"},{count:C,color:en.untried,label:"Untried"}].filter(A=>A.count>0),w=b.reduce((A,L)=>A+L.count,0);return b.forEach(A=>{A.pct=`${(A.count/w*100).toFixed(1)}%`}),b}const y=E(()=>{if(a.value.length===0)return null;const $=864e5,C=28,b=700,w=120,A=new Set,L=a.value.map(Se=>{const fe={};return Se.boardLines.forEach(ie=>{ie.points.forEach(H=>{const O=Math.floor((H.rawTs??0)/$);O>0&&(fe[O]=(fe[O]||0)+1,A.add(O))})}),fe});if(A.size===0)return null;const V=[...A].sort(),U=V[0],X=V[V.length-1],q=X-U+1,ue=V.map(Se=>L.reduce((fe,ie)=>fe+(ie[Se]||0),0)),ve=Math.max(...ue),de=Math.max(1,b/q*.75);return{days:V.map(Se=>{const fe=C+(Se-U)/q*b;let ie=w;const H=[];return a.value.forEach((O,M)=>{const j=L[M][Se]||0;if(!j)return;const D=j/ve*w;ie-=D,H.push({y:ie,h:D,count:j,color:u(M),name:O.name})}),{dayKey:Se,x:fe,segments:H,dateLabel:new Date(Se*$).toLocaleDateString("en-US",{month:"short",day:"numeric"})}}),maxCount:ve,barW:de,barH:w,chartW:b,svgW:C+b,yAxisW:C,firstLabel:new Date(U*$).toLocaleDateString("en-US",{month:"short",day:"numeric"}),lastLabel:new Date(X*$).toLocaleDateString("en-US",{month:"short",day:"numeric"})}});return($,C)=>(m(),v("div",$0,[a.value.length===0?(m(),v("div",k0,[...C[1]||(C[1]=[l("p",null,"No practice data to display yet.",-1)])])):(m(),v(Q,{key:1},[l("div",x0,[l("div",A0,[e.studentName?(m(),v("span",T0,_(e.studentName),1)):F("",!0),l("span",N0,_(a.value.length)+" lesson"+_(a.value.length!==1?"s":"")+"  Click any panel to drill down",1)])]),y.value?(m(),v("div",E0,[l("div",O0,[C[2]||(C[2]=Ne(" Daily practice activity ",-1)),l("span",I0,_(r.value)+" boards  "+_(i.value)+" observations ",1)]),l("div",R0,[l("div",P0,[(m(),v("svg",{width:"100%",viewBox:`0 0 ${y.value.svgW} ${y.value.barH+26}`,style:st({display:"block",height:y.value.barH+26+"px"})},[l("text",{x:y.value.yAxisW-3,y:"12","text-anchor":"end","font-size":"10",fill:"#6b7280"},_(y.value.maxCount),9,L0),l("text",{x:y.value.yAxisW-3,y:y.value.barH,"text-anchor":"end","font-size":"10",fill:"#9ca3af"},"0",8,B0),l("line",{x1:y.value.yAxisW,y1:"0",x2:y.value.yAxisW,y2:y.value.barH,stroke:"#e5e7eb","stroke-width":"1"},null,8,M0),(m(!0),v(Q,null,ae(y.value.days,b=>(m(),v("g",{key:b.dayKey},[(m(!0),v(Q,null,ae(b.segments,(w,A)=>(m(),v("rect",{key:A,x:b.x,y:w.y,width:y.value.barW,height:w.h,fill:w.color,opacity:"0.85",rx:"1"},[l("title",null,_(w.name)+": "+_(w.count)+" on "+_(b.dateLabel),1)],8,U0))),128))]))),128)),l("text",{x:y.value.yAxisW,y:y.value.barH+18,"font-size":"10",fill:"#6b7280"},_(y.value.firstLabel),9,F0),l("text",{x:y.value.yAxisW+y.value.chartW,y:y.value.barH+18,"text-anchor":"end","font-size":"10",fill:"#6b7280"},_(y.value.lastLabel),9,j0)],12,D0))]),l("div",H0,[(m(!0),v(Q,null,ae(a.value,(b,w)=>(m(),v("span",{key:b.path,class:"sp-activity-legend-item"},[l("span",{class:"sp-legend-dot",style:st({backgroundColor:u(w)})},null,4),Ne(" "+_(b.name),1)]))),128))])])])):F("",!0),l("div",W0,[(m(),v(Q,null,ae(c,b=>l("span",{key:b.label,class:"sp-legend-item"},[l("span",{class:"sp-legend-dot",style:st({backgroundColor:b.color})},null,4),Ne(" "+_(b.label),1)])),64)),C[3]||(C[3]=l("span",{class:"sp-legend-hint"},"line color = mastery status",-1))]),l("div",V0,[(m(!0),v(Q,null,ae(a.value,b=>(m(),v("div",{key:b.path,class:"sp-lesson-card",onClick:w=>s.value=b},[l("div",G0,[l("div",z0,[l("div",J0,_(b.name),1),l("div",Y0,_(b.tried)+" boards  "+_(b.totalAttempts)+" attempts  last "+_(d(b.lastActivity))+_(p(b)?`  span ${p(b)}`:""),1)]),l("div",q0,[l("div",{class:"sp-rate-value",style:st({color:f(b.recentRate)})},_(b.recentRate)+"% ",5),C[4]||(C[4]=l("div",{class:"sp-rate-label"},"recent accuracy",-1))])]),l("div",X0,[ge(R_,{boardLines:b.boardLines,width:280,height:70},null,8,["boardLines"])]),l("div",Q0,[l("div",Z0,[(m(!0),v(Q,null,ae(g(b),w=>(m(),v("div",{key:w.label,class:"sp-mastery-segment",style:st({width:w.pct,backgroundColor:w.color}),title:`${w.label}: ${w.count}`},null,12,ew))),128))]),l("div",tw,[(m(!0),v(Q,null,ae(g(b),w=>(m(),v("span",{key:w.label,class:"sp-mastery-item"},[l("span",{class:"sp-legend-dot",style:st({backgroundColor:w.color})},null,4),Ne(" "+_(w.count)+" "+_(w.label),1)]))),128))])]),C[5]||(C[5]=l("div",{class:"sp-card-hint"},"details ",-1))],8,K0))),128))])],64)),s.value?(m(),Le(Z_,{key:2,lesson:s.value,rawData:e.observations,onClose:C[0]||(C[0]=b=>s.value=null),onDotClick:h},null,8,["lesson","rawData"])):F("",!0),ge(S0,{ref_key:"popupManager",ref:n},null,512)]))}},Du=be(sw,[["__scopeId","data-v-c464baa7"]]),nw={class:"progress-dashboard"},ow={class:"dashboard-header"},aw={key:0,class:"loading"},rw={key:1,class:"error-state"},lw={key:2,class:"empty-state"},iw={key:3,class:"dashboard-content"},cw={class:"dashboard-actions"},uw={__name:"ProgressDashboard",emits:["close"],setup(e){const t=qr(),s=ze(),n=E(()=>t.decryptedObservations.value),o=E(()=>n.value.length>0),a=E(()=>{const i=s.currentUser.value;return i?`${i.firstName} ${i.lastName}`:""});wt(async()=>{await t.fetchProgress()});async function r(){await t.fetchProgress(!0)}return(i,c)=>(m(),v("div",nw,[l("header",ow,[c[3]||(c[3]=l("h2",null,"Student Progress",-1)),l("button",{class:"close-btn",onClick:c[0]||(c[0]=u=>i.$emit("close"))},"")]),B(t).isLoading.value?(m(),v("div",aw,[...c[4]||(c[4]=[l("div",{class:"spinner"},null,-1),l("p",null,"Loading your progress...",-1)])])):B(t).hasError.value?(m(),v("div",rw,[l("p",null,"Failed to load progress: "+_(B(t).error.value),1),l("button",{onClick:r},"Try Again")])):o.value?(m(),v("div",iw,[ge(Du,{observations:n.value,studentName:a.value},null,8,["observations","studentName"]),l("div",cw,[l("button",{class:"secondary-btn",onClick:r},"Refresh Data"),l("button",{class:"primary-btn",onClick:c[2]||(c[2]=u=>i.$emit("close"))},"Continue Practicing")])])):(m(),v("div",lw,[c[5]||(c[5]=l("h3",null,"No Practice Data Yet",-1)),c[6]||(c[6]=l("p",null,"Complete some practice deals to see your progress here!",-1)),l("button",{class:"primary-btn",onClick:c[1]||(c[1]=u=>i.$emit("close"))},"Start Practicing")]))]))}},dw=be(uw,[["__scopeId","data-v-286a38c8"]]),fw="test-user-mastery",pw="test-classroom",mw="Negative_Double",vw="competitive_bidding/negative_double";let vr=0;function tt({boardNumber:e,correct:t,timestamp:s}){return vr++,{id:`mastery-test-${vr}-${Math.random().toString(36).slice(2,8)}`,timestamp:s,user_id:fw,skill_path:vw,correct:t,deal_subfolder:mw,deal_number:e,classroom:pw}}function ht(e,t=10){const s=new Date;return s.setDate(s.getDate()-e),s.setHours(t,0,0,0),s.toISOString()}function Ao(e){return new Date(Date.now()-e*60*1e3).toISOString()}function hw(){vr=0;const e=[];e.push(tt({boardNumber:2,correct:!0,timestamp:ht(5)}),tt({boardNumber:2,correct:!1,timestamp:ht(1)})),e.push(tt({boardNumber:3,correct:!1,timestamp:Ao(30)}),tt({boardNumber:3,correct:!0,timestamp:Ao(20)})),e.push(tt({boardNumber:4,correct:!1,timestamp:Ao(90)}),tt({boardNumber:4,correct:!0,timestamp:Ao(60)})),e.push(tt({boardNumber:5,correct:!1,timestamp:ht(10)}),tt({boardNumber:5,correct:!0,timestamp:ht(2)})),e.push(tt({boardNumber:6,correct:!0,timestamp:ht(14)}),tt({boardNumber:6,correct:!0,timestamp:ht(7)})),e.push(tt({boardNumber:7,correct:!0,timestamp:ht(21)}),tt({boardNumber:7,correct:!0,timestamp:ht(14)}),tt({boardNumber:7,correct:!0,timestamp:ht(7)})),e.push(tt({boardNumber:8,correct:!0,timestamp:ht(28)}),tt({boardNumber:8,correct:!0,timestamp:ht(21)}),tt({boardNumber:8,correct:!0,timestamp:ht(14)}),tt({boardNumber:8,correct:!1,timestamp:ht(1)}));const t=[1,2,3,4,5].map(s=>({...tt({boardNumber:s,correct:!0,timestamp:ht(3)}),deal_subfolder:"Stayman",skill_path:"bidding_conventions/stayman"}));return e.push(...t),e}const gw=["onClick","title"],yw={key:0,class:"medal gold-medal"},bw={key:1,class:"medal silver-medal"},_w={class:"board-num"},ww={__name:"BoardMasteryStrip",props:{boardNumbers:{type:Array,required:!0},lessonSubfolder:{type:String,required:!0},currentIndex:{type:Number,default:0},forceRedBoard:{type:Number,default:null},introUrl:{type:String,default:null},alignLeft:{type:Boolean,default:!1}},emits:["goto","open-intro"],setup(e,{emit:t}){const s=e,n=t,o=vs(),a=E(()=>{const i=o.computeBoardMastery(o.getObservations(),s.lessonSubfolder,s.boardNumbers);if(s.forceRedBoard!=null){const c=i.find(u=>u.boardNumber===s.forceRedBoard);c&&(c.status="red")}return i});function r(i){const c={grey:"Not attempted",red:"Incorrect",yellow:"Corrected today",orange:"Ready to retry",green:"Correct"},u={none:"",silver:" | Silver accomplishment",gold:" | Gold accomplishment"};return`Board ${i.boardNumber}: ${c[i.status]}${u[i.achievement]}`}return(i,c)=>e.boardNumbers.length>0?(m(),v("div",{key:0,class:le(["board-mastery-strip",{"justify-start":e.alignLeft}])},[e.introUrl?(m(),v("button",{key:0,class:"intro-btn",onClick:c[0]||(c[0]=u=>n("open-intro",e.introUrl)),title:"View lesson introduction"}," Intro ")):F("",!0),(m(!0),v(Q,null,ae(a.value,(u,f)=>(m(),v("div",{key:u.boardNumber,class:le(["board-indicator",[`status-${u.status}`,{active:f===e.currentIndex},{"has-medal":u.achievement!=="none"},{"medal-gold":u.achievement==="gold"},{"medal-silver":u.achievement==="silver"}]]),onClick:d=>n("goto",f),title:r(u)},[u.achievement==="gold"?(m(),v("span",yw,"")):u.achievement==="silver"?(m(),v("span",bw,"")):F("",!0),l("span",_w,_(u.boardNumber),1)],10,gw))),128))],2)):F("",!0)}},Lu=be(ww,[["__scopeId","data-v-820a0f0c"]]),Cw={class:"accomplishments-view"},Sw={class:"view-header"},$w={key:0,class:"user-selector"},kw=["value"],xw=["value"],Aw={key:1,class:"loading-state"},Tw={key:2,class:"error-state"},Nw={key:3,class:"empty-state"},Ew={key:4,class:"view-content"},Ow={class:"controls-row"},Iw={class:"tabs"},Rw={key:0,class:"tab-content"},Pw={key:0,class:"no-data"},Dw={key:1,class:"lesson-list"},Lw={class:"lesson-header"},Bw={class:"lesson-name"},Mw={key:1,class:"tab-content"},Uw={key:0,class:"no-data"},Fw={key:1,class:"taxon-list"},jw={class:"taxon-header"},Hw={class:"taxon-category"},Ww={class:"taxon-name"},Vw={class:"taxon-counts"},Kw={class:"taxon-stat correct"},Gw={class:"taxon-stat incorrect"},zw={class:"taxon-stat total"},Jw={class:"view-actions"},Yw={key:5,class:"test-mode-banner"},qw={__name:"AccomplishmentsView",emits:["close","navigate-to-deal"],setup(e,{emit:t}){const s=t,n=gs(),o=vs(),r=new URLSearchParams(window.location.search).get("test");wt(async()=>{r==="mastery"||r==="accomplishments"?n.enableTestMode(hw()):await n.initialize()});async function i(){await n.loadAccomplishments(!0)}async function c(p){await n.selectUser(p)}function u(p,h){s("navigate-to-deal",{subfolder:p,dealNumber:h})}const f=E(()=>{const p=o.getObservations();return o.extractLessonsFromObservations(p).map(g=>{const y=o.computeBoardMastery(p,g.subfolder,g.boardNumbers),$=o.computeLessonAchievement(y);return{...g,achievement:$.achievement}}).sort((g,y)=>d(g.subfolder).localeCompare(d(y.subfolder)))});yt(f,p=>{o.fetchMissingBoardCounts(p.map(h=>h.subfolder))},{immediate:!0});function d(p){return n.formatLessonName(p)}return(p,h)=>(m(),v("div",Cw,[l("header",Sw,[h[6]||(h[6]=l("h2",null,"Accomplishments",-1)),l("button",{class:"close-btn",onClick:h[0]||(h[0]=g=>p.$emit("close"))},"")]),B(n).canViewOtherUsers.value?(m(),v("div",$w,[h[7]||(h[7]=l("label",{for:"user-select"},"Viewing:",-1)),l("select",{id:"user-select",value:B(n).selectedUserId.value,onChange:h[1]||(h[1]=g=>c(g.target.value))},[(m(!0),v(Q,null,ae(B(n).accessibleUsers.value,g=>(m(),v("option",{key:g.id,value:g.id},_(g.name)+_(g.isSelf?" (You)":""),9,xw))),128))],40,kw)])):F("",!0),B(n).loading.value?(m(),v("div",Aw,[...h[8]||(h[8]=[l("div",{class:"spinner"},null,-1),l("p",null,"Loading accomplishments...",-1)])])):B(n).error.value?(m(),v("div",Tw,[l("p",null,"Failed to load: "+_(B(n).error.value),1),l("button",{onClick:i},"Try Again")])):B(n).hasData.value?(m(),v("div",Ew,[l("div",Ow,[l("div",Iw,[l("button",{class:le(["tab-btn",{active:B(n).activeTab.value==="lessons"}]),onClick:h[3]||(h[3]=g=>B(n).activeTab.value="lessons")}," Lessons ",2),l("button",{class:le(["tab-btn",{active:B(n).activeTab.value==="taxons"}]),onClick:h[4]||(h[4]=g=>B(n).activeTab.value="taxons")}," Taxons ",2)])]),B(n).activeTab.value==="lessons"?(m(),v("div",Rw,[f.value.length===0?(m(),v("div",Pw," No lesson data available yet. ")):(m(),v("div",Dw,[(m(!0),v(Q,null,ae(f.value,g=>(m(),v("div",{key:g.subfolder,class:"lesson-row"},[l("div",Lw,[l("span",Bw,_(d(g.subfolder)),1),g.achievement!=="none"?(m(),v("span",{key:0,class:le(["achievement-badge",g.achievement])},"  "+_(g.achievement==="gold"?"Gold":"Silver"),3)):F("",!0)]),ge(Lu,{boardNumbers:g.boardNumbers,lessonSubfolder:g.subfolder,currentIndex:-1,alignLeft:!0,onGoto:y=>u(g.subfolder,g.boardNumbers[y])},null,8,["boardNumbers","lessonSubfolder","onGoto"])]))),128))]))])):F("",!0),B(n).activeTab.value==="taxons"?(m(),v("div",Mw,[B(n).filteredTaxonStats.value.length===0?(m(),v("div",Uw," No skill data available yet. ")):(m(),v("div",Fw,[(m(!0),v(Q,null,ae(B(n).filteredTaxonStats.value,g=>(m(),v("div",{key:g.skillPath,class:"taxon-card"},[l("div",jw,[l("span",Hw,_(g.categoryName),1),l("span",Ww,_(g.skillName),1)]),l("div",Vw,[l("span",Kw,_(g.correct),1),l("span",Gw,_(g.incorrect),1),l("span",zw,_(g.total)+" total",1)])]))),128))]))])):F("",!0),l("div",Jw,[l("button",{class:"secondary-btn",onClick:i}," Refresh "),l("button",{class:"primary-btn",onClick:h[5]||(h[5]=g=>p.$emit("close"))}," Done ")])])):(m(),v("div",Nw,[h[9]||(h[9]=l("h3",null,"No Practice Data Yet",-1)),h[10]||(h[10]=l("p",null,"Complete some practice deals to see your accomplishments here!",-1)),l("button",{class:"primary-btn",onClick:h[2]||(h[2]=g=>p.$emit("close"))},"Start Practicing")])),B(n).useTestData.value?(m(),v("div",Yw," Test Mode - Using Generated Data ")):F("",!0)]))}},Xw=be(qw,[["__scopeId","data-v-38e59c14"]]),Bu="bridge-classroom-anon-mode",Qw="BridgeClassroom-Anon",Ba=["Aaron","Abigail","Adam","Adrian","Aiden","Alex","Alice","Allison","Amanda","Amber","Amy","Andrea","Andrew","Angela","Anna","Anthony","Ashley","Austin","Barbara","Benjamin","Beth","Brandon","Brenda","Brian","Brittany","Bruce","Bryan","Caleb","Cameron","Carl","Carlos","Carol","Caroline","Catherine","Charles","Charlotte","Chelsea","Chris","Christina","Christine","Christopher","Cindy","Claire","Clara","Cody","Colin","Connor","Craig","Crystal","Cynthia","Dale","Daniel","Danielle","David","Dawn","Deborah","Dennis","Derek","Diana","Diane","Donald","Donna","Dorothy","Douglas","Dylan","Edward","Eileen","Eleanor","Elizabeth","Ellen","Emily","Emma","Eric","Erica","Erin","Ethan","Eugene","Eva","Evan","Evelyn","Frances","Francis","Frank","Gabriel","Gary","George","Gerald","Gloria","Grace","Gregory","Hannah","Harold","Harry","Heather","Helen","Henry","Holly","Howard","Ian","Isaac","Isabella","Jack","Jacob","James","Jamie","Jane","Janet","Jason","Jean","Jeffrey","Jennifer","Jeremy","Jerry","Jesse","Jessica","Jill","Joan","Joe","Joel","John","Jonathan","Jordan","Joseph","Joshua","Joyce","Julia","Julie","Justin","Karen","Katherine","Kathleen","Katie","Keith","Kelly","Kenneth","Kevin","Kim","Kimberly","Kyle","Larry","Laura","Lauren","Lawrence","Leah","Leonard","Leslie","Linda","Lisa","Logan","Louis","Lucas","Lucy","Luke","Madison","Margaret","Maria","Marie","Mark","Martha","Martin","Mary","Mason","Matthew","Megan","Melanie","Melissa","Michael","Michelle","Mike","Monica","Nancy","Natalie","Nathan","Nicholas","Nicole","Noah","Oliver","Olivia","Oscar","Pamela","Patricia","Patrick","Paul","Paula","Peter","Philip","Rachel","Ralph","Randy","Raymond","Rebecca","Richard","Robert","Robin","Roger","Ronald","Rose","Roy","Russell","Ruth","Ryan","Samantha","Samuel","Sandra","Sara","Sarah","Scott","Sean","Sharon","Sophia","Stephanie","Stephen","Steve","Steven","Susan","Tammy","Teresa","Terry","Thomas","Tiffany","Timothy","Todd","Tom","Tony","Tracy","Travis","Tyler","Valerie","Vanessa","Victor","Victoria","Vincent","Virginia","Walter","Wayne","Wendy","William","Zachary"],Si=["Adams","Allen","Anderson","Bailey","Baker","Barnes","Bell","Bennett","Brooks","Brown","Bryant","Butler","Campbell","Carter","Clark","Coleman","Collins","Cook","Cooper","Cox","Cruz","Davis","Diaz","Edwards","Evans","Fisher","Flores","Ford","Foster","Garcia","Gibson","Gomez","Gonzalez","Gordon","Graham","Gray","Green","Griffin","Hall","Hamilton","Harris","Harrison","Hayes","Henderson","Hernandez","Hill","Holmes","Howard","Hughes","Hunt","Jackson","James","Jenkins","Johnson","Jones","Jordan","Kelly","Kennedy","Kim","King","Lee","Lewis","Long","Lopez","Marshall","Martin","Martinez","Mason","Matthews","Miller","Mitchell","Moore","Morales","Morgan","Morris","Murphy","Murray","Nelson","Nguyen","Ortiz","Owens","Parker","Patterson","Perez","Perry","Peterson","Phillips","Powell","Price","Ramirez","Reed","Reyes","Reynolds","Richardson","Rivera","Roberts","Robinson","Rodriguez","Rogers","Ross","Russell","Sanchez","Sanders","Scott","Simmons","Smith","Stewart","Sullivan","Taylor","Thomas","Thompson","Torres","Turner","Walker","Wallace","Ward","Washington","Watson","West","White","Williams","Wilson","Wood","Wright","Young"];function Zw(e){let t=0xcbf29ce484222325n;const s=0x100000001b3n;for(let n=0;n<e.length;n++)t^=BigInt(e.charCodeAt(n)),t=t*s&0xFFFFFFFFFFFFFFFFn;return t}function eC(e,t){const s=`${Qw}:${e} ${t}`,n=Zw(s),o=Number(n%BigInt(Ba.length)),a=Number(n/BigInt(Ba.length)%BigInt(Si.length));return{firstName:Ba[o],lastName:Si[a]}}const En=R(localStorage.getItem(Bu)==="true");function tC(){function e(){En.value=!En.value,localStorage.setItem(Bu,En.value.toString())}function t(o){return En.value?eC(o.first_name,o.last_name):{firstName:o.first_name,lastName:o.last_name}}function s(o){const{firstName:a,lastName:r}=t(o);return`${a} ${r}`}function n(o){const{firstName:a,lastName:r}=t(o),i=(a==null?void 0:a.charAt(0))||"",c=(r==null?void 0:r.charAt(0))||"";return(i+c).toUpperCase()||"?"}return{isAnonymized:En,toggleAnonymize:e,displayName:t,displayFullName:s,displayInitials:n}}const sC={class:"teacher-student-list"},nC={class:"teacher-header"},oC={class:"header-actions"},aC=["value"],rC={key:0,class:"loading-state"},lC={key:1,class:"error-state"},iC={key:2,class:"empty-state"},cC={key:3,class:"empty-state"},uC={key:4,class:"student-table-wrap"},dC={class:"student-table"},fC=["onClick"],pC={class:"col-name"},mC={class:"student-name-cell"},vC={class:"avatar"},hC={class:"col-mastery"},gC={class:"mastery-pills"},yC={key:0,class:"pill pill-green"},bC={key:1,class:"pill pill-orange"},_C={key:2,class:"pill pill-yellow"},wC={key:3,class:"pill pill-red"},CC={key:4,class:"no-data-label"},SC={class:"col-active"},$C={class:"col-lessons"},kC={class:"recent-lessons"},xC={key:0,class:"no-data-label"},AC={__name:"TeacherStudentList",emits:["close","select-student"],setup(e,{emit:t}){const s=bn(),n=yo(),o=ze(),a=tC(),r=R("all"),i=R({});wt(async()=>{await s.loadAllStudentSummaries(),await c()});async function c(){const C=o.currentUser.value;if(!C)return;n.teacherClassrooms.value.length||await n.fetchTeacherClassrooms(C.id);const b={};await Promise.all(n.teacherClassrooms.value.map(async w=>{const A=await n.fetchClassroomDetail(w.id);A!=null&&A.success&&(b[w.id]=new Set(A.classroom.members.map(L=>L.student_id)))})),i.value=b}async function u(){s.studentObservations.value={},await s.loadAllStudentSummaries(),await c()}const f=E(()=>{const C=new Set;for(const b of Object.values(i.value))for(const w of b)C.add(w);return C}),d=E(()=>{const C=s.students.value;if(r.value==="all")return C;if(r.value==="none")return C.filter(w=>!f.value.has(w.id));const b=i.value[r.value];return b?C.filter(w=>b.has(w.id)):C}),p=E(()=>[...d.value].sort((C,b)=>{var L,V;const w=((L=h.value[C.id])==null?void 0:L.lastObservationTime)||"",A=((V=h.value[b.id])==null?void 0:V.lastObservationTime)||"";return A!==w?A.localeCompare(w):y(C).localeCompare(y(b))})),h=E(()=>{const C={};for(const b of s.students.value)C[b.id]=s.getStudentMasterySummary(b.id);return C}),g=E(()=>{const C={};for(const b of s.students.value)C[b.id]=s.getStudentRecentLessons(b.id);return C});function y(C){return a.displayFullName(C)}function $(C){return a.displayInitials(C)}return(C,b)=>(m(),v("div",sC,[l("header",nC,[b[5]||(b[5]=l("h2",null,"My Students",-1)),l("div",oC,[B(n).teacherClassrooms.value.length?Be((m(),v("select",{key:0,"onUpdate:modelValue":b[0]||(b[0]=w=>r.value=w),class:"filter-select"},[b[3]||(b[3]=l("option",{value:"all"},"All Students",-1)),(m(!0),v(Q,null,ae(B(n).teacherClassrooms.value,w=>(m(),v("option",{key:w.id,value:w.id},_(w.name),9,aC))),128)),b[4]||(b[4]=l("option",{value:"none"},"No Classroom",-1))],512)),[[Hn,r.value]]):F("",!0),l("button",{class:le(["anon-btn",{active:B(a).isAnonymized.value}]),onClick:b[1]||(b[1]=w=>B(a).toggleAnonymize())},_(B(a).isAnonymized.value?"Clear":"Anon"),3),l("button",{class:"secondary-btn",onClick:u},"Refresh"),l("button",{class:"secondary-btn",onClick:b[2]||(b[2]=w=>C.$emit("close"))},"Back")])]),B(s).loading.value?(m(),v("div",rC,[...b[6]||(b[6]=[l("div",{class:"spinner"},null,-1),l("p",null,"Loading student data...",-1)])])):B(s).error.value?(m(),v("div",lC,[l("p",null,"Failed to load: "+_(B(s).error.value),1),l("button",{onClick:u},"Try Again")])):B(s).students.value.length===0?(m(),v("div",iC,[...b[7]||(b[7]=[l("h3",null,"No Students Yet",-1),l("p",null,"Students will appear here once they register and grant you access.",-1)])])):p.value.length===0?(m(),v("div",cC,[...b[8]||(b[8]=[l("h3",null,"No Matching Students",-1),l("p",null,"No students match the selected filter.",-1)])])):(m(),v("div",uC,[l("table",dC,[b[9]||(b[9]=l("thead",null,[l("tr",null,[l("th",{class:"col-name"},"Student"),l("th",{class:"col-mastery"},"Mastery"),l("th",{class:"col-active"},"Last Active"),l("th",{class:"col-lessons"},"Recent Lessons")])],-1)),l("tbody",null,[(m(!0),v(Q,null,ae(p.value,w=>{var A,L,V,U,X,q,ue;return m(),v("tr",{key:w.id,class:"student-row",onClick:ve=>C.$emit("select-student",w.id,y(w))},[l("td",pC,[l("div",mC,[l("div",vC,_($(w)),1),l("span",null,_(y(w)),1)])]),l("td",hC,[l("div",gC,[(A=h.value[w.id])!=null&&A.green?(m(),v("span",yC,_(h.value[w.id].green),1)):F("",!0),(L=h.value[w.id])!=null&&L.orange?(m(),v("span",bC,_(h.value[w.id].orange),1)):F("",!0),(V=h.value[w.id])!=null&&V.yellow?(m(),v("span",_C,_(h.value[w.id].yellow),1)):F("",!0),(U=h.value[w.id])!=null&&U.red?(m(),v("span",wC,_(h.value[w.id].red),1)):F("",!0),(X=h.value[w.id])!=null&&X.total?F("",!0):(m(),v("span",CC,"No data"))])]),l("td",SC,_(B(s).formatTimeSince((q=h.value[w.id])==null?void 0:q.lastObservationTime)),1),l("td",$C,[l("div",kC,[(m(!0),v(Q,null,ae(g.value[w.id],(ve,de)=>(m(),v("span",{key:de,class:"lesson-tag"},_(ve),1))),128)),(ue=g.value[w.id])!=null&&ue.length?F("",!0):(m(),v("span",xC,"-"))])])],8,fC)}),128))])])]))]))}},TC=be(AC,[["__scopeId","data-v-dd6d8e66"]]),NC={class:"teacher-student-detail"},EC={class:"detail-header"},OC={class:"student-info"},IC={class:"avatar"},RC={class:"last-active"},PC={key:0,class:"loading-state"},DC={key:1,class:"detail-content"},LC={class:"tab-bar"},BC=["onClick"],MC={key:0,class:"tab-content"},UC={key:1,class:"tab-content"},FC={key:0,class:"stats-row"},jC={class:"stat stat-green"},HC={key:0,class:"stat stat-orange"},WC={key:1,class:"stat stat-yellow"},VC={key:2,class:"stat stat-red"},KC={key:3,class:"stat stat-grey"},GC={key:1,class:"no-data"},zC={key:2,class:"lesson-list"},JC={class:"lesson-header"},YC=["onClick"],qC={class:"mastery-strip"},XC=["title","onClick"],QC={key:0,class:"medal gold-medal"},ZC={key:1,class:"medal silver-medal"},eS={class:"board-num"},tS={class:"observation-total"},sS={__name:"TeacherStudentDetail",props:{studentId:{type:String,required:!0},studentName:{type:String,required:!0}},emits:["back","navigate-to-lesson"],setup(e,{emit:t}){const s=e,n=t,o=bn(),a=vs(),r=gs(),i=R(!1),c=R("progress"),u=[{id:"progress",label:"Progress"},{id:"mastery",label:"Lesson Mastery"}],f=E(()=>s.studentName.split(" ").map(b=>b[0]||"").join("").toUpperCase());wt(async()=>{o.studentObservations.value[s.studentId]||(i.value=!0,await o.fetchStudentObservations(s.studentId),i.value=!1)});const d=E(()=>o.studentObservations.value[s.studentId]||[]),p=E(()=>o.getStudentMasterySummary(s.studentId)),h=E(()=>o.formatTimeSince(p.value.lastObservationTime)),g=E(()=>{const C=d.value;return C.length===0?[]:a.extractLessonsFromObservations(C).map(w=>{const A=a.computeBoardMastery(C,w.subfolder,w.boardNumbers),L=a.computeLessonAchievement(A);return{...w,boardMastery:A,achievement:L.achievement}}).sort((w,A)=>y(w.subfolder).localeCompare(y(A.subfolder)))});yt(g,C=>{a.fetchMissingBoardCounts(C.map(b=>b.subfolder))},{immediate:!0});function y(C){return r.formatLessonName(C)}function $(C){const b={grey:"Not attempted",red:"Incorrect",yellow:"Corrected today",orange:"Ready to retry",green:"Correct"};return`Board ${C.boardNumber}: ${b[C.status]}`}return(C,b)=>(m(),v("div",NC,[l("header",EC,[l("button",{class:"back-btn",onClick:b[0]||(b[0]=w=>C.$emit("back"))}," Students"),l("div",OC,[l("div",IC,_(f.value),1),l("div",null,[l("h2",null,_(e.studentName),1),l("span",RC,"Last active: "+_(h.value),1)])])]),i.value?(m(),v("div",PC,[...b[1]||(b[1]=[l("div",{class:"spinner"},null,-1),l("p",null,"Loading student data...",-1)])])):(m(),v("div",DC,[l("div",LC,[(m(),v(Q,null,ae(u,w=>l("button",{key:w.id,class:le(["tab-btn",{active:c.value===w.id}]),onClick:A=>c.value=w.id},_(w.label),11,BC)),64))]),c.value==="progress"?(m(),v("div",MC,[ge(Du,{observations:d.value,studentName:s.studentName,studentId:s.studentId},null,8,["observations","studentName","studentId"])])):c.value==="mastery"?(m(),v("div",UC,[p.value.total>0?(m(),v("div",FC,[l("div",jC,_(p.value.green)+" Green",1),p.value.orange?(m(),v("div",HC,_(p.value.orange)+" Orange",1)):F("",!0),p.value.yellow?(m(),v("div",WC,_(p.value.yellow)+" Yellow",1)):F("",!0),p.value.red?(m(),v("div",VC,_(p.value.red)+" Red",1)):F("",!0),p.value.grey?(m(),v("div",KC,_(p.value.grey)+" Grey",1)):F("",!0)])):F("",!0),g.value.length===0?(m(),v("div",GC," No lesson data available yet. ")):(m(),v("div",zC,[(m(!0),v(Q,null,ae(g.value,w=>(m(),v("div",{key:w.subfolder,class:"lesson-row"},[l("div",JC,[l("button",{class:"lesson-name lesson-link",onClick:A=>n("navigate-to-lesson",w.subfolder)},_(y(w.subfolder)),9,YC),w.achievement!=="none"?(m(),v("span",{key:0,class:le(["achievement-badge",w.achievement])},"  "+_(w.achievement==="gold"?"Gold":"Silver"),3)):F("",!0)]),l("div",qC,[(m(!0),v(Q,null,ae(w.boardMastery,A=>(m(),v("div",{key:A.boardNumber,class:le(["board-circle board-clickable","status-"+A.status]),title:$(A),onClick:L=>n("navigate-to-lesson",w.subfolder,A.boardNumber)},[A.achievement==="gold"?(m(),v("span",QC,"")):A.achievement==="silver"?(m(),v("span",ZC,"")):F("",!0),l("span",eS,_(A.boardNumber),1)],10,XC))),128))])]))),128))]))])):F("",!0),l("div",tS,_(d.value.length)+" observations",1)]))]))}},nS=be(sS,[["__scopeId","data-v-93b93ebc"]]),oS={key:0,class:"lesson-browser-loading"},aS={key:1,class:"lesson-browser-error"},rS={class:"lesson-browser"},lS={class:"browser-header"},iS={class:"browser-content"},cS=["onClick"],uS={class:"expand-icon"},dS={class:"category-name"},fS={class:"category-count"},pS={key:0,class:"lesson-list"},mS=["onClick"],vS={class:"lesson-name"},hS={class:"lesson-description"},gS={key:0,class:"error-message"},yS={key:3,class:"lesson-browser-inline"},bS={class:"browser-content-inline"},_S=["onClick"],wS={class:"expand-icon"},CS={class:"category-name"},SS={class:"category-count"},$S={key:0,class:"lesson-list"},kS=["onClick"],xS={class:"lesson-name"},AS={class:"lesson-description"},TS={key:0,class:"error-message-inline"},NS={__name:"LessonBrowser",props:{visible:{type:Boolean,default:!1},inline:{type:Boolean,default:!1},collection:{type:Object,default:null}},emits:["close","load"],setup(e,{emit:t}){const s=e,n=t,o=R(null),a=R(null),r=R(!1),i=R([]),c=R(null),u=R(null);yt(()=>[s.visible,s.collection],([g,y])=>{g&&y&&!o.value&&f()},{immediate:!0});async function f(){var g;if(!((g=s.collection)!=null&&g.tocUrl)){a.value="No collection specified";return}r.value=!0,a.value=null;try{const y=await fetch(s.collection.tocUrl);if(!y.ok)throw new Error(`Failed to load: ${y.statusText}`);o.value=await y.json()}catch(y){console.error("Error fetching TOC:",y),a.value=`Could not load lesson catalog. ${y.message}`}finally{r.value=!1}}function d(g){const y=i.value.indexOf(g);y>=0?i.value.splice(y,1):i.value.push(g)}function p(g){return g.includes("/")?g.split("/").pop():g}async function h(g,y){var $;u.value=null,c.value=g.id;try{const C=(($=s.collection)==null?void 0:$.baseUrl)||"",b=p(g.id),w=`${C}/${b}.pbn`,A=await fetch(w);if(!A.ok)throw new Error(`Failed to load lesson: ${A.statusText}`);const L=await A.text();n("load",{subfolder:g.id,name:g.name,category:y.name,content:L}),s.inline||n("close")}catch(C){console.error("Error loading lesson:",C),u.value=`Could not load "${g.name}". The lesson may not be available yet.`}finally{c.value=null}}return(g,y)=>e.visible&&r.value?(m(),v("div",oS,[...y[2]||(y[2]=[l("div",{class:"loading-spinner"},null,-1),l("p",null,"Loading lessons...",-1)])])):e.visible&&a.value?(m(),v("div",aS,[l("p",null,_(a.value),1),l("button",{onClick:f,class:"retry-btn"},"Retry")])):e.visible&&!e.inline&&o.value?(m(),v("div",{key:2,class:"modal-overlay",onClick:y[1]||(y[1]=_t($=>g.$emit("close"),["self"]))},[l("div",rS,[l("div",lS,[l("h2",null,_(o.value.name),1),l("button",{class:"close-btn",onClick:y[0]||(y[0]=$=>g.$emit("close"))},"")]),l("div",iS,[(m(!0),v(Q,null,ae(o.value.categories,$=>(m(),v("div",{key:$.id,class:"category-section"},[l("button",{class:le(["category-header",{expanded:i.value.includes($.id)}]),onClick:C=>d($.id)},[l("span",uS,_(i.value.includes($.id)?"":""),1),l("span",dS,_($.name),1),l("span",fS,_($.lessons.length)+" lessons",1)],10,cS),i.value.includes($.id)?(m(),v("div",pS,[(m(!0),v(Q,null,ae($.lessons,C=>(m(),v("button",{key:C.id,class:le(["lesson-item",{loading:c.value===C.id}]),onClick:b=>h(C,$)},[l("span",vS,_(C.name),1),l("span",hS,_(C.description),1)],10,mS))),128))])):F("",!0)]))),128))]),u.value?(m(),v("div",gS,_(u.value),1)):F("",!0)])])):e.visible&&e.inline&&o.value?(m(),v("div",yS,[l("div",bS,[(m(!0),v(Q,null,ae(o.value.categories,$=>(m(),v("div",{key:$.id,class:"category-section"},[l("button",{class:le(["category-header",{expanded:i.value.includes($.id)}]),onClick:C=>d($.id)},[l("span",wS,_(i.value.includes($.id)?"":""),1),l("span",CS,_($.name),1),l("span",SS,_($.lessons.length)+" lessons",1)],10,_S),i.value.includes($.id)?(m(),v("div",$S,[(m(!0),v(Q,null,ae($.lessons,C=>(m(),v("button",{key:C.id,class:le(["lesson-item",{loading:c.value===C.id}]),onClick:b=>h(C,$)},[l("span",xS,_(C.name),1),l("span",AS,_(C.description),1)],10,kS))),128))])):F("",!0)]))),128))]),u.value?(m(),v("div",TS,_(u.value),1)):F("",!0)])):F("",!0)}},ES=be(NS,[["__scopeId","data-v-384a9c63"]]),OS={class:"viewer-controls"},IS={class:"viewer-body"},RS={key:0,class:"interaction-overlay"},PS={key:1,class:"viewer-loading"},DS={key:2,class:"viewer-error"},LS=["src"],BS={__name:"IntroPdfViewer",props:{url:{type:String,required:!0},visible:{type:Boolean,default:!1}},emits:["close"],setup(e){const t=e,s=Vt({x:80,y:80}),n=Vt({w:550,h:700}),o=R(!1),a=Vt({x:0,y:0}),r=R(null),i=R(!1),c=R(null),u=E(()=>r.value?r.value+"#navpanes=0&toolbar=0":null);async function f(b){if(d(),!!b){i.value=!0,c.value=null;try{const w=await fetch(b);if(!w.ok)throw new Error("Failed to load PDF");const A=await w.blob(),L=new Blob([A],{type:"application/pdf"});r.value=URL.createObjectURL(L)}catch(w){c.value="Could not load PDF",console.error("Failed to fetch intro PDF:",w)}finally{i.value=!1}}}function d(){r.value&&(URL.revokeObjectURL(r.value),r.value=null)}function p(){r.value&&window.open(r.value,"_blank")}yt(()=>[t.visible,t.url],([b,w])=>{b&&w?f(w):b||d()},{immediate:!0}),Rr(d);function h(b){b.target.closest("button")||(o.value=!0,a.x=b.clientX-s.x,a.y=b.clientY-s.y,document.addEventListener("pointermove",g),document.addEventListener("pointerup",C))}function g(b){s.x=Math.max(0,b.clientX-a.x),s.y=Math.max(0,b.clientY-a.y)}function y(b){o.value=!0,a.x=b.clientX,a.y=b.clientY,a.startW=n.w,a.startH=n.h,document.addEventListener("pointermove",$),document.addEventListener("pointerup",C)}function $(b){n.w=Math.max(320,a.startW+(b.clientX-a.x)),n.h=Math.max(300,a.startH+(b.clientY-a.y))}function C(){o.value=!1,document.removeEventListener("pointermove",g),document.removeEventListener("pointermove",$),document.removeEventListener("pointerup",C)}return(b,w)=>e.visible?(m(),v("div",{key:0,class:"intro-pdf-viewer",style:st({left:s.x+"px",top:s.y+"px",width:n.w+"px",height:n.h+"px"})},[l("div",{class:"viewer-titlebar",onPointerdown:h},[w[1]||(w[1]=l("span",{class:"viewer-title"},"Lesson Introduction",-1)),l("div",OS,[l("button",{class:"viewer-btn",onClick:p,title:"Open in new tab"},""),l("button",{class:"viewer-btn close",onClick:w[0]||(w[0]=A=>b.$emit("close")),title:"Close"},"")])],32),l("div",IS,[o.value?(m(),v("div",RS)):F("",!0),i.value?(m(),v("div",PS,"Loading PDF...")):c.value?(m(),v("div",DS,_(c.value),1)):u.value?(m(),v("iframe",{key:3,src:u.value,class:"viewer-iframe"},null,8,LS)):F("",!0)]),l("div",{class:"resize-handle",onPointerdown:y},"",32)],4)):F("",!0)}},MS=be(BS,[["__scopeId","data-v-a97df645"]]),US={class:"collection-icon"},FS={class:"collection-name"},jS={class:"collection-desc"},HS={__name:"CollectionCard",props:{collection:{type:Object,required:!0}},emits:["click"],setup(e){return(t,s)=>(m(),v("button",{class:"collection-card",onClick:s[0]||(s[0]=n=>t.$emit("click"))},[l("span",US,_(e.collection.icon),1),l("span",FS,_(e.collection.name),1),l("span",jS,_(e.collection.description),1)]))}},WS=be(HS,[["__scopeId","data-v-747be5b1"]]),VS={class:"collection-grid"},KS={class:"collection-cards"},GS={key:0,class:"load-file-section"},zS={__name:"CollectionGrid",emits:["select-collection","load-file"],setup(e){const t=po(),s=t.COLLECTIONS;return(n,o)=>(m(),v("div",VS,[o[2]||(o[2]=l("h2",{class:"grid-title"},"Lesson Collections",-1)),o[3]||(o[3]=l("p",{class:"grid-subtitle"},"Select a collection to browse lessons:",-1)),l("div",KS,[(m(!0),v(Q,null,ae(B(s),a=>(m(),Le(WS,{key:a.id,collection:a,onClick:r=>n.$emit("select-collection",a.id)},null,8,["collection","onClick"]))),128))]),B(t).showLoadPbnOption.value?(m(),v("div",GS,[o[1]||(o[1]=l("p",null,"Or load your own PBN file:",-1)),l("input",{type:"file",accept:".pbn",onChange:o[0]||(o[0]=a=>n.$emit("load-file",a))},null,32)])):F("",!0)]))}},nl=be(zS,[["__scopeId","data-v-35b62d22"]]),JS={class:"casual-lobby"},YS={__name:"CasualLobby",emits:["select-collection","show-become-teacher","load-file"],setup(e){return(t,s)=>(m(),v("div",JS,[ge(nl,{onSelectCollection:s[0]||(s[0]=n=>t.$emit("select-collection",n)),onLoadFile:s[1]||(s[1]=n=>t.$emit("load-file",n))})]))}},qS=be(YS,[["__scopeId","data-v-1ce1f7d7"]]),XS={class:"assignment-panel"},QS={key:0,class:"loading-state"},ZS={key:1,class:"empty-state"},e$={key:2,class:"assignment-cards"},t$=["onClick"],s$={class:"card-header"},n$={class:"exercise-name"},o$={class:"card-meta"},a$={key:0,class:"meta-item"},r$={class:"progress-section"},l$={class:"progress-bar"},i$={class:"progress-label"},c$={__name:"AssignmentPanel",props:{assignments:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["select-assignment"],setup(e){function t(r){return r.total_boards?Math.round(r.attempted_boards/r.total_boards*100):0}function s(r){return r.attempted_boards>=r.total_boards&&r.total_boards>0?"complete":r.due_at&&new Date(r.due_at)<new Date&&r.attempted_boards<r.total_boards?"overdue":r.attempted_boards>0?"in-progress":"new"}function n(r){const i=s(r);return i==="complete"?"Complete":i==="overdue"?"Overdue":i==="in-progress"?"In Progress":"New"}function o(r){if(!r.due_at)return null;const i=new Date(r.due_at),u=Math.ceil((i-new Date)/(1e3*60*60*24));return u<0?"Overdue":u===0?"Due today":u===1?"Due tomorrow":`Due in ${u} days`}function a(r){if(!r.due_at)return"";const i=new Date(r.due_at),u=Math.ceil((i-new Date)/(1e3*60*60*24));return u<0?"overdue":u<=1?"urgent":u<=3?"soon":""}return(r,i)=>(m(),v("div",XS,[i[2]||(i[2]=l("h3",{class:"section-title"},"My Assignments",-1)),e.loading?(m(),v("div",QS,[...i[0]||(i[0]=[l("div",{class:"spinner"},null,-1),l("p",null,"Loading assignments...",-1)])])):e.assignments.length===0?(m(),v("div",ZS,[...i[1]||(i[1]=[l("p",{class:"empty-title"},"No assignments yet",-1),l("p",{class:"empty-desc"},"Your teacher will assign exercises here.",-1)])])):(m(),v("div",e$,[(m(!0),v(Q,null,ae(e.assignments,c=>(m(),v("div",{key:c.id,class:le(["assignment-card",s(c)]),onClick:u=>r.$emit("select-assignment",c)},[l("div",s$,[l("span",n$,_(c.exercise_name),1),l("span",{class:le(["status-badge",s(c)])},_(n(c)),3)]),l("div",o$,[c.classroom_name?(m(),v("span",a$,_(c.classroom_name),1)):F("",!0),c.due_at?(m(),v("span",{key:1,class:le(["meta-item",a(c)])},_(o(c)),3)):F("",!0)]),l("div",r$,[l("div",l$,[l("div",{class:le(["progress-fill",s(c)]),style:st({width:t(c)+"%"})},null,6)]),l("span",i$,_(c.attempted_boards)+" / "+_(c.total_boards)+" boards ",1)])],10,t$))),128))]))]))}},u$=be(c$,[["__scopeId","data-v-dc0b8e86"]]),d$={class:"student-lobby"},f$={__name:"StudentLobby",emits:["select-collection","select-assignment","load-file"],setup(e,{emit:t}){const s=t,n=ze(),o=wn(),a=E(()=>o.studentAssignments.value.length>0),r=E(()=>o.loading.value);function i(c){s("select-assignment",c)}return wt(()=>{const c=n.currentUser.value;c&&o.fetchStudentAssignments(c.id)}),(c,u)=>(m(),v("div",d$,[a.value||r.value?(m(),Le(u$,{key:0,assignments:B(o).studentAssignments.value,loading:r.value,onSelectAssignment:i},null,8,["assignments","loading"])):F("",!0),ge(nl,{onSelectCollection:u[0]||(u[0]=f=>c.$emit("select-collection",f)),onLoadFile:u[1]||(u[1]=f=>c.$emit("load-file",f))})]))}},p$=be(f$,[["__scopeId","data-v-3310fc38"]]),Mu="https://api.bridge-classroom.com/api",Uu="8a3ccc23767bdcbe6bb1709dfe3f20194dc0b8b4874939244e802dc71a21a568",Do=R([]),ol=R([]),al=R([]),hr=R(!1),Ma=R(null),m$=2*60*1e3;async function v$(e,t=!1){if(!t&&Ma.value&&Date.now()-new Date(Ma.value).getTime()<m$)return{success:!0,cached:!0};hr.value=!0;try{const s=await fetch(`${Mu}/teacher/dashboard?teacher_id=${encodeURIComponent(e)}`,{headers:{"x-api-key":Uu}});if(!s.ok)throw new Error(`Failed to fetch teacher dashboard: ${s.status}`);const n=await s.json();return Do.value=n.classrooms||[],ol.value=n.needs_attention||[],al.value=n.recent_activity||[],Ma.value=new Date().toISOString(),{success:!0}}catch(s){return console.error("Failed to load teacher lobby data:",s),{success:!1,error:s.message}}finally{hr.value=!1}}async function h$(e,t){try{const s=await fetch(`${Mu}/teacher/dashboard/clear`,{method:"POST",headers:{"Content-Type":"application/json","x-api-key":Uu},body:JSON.stringify({teacher_id:e,panel:t})});if(!s.ok)throw new Error(`Failed to clear: ${s.status}`);return t==="attention"?ol.value=[]:t==="activity"&&(al.value=[]),{success:!0}}catch(s){return console.error("Failed to clear panel:",s),{success:!1,error:s.message}}}function g$(){const e=E(()=>({classroomCount:Do.value.length,openAssignmentCount:Do.value.reduce((t,s)=>t+(s.open_assignment_count||0),0)}));return{lobbyClassrooms:Do,needsAttention:ol,recentActivity:al,lobbyLoading:hr,summaryStats:e,loadTeacherLobbyData:v$,clearPanel:h$}}const y$={class:"roster"},b$={class:"roster-header"},_$={class:"member-count"},w$={key:0,class:"roster-empty"},C$={key:1,class:"roster-table"},S$={class:"member-name"},$$={class:"member-email"},k$={class:"member-date"},x$={class:"member-action"},A$=["onClick","disabled"],T$={__name:"ClassroomRoster",props:{members:{type:Array,required:!0}},emits:["remove-member"],setup(e,{emit:t}){const s=t,n=R(null);function o(r){try{return new Date(r).toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch{return r}}function a(r){const i=`${r.first_name} ${r.last_name}`;confirm(`Remove ${i} from this classroom?`)&&(n.value=r.student_id,s("remove-member",r.student_id),setTimeout(()=>{n.value=null},2e3))}return(r,i)=>(m(),v("div",y$,[l("div",b$,[i[0]||(i[0]=l("h4",null,"Class Roster",-1)),l("span",_$,_(e.members.length)+" "+_(e.members.length===1?"student":"students"),1)]),e.members.length===0?(m(),v("div",w$,[...i[1]||(i[1]=[l("p",null,"No students have joined yet. Share the invite link above.",-1)])])):(m(),v("table",C$,[i[2]||(i[2]=l("thead",null,[l("tr",null,[l("th",null,"Name"),l("th",null,"Email"),l("th",null,"Joined"),l("th")])],-1)),l("tbody",null,[(m(!0),v(Q,null,ae(e.members,c=>(m(),v("tr",{key:c.student_id},[l("td",S$,_(c.first_name)+" "+_(c.last_name),1),l("td",$$,_(c.email),1),l("td",k$,_(o(c.joined_at)),1),l("td",x$,[l("button",{class:"remove-btn",onClick:u=>a(c),disabled:n.value===c.student_id},_(n.value===c.student_id?"Removing...":"Remove"),9,A$)])]))),128))])]))]))}},N$=be(T$,[["__scopeId","data-v-ee901be3"]]),E$={class:"header-left"},O$={class:"classroom-name"},I$={class:"header-meta"},R$={class:"join-badge"},P$={class:"member-count"},D$={key:0,class:"stat-badge"},L$={key:1,class:"stat-badge completion"},B$={key:0,class:"mini-bars"},M$={class:"bar-label"},U$={class:"bar-track"},F$={class:"bar-count"},j$=["aria-label"],H$={key:0,class:"card-body"},W$={key:0,class:"classroom-desc"},V$={class:"invite-section"},K$={class:"invite-field"},G$=["value"],z$={class:"email-section"},J$={class:"email-header"},Y$={class:"email-template"},q$={class:"email-body"},X$={key:1,class:"assignments-section"},Q$={class:"assignment-list"},Z$=["onClick"],ek={class:"assignment-name"},tk={key:0,class:"assignment-due"},sk={class:"assignment-boards"},nk={key:3,class:"loading-roster"},ok={__name:"ClassroomCard",props:{classroom:{type:Object,required:!0},expanded:{type:Boolean,default:!1}},emits:["toggle","member-removed","view-assignment"],setup(e,{emit:t}){const s=e,n=t,o=yo(),a=wn(),r=R(null),i=R(!1),c=R(!1),u=R(!1),f=R([]),d=E(()=>`https://bridge-classroom.com/#/join/${s.classroom.join_code}`);yt(()=>s.expanded,async C=>{if(C&&!r.value){i.value=!0;const[b,w]=await Promise.all([o.fetchClassroomDetail(s.classroom.id),a.fetchClassroomAssignments(s.classroom.id)]);b!=null&&b.success&&(r.value=b.classroom),f.value=w||[],i.value=!1}});function p(C){return C?new Date(C).toLocaleDateString(void 0,{month:"short",day:"numeric"}):""}function h(C){return C.students_total?Math.round(C.students_completed/C.students_total*100)+"%":"0%"}async function g(){try{await navigator.clipboard.writeText(d.value),c.value=!0,setTimeout(()=>{c.value=!1},2e3)}catch{}}async function y(){const C=`Subject: Join our Bridge Classroom for practice exercises

Hi everyone,

I've set up an online practice tool for our bridge class. You can work through bidding exercises at your own pace, and I'll be able to see your progress to help guide our lessons.

To join, click this link:
${d.value}

You'll need to create a free account (just your name and email). Once you've joined, you'll see any exercises I assign in your lobby.

The tool works on any device  computer, tablet, or phone  and you can practice offline too.

See you in class!`;try{await navigator.clipboard.writeText(C),u.value=!0,setTimeout(()=>{u.value=!1},2e3)}catch{}}async function $(C){const b=await o.removeMember(s.classroom.id,C);b!=null&&b.success&&(r.value&&(r.value.members=r.value.members.filter(w=>w.student_id!==C)),n("member-removed"))}return(C,b)=>(m(),v("div",{class:le(["classroom-card",{expanded:e.expanded}])},[l("div",{class:"card-header",onClick:b[0]||(b[0]=w=>C.$emit("toggle"))},[l("div",E$,[l("h3",O$,_(e.classroom.name),1),l("div",I$,[l("span",R$,"JOIN: "+_(e.classroom.join_code),1),l("span",P$,_(e.classroom.member_count)+" "+_(e.classroom.member_count===1?"student":"students"),1),e.classroom.open_assignment_count?(m(),v("span",D$,_(e.classroom.open_assignment_count)+" "+_(e.classroom.open_assignment_count===1?"assignment":"assignments"),1)):F("",!0),e.classroom.avg_completion_pct>0?(m(),v("span",L$,_(e.classroom.avg_completion_pct)+"% avg",1)):F("",!0)]),e.classroom.assignments&&e.classroom.assignments.length?(m(),v("div",B$,[(m(!0),v(Q,null,ae(e.classroom.assignments,w=>(m(),v("div",{key:w.id,class:"mini-bar"},[l("span",M$,_(w.exercise_name),1),l("div",U$,[l("div",{class:"bar-fill",style:st({width:h(w)})},null,4)]),l("span",F$,_(w.students_completed)+"/"+_(w.students_total),1)]))),128))])):F("",!0)]),l("button",{class:"expand-btn","aria-label":e.expanded?"Collapse":"Expand"},[l("span",{class:le(["chevron",{rotated:e.expanded}])},"",2)],8,j$)]),e.expanded?(m(),v("div",H$,[e.classroom.description?(m(),v("p",W$,_(e.classroom.description),1)):F("",!0),l("div",V$,[b[2]||(b[2]=l("h4",null,"Invite Link",-1)),b[3]||(b[3]=l("p",{class:"invite-desc"},"Share this link with your students to let them join.",-1)),l("div",K$,[l("input",{type:"text",value:d.value,readonly:"",class:"invite-input",onClick:b[1]||(b[1]=w=>w.target.select())},null,8,G$),l("button",{class:"copy-btn",onClick:g},_(c.value?"Copied!":"Copy"),1)])]),l("div",z$,[l("div",J$,[b[4]||(b[4]=l("h4",null,"Email Template",-1)),l("button",{class:"copy-btn copy-btn-small",onClick:y},_(u.value?"Copied!":"Copy"),1)]),l("div",Y$,[b[5]||(b[5]=l("p",null,[l("strong",null,"Subject:"),Ne(" Join our Bridge Classroom for practice exercises")],-1)),l("div",q$," Hi everyone, I've set up an online practice tool for our bridge class. You can work through bidding exercises at your own pace, and I'll be able to see your progress to help guide our lessons. To join, click this link: "+_(d.value)+" You'll need to create a free account (just your name and email). Once you've joined, you'll see any exercises I assign in your lobby. The tool works on any device  computer, tablet, or phone  and you can practice offline too. See you in class!",1)])]),f.value.length?(m(),v("div",X$,[b[7]||(b[7]=l("h4",null,"Assignments",-1)),l("div",Q$,[(m(!0),v(Q,null,ae(f.value,w=>(m(),v("div",{key:w.id,class:"assignment-row clickable",onClick:A=>n("view-assignment",w.id)},[l("span",ek,_(w.exercise_name),1),w.due_at?(m(),v("span",tk,"Due "+_(p(w.due_at)),1)):F("",!0),l("span",sk,_(w.total_boards)+" boards",1),b[6]||(b[6]=l("span",{class:"view-arrow"},"",-1))],8,Z$))),128))])])):F("",!0),r.value?(m(),Le(N$,{key:2,members:r.value.members,onRemoveMember:$},null,8,["members"])):i.value?(m(),v("div",nk," Loading roster... ")):F("",!0)])):F("",!0)],2))}},ak=be(ok,[["__scopeId","data-v-3dc8e5a5"]]),rk={class:"modal-content"},lk={class:"step"},ik={class:"form-group"},ck={class:"form-group"},uk={class:"step-actions"},dk=["disabled"],fk={key:0,class:"error-text"},pk={__name:"ClassroomCreateModal",emits:["close","classroom-created"],setup(e,{emit:t}){const s=t,n=ze(),o=yo(),a=R(""),r=R(""),i=R(!1),c=R(null);async function u(){if(!a.value.trim()||i.value)return;const f=n.currentUser.value;if(!f)return;i.value=!0,c.value=null;const d=await o.createClassroom(f.id,a.value.trim(),r.value.trim()||null);d.success?s("classroom-created",d.classroom):c.value=d.error||"Failed to create classroom",i.value=!1}return(f,d)=>(m(),v("div",{class:"modal-overlay",onClick:d[3]||(d[3]=_t(p=>f.$emit("close"),["self"]))},[l("div",rk,[l("div",lk,[d[7]||(d[7]=l("h2",null,"Create a Classroom",-1)),d[8]||(d[8]=l("p",{class:"step-desc"},"Set up a new classroom for your students.",-1)),l("div",ik,[d[4]||(d[4]=l("label",{for:"classroom-name"},"Classroom Name",-1)),Be(l("input",{id:"classroom-name","onUpdate:modelValue":d[0]||(d[0]=p=>a.value=p),type:"text",placeholder:"e.g. Beginning Bridge  Spring 2026",class:"form-input",onKeyup:Vo(u,["enter"])},null,544),[[bt,a.value]]),d[5]||(d[5]=l("p",{class:"form-hint"},"Choose a name your students will recognize.",-1))]),l("div",ck,[d[6]||(d[6]=l("label",{for:"classroom-desc"},[Ne("Description "),l("span",{class:"optional"},"(optional)")],-1)),Be(l("textarea",{id:"classroom-desc","onUpdate:modelValue":d[1]||(d[1]=p=>r.value=p),placeholder:"e.g. Tuesdays 10am  Focus on NT openings and responses",class:"form-textarea",rows:"3"},null,512),[[bt,r.value]])]),l("div",uk,[l("button",{class:"btn btn-secondary",onClick:d[2]||(d[2]=p=>f.$emit("close"))},"Cancel"),l("button",{class:"btn btn-primary",disabled:!a.value.trim()||i.value,onClick:u},_(i.value?"Creating...":"Create Classroom"),9,dk)]),c.value?(m(),v("p",fk,_(c.value),1)):F("",!0)])])]))}},mk=be(pk,[["__scopeId","data-v-c26a1ae6"]]),On="https://api.bridge-classroom.com/api",In="8a3ccc23767bdcbe6bb1709dfe3f20194dc0b8b4874939244e802dc71a21a568",Es=R([]),Ua=R(null),Ut=R(!1),je=R(null);function vk(){async function e(r={}){Ut.value=!0,je.value=null;try{const i=new URLSearchParams;r.created_by&&i.set("created_by",r.created_by),r.curriculum_path&&i.set("curriculum_path",r.curriculum_path),r.visibility&&i.set("visibility",r.visibility);const c=i.toString(),u=`${On}/exercises${c?"?"+c:""}`,f=await fetch(u,{headers:{"x-api-key":In}});if(!f.ok){const p=await f.text();return je.value=p||`Server error (${f.status})`,null}const d=await f.json();return d.success?Es.value=d.exercises:je.value=d.error||"Failed to fetch exercises",d}catch(i){return console.error("Failed to fetch exercises:",i),je.value="Unable to connect to server",null}finally{Ut.value=!1}}async function t(r){Ut.value=!0,je.value=null;try{const i=await fetch(`${On}/exercises/${encodeURIComponent(r)}`,{headers:{"x-api-key":In}});if(!i.ok){const u=await i.text();return je.value=u||`Server error (${i.status})`,null}const c=await i.json();return c.success?Ua.value=c.exercise:je.value=c.error||"Failed to fetch exercise",c}catch(i){return console.error("Failed to fetch exercise detail:",i),je.value="Unable to connect to server",null}finally{Ut.value=!1}}async function s({name:r,description:i,created_by:c,curriculum_path:u,visibility:f,boards:d}){Ut.value=!0,je.value=null;try{const p=await fetch(`${On}/exercises`,{method:"POST",headers:{"Content-Type":"application/json","x-api-key":In},body:JSON.stringify({name:r,description:i||null,created_by:c||null,curriculum_path:u||null,visibility:f||"public",boards:d})});if(!p.ok){const g=await p.text();return je.value=g||`Server error (${p.status})`,{success:!1,error:je.value}}const h=await p.json();return h.success?Es.value=[h.exercise,...Es.value]:je.value=h.error||"Failed to create exercise",h}catch(p){return console.error("Failed to create exercise:",p),je.value="Unable to connect to server",{success:!1,error:"Unable to connect to server"}}finally{Ut.value=!1}}async function n(r,i){Ut.value=!0,je.value=null;try{const c=await fetch(`${On}/exercises/${encodeURIComponent(r)}`,{method:"PUT",headers:{"Content-Type":"application/json","x-api-key":In},body:JSON.stringify(i)});if(!c.ok){const f=await c.text();return je.value=f||`Server error (${c.status})`,{success:!1,error:je.value}}const u=await c.json();return u.success||(je.value=u.error||"Failed to update exercise"),u}catch(c){return console.error("Failed to update exercise:",c),je.value="Unable to connect to server",{success:!1,error:"Unable to connect to server"}}finally{Ut.value=!1}}async function o(r){try{const i=await fetch(`${On}/exercises/${encodeURIComponent(r)}`,{method:"DELETE",headers:{"x-api-key":In}});if(!i.ok){const u=await i.text();return je.value=u||`Server error (${i.status})`,{success:!1,error:je.value}}const c=await i.json();return c.success&&(Es.value=Es.value.filter(u=>u.id!==r)),c}catch(i){return console.error("Failed to delete exercise:",i),{success:!1,error:"Unable to connect to server"}}}function a(){Es.value=[],Ua.value=null,Ut.value=!1,je.value=null}return{exercises:Es,currentExercise:Ua,loading:Ut,error:je,fetchExercises:e,fetchExerciseDetail:t,createExercise:s,updateExercise:n,deleteExercise:o,reset:a}}const hk={class:"modal-content"},gk={class:"step"},yk={class:"form-group"},bk=["value"],_k={key:0,class:"form-hint"},wk={class:"form-group"},Ck={class:"target-options"},Sk={class:"radio-option"},$k={class:"radio-option"},kk={key:0,class:"form-group"},xk=["value"],Ak={key:1,class:"form-group"},Tk=["value"],Nk={class:"form-group"},Ek={class:"step-actions"},Ok=["disabled"],Ik={key:2,class:"error-text"},Rk={__name:"AssignmentCreateModal",props:{preselectedClassroomId:{type:String,default:null}},emits:["close","assignment-created"],setup(e,{emit:t}){const s=e,n=t,o=ze(),a=vk(),r=wn(),i=yo(),c=bn(),u=R(""),f=R("classroom"),d=R(s.preselectedClassroomId||""),p=R(""),h=R(""),g=R(!1),y=R(null),$=E(()=>a.exercises.value),C=E(()=>a.loading.value),b=E(()=>i.teacherClassrooms.value),w=E(()=>c.students.value),A=E(()=>!(!u.value||f.value==="classroom"&&!d.value||f.value==="student"&&!p.value));async function L(){if(!A.value||g.value)return;const V=o.currentUser.value;if(!V)return;g.value=!0,y.value=null;const U=await r.createAssignment({exercise_id:u.value,classroom_id:f.value==="classroom"?d.value:null,student_id:f.value==="student"?p.value:null,assigned_by:V.id,due_at:h.value||null});U.success?n("assignment-created",U.assignment):y.value=U.error||"Failed to create assignment",g.value=!1}return wt(async()=>{a.exercises.value.length||await a.fetchExercises();const V=o.currentUser.value;V&&!i.teacherClassrooms.value.length&&await i.fetchTeacherClassrooms(V.id)}),(V,U)=>(m(),v("div",{class:"modal-overlay",onClick:U[7]||(U[7]=_t(X=>V.$emit("close"),["self"]))},[l("div",hk,[l("div",gk,[U[18]||(U[18]=l("h2",null,"Create Assignment",-1)),U[19]||(U[19]=l("p",{class:"step-desc"},"Assign an exercise to a classroom or individual student.",-1)),l("div",yk,[U[9]||(U[9]=l("label",{for:"exercise-select"},"Exercise",-1)),Be(l("select",{id:"exercise-select","onUpdate:modelValue":U[0]||(U[0]=X=>u.value=X),class:"form-select"},[U[8]||(U[8]=l("option",{value:""},"Select an exercise...",-1)),(m(!0),v(Q,null,ae($.value,X=>(m(),v("option",{key:X.id,value:X.id},_(X.name)+" ("+_(X.board_count)+" boards)",9,bk))),128))],512),[[Hn,u.value]]),C.value?(m(),v("p",_k,"Loading exercises...")):F("",!0)]),l("div",wk,[U[12]||(U[12]=l("label",null,"Assign to",-1)),l("div",Ck,[l("label",Sk,[Be(l("input",{type:"radio","onUpdate:modelValue":U[1]||(U[1]=X=>f.value=X),value:"classroom"},null,512),[[jl,f.value]]),U[10]||(U[10]=l("span",null,"Classroom",-1))]),l("label",$k,[Be(l("input",{type:"radio","onUpdate:modelValue":U[2]||(U[2]=X=>f.value=X),value:"student"},null,512),[[jl,f.value]]),U[11]||(U[11]=l("span",null,"Individual Student",-1))])])]),f.value==="classroom"?(m(),v("div",kk,[U[14]||(U[14]=l("label",{for:"classroom-select"},"Classroom",-1)),Be(l("select",{id:"classroom-select","onUpdate:modelValue":U[3]||(U[3]=X=>d.value=X),class:"form-select"},[U[13]||(U[13]=l("option",{value:""},"Select a classroom...",-1)),(m(!0),v(Q,null,ae(b.value,X=>(m(),v("option",{key:X.id,value:X.id},_(X.name)+" ("+_(X.member_count)+" students)",9,xk))),128))],512),[[Hn,d.value]])])):F("",!0),f.value==="student"?(m(),v("div",Ak,[U[16]||(U[16]=l("label",{for:"student-select"},"Student",-1)),Be(l("select",{id:"student-select","onUpdate:modelValue":U[4]||(U[4]=X=>p.value=X),class:"form-select"},[U[15]||(U[15]=l("option",{value:""},"Select a student...",-1)),(m(!0),v(Q,null,ae(w.value,X=>(m(),v("option",{key:X.id,value:X.id},_(X.first_name)+" "+_(X.last_name),9,Tk))),128))],512),[[Hn,p.value]])])):F("",!0),l("div",Nk,[U[17]||(U[17]=l("label",{for:"due-date"},[Ne("Due Date "),l("span",{class:"optional"},"(optional)")],-1)),Be(l("input",{id:"due-date","onUpdate:modelValue":U[5]||(U[5]=X=>h.value=X),type:"date",class:"form-input"},null,512),[[bt,h.value]])]),l("div",Ek,[l("button",{class:"btn btn-secondary",onClick:U[6]||(U[6]=X=>V.$emit("close"))},"Cancel"),l("button",{class:"btn btn-primary",disabled:!A.value||g.value,onClick:L},_(g.value?"Creating...":"Create Assignment"),9,Ok)]),y.value?(m(),v("p",Ik,_(y.value),1)):F("",!0)])])]))}},Pk=be(Rk,[["__scopeId","data-v-5e97b847"]]),Dk={class:"modal-content"},Lk={class:"modal-body"},Bk={key:0,class:"loading-state"},Mk={key:1,class:"error-state"},Uk={class:"error-text"},Fk={class:"modal-header"},jk={class:"assignment-meta"},Hk={class:"meta-item"},Wk={key:0,class:"meta-item"},Vk={key:1,class:"meta-item"},Kk={key:0,class:"progress-table-wrapper"},Gk={class:"progress-table"},zk={class:"col-name"},Jk={class:"col-progress"},Yk={class:"progress-cell"},qk={class:"progress-bar-track"},Xk={class:"progress-label"},Qk={class:"col-correct"},Zk={key:1,class:"empty-state"},ex={key:2,class:"summary-row"},tx={key:0},sx={__name:"AssignmentDetailModal",props:{assignmentId:{type:String,required:!0}},emits:["close"],setup(e){const t=e,s=wn(),n=R(!0),o=R(null),a=E(()=>s.currentAssignment.value),r=E(()=>{var C;const p=(C=a.value)==null?void 0:C.student_progress;if(!p||p.length===0)return null;const h=p.length,g=p.filter(b=>b.attempted_boards>=b.total_boards).length,y=p.filter(b=>b.attempted_boards>0);let $=null;if(y.length>0){const b=y.reduce((w,A)=>w+A.correct_boards/A.attempted_boards*100,0);$=Math.round(b/y.length)}return{total:h,completed:g,avgAccuracy:$}});function i(p){return p?new Date(p).toLocaleDateString(void 0,{month:"short",day:"numeric"}):""}function c(p){return p.total_boards?Math.round(p.attempted_boards/p.total_boards*100)+"%":"0%"}function u(p){return p.attempted_boards>=p.total_boards?"complete":p.attempted_boards>0?"partial":""}function f(p){return p.attempted_boards===0?"":Math.round(p.correct_boards/p.attempted_boards*100)+"%"}function d(p){if(p.attempted_boards===0)return"";const h=p.correct_boards/p.attempted_boards*100;return h>=80?"accuracy-high":h>=50?"accuracy-mid":"accuracy-low"}return wt(async()=>{const p=await s.fetchAssignmentDetail(t.assignmentId);p!=null&&p.success||(o.value=s.error.value||"Failed to load assignment details"),n.value=!1}),(p,h)=>(m(),v("div",{class:"modal-overlay",onClick:h[2]||(h[2]=_t(g=>p.$emit("close"),["self"]))},[l("div",Dk,[l("div",Lk,[n.value?(m(),v("div",Bk,[...h[3]||(h[3]=[l("div",{class:"spinner"},null,-1),l("p",null,"Loading assignment details...",-1)])])):o.value?(m(),v("div",Mk,[l("p",Uk,_(o.value),1),l("button",{class:"btn btn-secondary",onClick:h[0]||(h[0]=g=>p.$emit("close"))},"Close")])):a.value?(m(),v(Q,{key:2},[l("div",Fk,[l("h2",null,_(a.value.exercise_name),1),l("button",{class:"close-btn",onClick:h[1]||(h[1]=g=>p.$emit("close")),"aria-label":"Close"},"")]),l("div",jk,[l("span",Hk,_(a.value.total_boards)+" "+_(a.value.total_boards===1?"board":"boards"),1),a.value.due_at?(m(),v("span",Wk,"Due "+_(i(a.value.due_at)),1)):F("",!0),a.value.classroom_name?(m(),v("span",Vk,_(a.value.classroom_name),1)):F("",!0)]),a.value.student_progress&&a.value.student_progress.length?(m(),v("div",Kk,[l("table",Gk,[h[4]||(h[4]=l("thead",null,[l("tr",null,[l("th",{class:"col-name"},"Student"),l("th",{class:"col-progress"},"Progress"),l("th",{class:"col-correct"},"Correct"),l("th",{class:"col-accuracy"},"Accuracy")])],-1)),l("tbody",null,[(m(!0),v(Q,null,ae(a.value.student_progress,g=>(m(),v("tr",{key:g.student_id},[l("td",zk,_(g.first_name)+" "+_(g.last_name),1),l("td",Jk,[l("div",Yk,[l("div",qk,[l("div",{class:le(["progress-bar-fill",u(g)]),style:st({width:c(g)})},null,6)]),l("span",Xk,_(g.attempted_boards)+"/"+_(g.total_boards),1)])]),l("td",Qk,_(g.correct_boards)+"/"+_(g.total_boards),1),l("td",{class:le(["col-accuracy",d(g)])},_(f(g)),3)]))),128))])])])):(m(),v("div",Zk,[...h[5]||(h[5]=[l("p",null,"No students assigned yet.",-1)])])),r.value?(m(),v("div",ex,[l("span",null,_(r.value.completed)+"/"+_(r.value.total)+" students completed",1),r.value.avgAccuracy!==null?(m(),v("span",tx,_(r.value.avgAccuracy)+"% avg accuracy",1)):F("",!0)])):F("",!0)],64)):F("",!0)])])]))}},nx=be(sx,[["__scopeId","data-v-d654f00a"]]),ox={class:"needs-attention"},ax={class:"panel-header"},rx={key:0,class:"empty-state"},lx={key:1,class:"attention-list"},ix={class:"item-icon"},cx={class:"item-text"},ux={__name:"NeedsAttention",props:{items:{type:Array,default:()=>[]}},emits:["clear"],setup(e){function t(o){switch(o){case"due_soon":return"";case"low_score":return"";default:return""}}function s(o){switch(o.type){case"due_soon":{const a=n(o.due_at),r=a<=1?"tomorrow":`in ${a} days`;return`${o.exercise_name} due ${r}  ${o.lagging_count} of ${o.total_students} students haven't finished`}case"low_score":return`${o.student_name} scored ${o.accuracy_pct}% on ${o.exercise_name} in ${o.classroom_name}`;default:return""}}function n(o){if(!o)return 0;const a=new Date(o)-Date.now();return Math.max(0,Math.ceil(a/(1e3*60*60*24)))}return(o,a)=>(m(),v("div",ox,[l("div",ax,[a[1]||(a[1]=l("h3",{class:"panel-title"},"Needs Attention",-1)),e.items.length?(m(),v("button",{key:0,class:"clear-btn",onClick:a[0]||(a[0]=r=>o.$emit("clear"))},"Clear")):F("",!0)]),e.items.length?(m(),v("div",lx,[(m(!0),v(Q,null,ae(e.items,(r,i)=>(m(),v("div",{key:i,class:le(["attention-item",r.type])},[l("span",ix,_(t(r.type)),1),l("span",cx,_(s(r)),1)],2))),128))])):(m(),v("div",rx," All caught up! No items need attention. "))]))}},dx=be(ux,[["__scopeId","data-v-65e8ba1f"]]),fx={class:"recent-activity"},px={class:"panel-header"},mx={key:0,class:"empty-state"},vx={key:1,class:"activity-list"},hx={class:"event-content"},gx={class:"event-text"},yx={class:"event-time"},bx={__name:"RecentActivity",props:{events:{type:Array,default:()=>[]}},emits:["clear"],setup(e){function t(o){switch(o){case"assignment_completed":return"";case"student_joined":return"";default:return""}}function s(o){switch(o.type){case"assignment_completed":return`${o.student_name} completed ${o.exercise_name}`;case"student_joined":return`${o.student_name} joined ${o.classroom_name}`;default:return""}}function n(o){if(!o)return"";const a=Date.now()-new Date(o).getTime(),r=Math.floor(a/6e4);if(r<1)return"just now";if(r<60)return`${r}m ago`;const i=Math.floor(r/60);return i<24?`${i}h ago`:`${Math.floor(i/24)}d ago`}return(o,a)=>(m(),v("div",fx,[l("div",px,[a[1]||(a[1]=l("h3",{class:"panel-title"},"Recent Activity",-1)),e.events.length?(m(),v("button",{key:0,class:"clear-btn",onClick:a[0]||(a[0]=r=>o.$emit("clear"))},"Clear")):F("",!0)]),e.events.length?(m(),v("div",vx,[(m(!0),v(Q,null,ae(e.events,(r,i)=>(m(),v("div",{key:i,class:"activity-item"},[l("span",{class:le(["event-icon",r.type])},_(t(r.type)),3),l("div",hx,[l("span",gx,_(s(r)),1),l("span",yx,_(n(r.timestamp)),1)])]))),128))])):(m(),v("div",mx," No recent activity. "))]))}},_x=be(bx,[["__scopeId","data-v-39e672f5"]]),wx={class:"teacher-lobby"},Cx={class:"welcome-section"},Sx={class:"welcome-title"},$x={class:"welcome-subtitle"},kx={class:"quick-actions"},xx={key:0,class:"loading-state"},Ax={key:1,class:"dashboard-grid"},Tx={class:"left-column"},Nx={key:0,class:"classrooms-section"},Ex={class:"classroom-cards"},Ox={key:1,class:"empty-state"},Ix={class:"right-column"},Rx={class:"collections-section"},Px={__name:"TeacherLobby",props:{isAdmin:{type:Boolean,default:!1}},emits:["select-collection","show-admin","load-file"],setup(e){const t=ze(),s=g$(),n=R(!1),o=R(!1),a=R(null),r=R(null),i=E(()=>{const g=t.currentUser.value;return g?g.firstName:""}),c=E(()=>{const g=s.summaryStats.value;if(!g||g.classroomCount===0)return"Get started by creating your first classroom.";const y=[];return y.push(`${g.classroomCount} active ${g.classroomCount===1?"classroom":"classrooms"}`),g.openAssignmentCount>0&&y.push(`${g.openAssignmentCount} open ${g.openAssignmentCount===1?"assignment":"assignments"}`),y.join(", ")+"."});function u(g){r.value=r.value===g?null:g}function f(g){n.value=!1,r.value=g.id,h()}function d(){o.value=!1,h()}function p(g){const y=t.currentUser.value;y&&s.clearPanel(y.id,g)}function h(){const g=t.currentUser.value;g&&s.loadTeacherLobbyData(g.id,!0)}return wt(()=>{const g=t.currentUser.value;g&&s.loadTeacherLobbyData(g.id)}),(g,y)=>(m(),v("div",wx,[l("div",Cx,[l("h2",Sx,"Welcome back, "+_(i.value),1),l("p",$x,_(c.value),1)]),l("div",kx,[l("button",{class:"action-btn create",onClick:y[0]||(y[0]=$=>n.value=!0)}," + New Classroom "),l("button",{class:"action-btn assign",onClick:y[1]||(y[1]=$=>o.value=!0)}," + New Assignment "),e.isAdmin?(m(),v("button",{key:0,class:"action-btn admin",onClick:y[2]||(y[2]=$=>g.$emit("show-admin"))}," Admin Panel ")):F("",!0)]),B(s).lobbyLoading.value&&!B(s).lobbyClassrooms.value.length?(m(),v("div",xx,[...y[11]||(y[11]=[l("div",{class:"spinner"},null,-1),l("p",null,"Loading dashboard...",-1)])])):(m(),v("div",Ax,[l("div",Tx,[B(s).lobbyClassrooms.value.length?(m(),v("div",Nx,[y[12]||(y[12]=l("h3",{class:"section-title"},"My Classrooms",-1)),l("div",Ex,[(m(!0),v(Q,null,ae(B(s).lobbyClassrooms.value,$=>(m(),Le(ak,{key:$.id,classroom:$,expanded:r.value===$.id,onToggle:C=>u($.id),onMemberRemoved:h,onViewAssignment:y[3]||(y[3]=C=>a.value=C)},null,8,["classroom","expanded","onToggle"]))),128))])])):(m(),v("div",Ox,[...y[13]||(y[13]=[l("p",{class:"empty-title"},"No classrooms yet",-1),l("p",{class:"empty-desc"},"Create a classroom and share the invite link with your students.",-1)])]))]),l("div",Ix,[ge(dx,{items:B(s).needsAttention.value,onClear:y[4]||(y[4]=$=>p("attention"))},null,8,["items"]),ge(_x,{events:B(s).recentActivity.value,onClear:y[5]||(y[5]=$=>p("activity"))},null,8,["events"])])])),l("div",Rx,[y[14]||(y[14]=l("h3",{class:"section-title"},"Lesson Collections",-1)),ge(nl,{onSelectCollection:y[6]||(y[6]=$=>g.$emit("select-collection",$)),onLoadFile:y[7]||(y[7]=$=>g.$emit("load-file",$))})]),n.value?(m(),Le(mk,{key:2,onClose:y[8]||(y[8]=$=>n.value=!1),onClassroomCreated:f})):F("",!0),o.value?(m(),Le(Pk,{key:3,onClose:y[9]||(y[9]=$=>o.value=!1),onAssignmentCreated:d})):F("",!0),a.value?(m(),Le(nx,{key:4,"assignment-id":a.value,onClose:y[10]||(y[10]=$=>a.value=null)},null,8,["assignment-id"])):F("",!0)]))}},Dx=be(Px,[["__scopeId","data-v-364209cc"]]),Fu="https://api.bridge-classroom.com/api",ju="8a3ccc23767bdcbe6bb1709dfe3f20194dc0b8b4874939244e802dc71a21a568",Hu=R(null),Wu=R([]),Vu=R(null),Ku=R(null),gr=R(!1),yr=R(null),Fa=R(null),Lx=60*1e3;async function Gu(e=!1){if(!e&&Fa.value&&Date.now()-new Date(Fa.value).getTime()<Lx)return{success:!0,cached:!0};gr.value=!0,yr.value=null;try{const t=await fetch(`${Fu}/admin/stats`,{headers:{"x-api-key":ju}});if(!t.ok)throw new Error(`Failed to fetch admin stats: ${t.status}`);const s=await t.json();return Hu.value=s.stats,Wu.value=s.popular_lessons||[],Vu.value=s.database,Fa.value=new Date().toISOString(),{success:!0}}catch(t){return console.error("Failed to load admin stats:",t),yr.value=t.message,{success:!1,error:t.message}}finally{gr.value=!1}}async function zu(){try{const e=await fetch(`${Fu}/admin/health`,{headers:{"x-api-key":ju}});if(!e.ok)throw new Error(`Failed to fetch health: ${e.status}`);const t=await e.json();return Ku.value=t.health,{success:!0}}catch(e){return console.error("Failed to load health:",e),{success:!1,error:e.message}}}async function Bx(){await Promise.all([Gu(!0),zu()])}function Mx(e){if(e===0)return"0 B";const t=1024,s=["B","KB","MB","GB"],n=Math.floor(Math.log(e)/Math.log(t));return parseFloat((e/Math.pow(t,n)).toFixed(1))+" "+s[n]}function Ux(e){const t=Math.floor(e/86400),s=Math.floor(e%86400/3600),n=Math.floor(e%3600/60),o=[];return t>0&&o.push(`${t}d`),s>0&&o.push(`${s}h`),o.push(`${n}m`),o.join(" ")}function rl(){return{stats:Hu,popularLessons:Wu,database:Vu,health:Ku,loading:gr,error:yr,loadStats:Gu,loadHealth:zu,refreshAll:Bx,formatBytes:Mx,formatUptime:Ux}}const Fx={class:"stats-row"},jx={class:"stat-card",style:{"border-top-color":"#2d6a4f"}},Hx={class:"stat-number"},Wx={class:"stat-card",style:{"border-top-color":"#1565c0"}},Vx={class:"stat-number"},Kx={class:"stat-card",style:{"border-top-color":"#7b1fa2"}},Gx={class:"stat-number"},zx={class:"stat-card",style:{"border-top-color":"#e65100"}},Jx={class:"stat-number"},Yx={__name:"AdminStatsRow",props:{stats:{type:Object,default:null}},setup(e){function t(s){return s==null?"":s.toLocaleString()}return(s,n)=>{var o,a,r,i;return m(),v("div",Fx,[l("div",jx,[l("div",Hx,_(((o=e.stats)==null?void 0:o.total_users)??""),1),n[0]||(n[0]=l("div",{class:"stat-label"},"Total Users",-1))]),l("div",Wx,[l("div",Vx,_(((a=e.stats)==null?void 0:a.active_7d)??""),1),n[1]||(n[1]=l("div",{class:"stat-label"},"Active (7d)",-1))]),l("div",Kx,[l("div",Gx,_(t((r=e.stats)==null?void 0:r.observation_count_7d)),1),n[2]||(n[2]=l("div",{class:"stat-label"},"Observations (7d)",-1))]),l("div",zx,[l("div",Jx,_(((i=e.stats)==null?void 0:i.active_today)??""),1),n[3]||(n[3]=l("div",{class:"stat-label"},"Active Today",-1))])])}}},qx=be(Yx,[["__scopeId","data-v-a14a2199"]]),Xx={class:"popular-lessons"},Qx={key:0,class:"empty-state"},Zx={key:1,class:"table-wrap"},eA={class:"lessons-table"},tA={class:"lesson-name"},sA={class:"num-col"},nA={class:"num-col"},oA={class:"num-col"},aA={__name:"PopularLessons",props:{lessons:{type:Array,default:()=>[]}},setup(e){function t(n){if(!n)return"Unknown";const o=n.split("/");return o[o.length-1].replace(/-/g," ")}function s(n){return n>=70?"high":n>=50?"mid":"low"}return(n,o)=>(m(),v("div",Xx,[o[1]||(o[1]=l("h3",{class:"panel-title"},"Popular Lessons",-1)),e.lessons.length?(m(),v("div",Zx,[l("table",eA,[o[0]||(o[0]=l("thead",null,[l("tr",null,[l("th",null,"Lesson"),l("th",{class:"num-col"},"Plays"),l("th",{class:"num-col"},"Users"),l("th",{class:"num-col"},"Accuracy")])],-1)),l("tbody",null,[(m(!0),v(Q,null,ae(e.lessons.slice(0,15),a=>(m(),v("tr",{key:a.deal_subfolder},[l("td",tA,_(t(a.deal_subfolder)),1),l("td",sA,_(a.play_count.toLocaleString()),1),l("td",nA,_(a.unique_users),1),l("td",oA,[l("span",{class:le(["accuracy-badge",s(a.accuracy_pct)])},_(a.accuracy_pct)+"% ",3)])]))),128))])])])):(m(),v("div",Qx,"No lesson data yet."))]))}},rA=be(aA,[["__scopeId","data-v-079bd4f8"]]),lA={class:"database-panel"},iA={key:0,class:"empty-state"},cA={class:"db-size"},uA={class:"tables-table"},dA={class:"table-name"},fA={class:"num-col"},pA={__name:"DatabasePanel",props:{database:{type:Object,default:null}},setup(e){const{formatBytes:t}=rl();return(s,n)=>(m(),v("div",lA,[n[2]||(n[2]=l("h3",{class:"panel-title"},"Database",-1)),e.database?(m(),v(Q,{key:1},[l("div",cA,[n[0]||(n[0]=Ne(" SQLite file: ",-1)),l("strong",null,_(B(t)(e.database.file_size_bytes)),1)]),l("table",uA,[n[1]||(n[1]=l("thead",null,[l("tr",null,[l("th",null,"Table"),l("th",{class:"num-col"},"Rows")])],-1)),l("tbody",null,[(m(!0),v(Q,null,ae(e.database.tables,o=>(m(),v("tr",{key:o.name},[l("td",dA,_(o.name),1),l("td",fA,_(o.row_count.toLocaleString()),1)]))),128))])])],64)):(m(),v("div",iA,"Loading..."))]))}},mA=be(pA,[["__scopeId","data-v-d5945aff"]]),vA={class:"system-health"},hA={class:"health-header"},gA=["disabled"],yA={key:0,class:"empty-state"},bA={key:1,class:"health-rows"},_A={class:"health-row"},wA={class:"health-value"},CA={class:"health-row"},SA={class:"health-value"},$A={class:"health-row"},kA={class:"health-value"},xA={class:"health-row"},AA={class:"health-value"},TA={class:"health-row"},NA={class:"health-value"},EA={__name:"SystemHealth",props:{health:{type:Object,default:null},refreshing:{type:Boolean,default:!1}},emits:["refresh"],setup(e){const{formatUptime:t}=rl();function s(n){if(!n)return"";const o=Date.now()-new Date(n).getTime(),a=Math.floor(o/6e4);if(a<1)return"just now";if(a<60)return`${a}m ago`;const r=Math.floor(a/60);return r<24?`${r}h ago`:`${Math.floor(r/24)}d ago`}return(n,o)=>(m(),v("div",vA,[l("div",hA,[o[1]||(o[1]=l("h3",{class:"panel-title"},"System Health",-1)),l("button",{class:"refresh-btn",onClick:o[0]||(o[0]=a=>n.$emit("refresh")),disabled:e.refreshing},_(e.refreshing?"Refreshing...":"Refresh"),9,gA)]),e.health?(m(),v("div",bA,[l("div",_A,[o[2]||(o[2]=l("span",{class:"status-dot green"},null,-1)),o[3]||(o[3]=l("span",{class:"health-label"},"API Server",-1)),l("span",wA,"Up "+_(B(t)(e.health.uptime_seconds)),1)]),l("div",CA,[l("span",{class:le(["status-dot",e.health.database_writable?"green":"red"])},null,2),o[4]||(o[4]=l("span",{class:"health-label"},"Database",-1)),l("span",SA,_(e.health.database_writable?"Writable":"Error"),1)]),l("div",$A,[l("span",{class:le(["status-dot",e.health.last_observation_at?"green":"yellow"])},null,2),o[5]||(o[5]=l("span",{class:"health-label"},"Last Observation",-1)),l("span",kA,_(e.health.last_observation_at?s(e.health.last_observation_at):"None"),1)]),l("div",xA,[o[6]||(o[6]=l("span",{class:"status-dot green"},null,-1)),o[7]||(o[7]=l("span",{class:"health-label"},"Disk",-1)),l("span",AA,_(e.health.disk_available_gb)+" GB / "+_(e.health.disk_total_gb)+" GB available",1)]),l("div",TA,[o[8]||(o[8]=l("span",{class:"status-dot blue"},null,-1)),o[9]||(o[9]=l("span",{class:"health-label"},"API Version",-1)),l("span",NA,"v"+_(e.health.api_version),1)])])):(m(),v("div",yA,"Loading..."))]))}},OA=be(EA,[["__scopeId","data-v-0d4e96d5"]]),IA={class:"admin-lobby"},RA={class:"admin-header"},PA={key:0,class:"admin-subtitle"},DA={key:0,class:"loading-state"},LA={key:1,class:"error-state"},BA={class:"announcement-section"},MA={class:"announcement-info"},UA=["innerHTML"],FA={key:0,class:"announcement-expires"},jA={key:1,class:"announcement-expires"},HA={class:"announcement-actions"},WA=["disabled"],VA={key:1,class:"announcement-form"},KA={class:"form-row"},GA=["disabled"],zA={class:"content-grid"},JA={class:"name-correction-section"},YA={class:"search-row"},qA=["disabled"],XA={key:0,class:"search-results"},QA=["onClick"],ZA={class:"result-name"},e2={class:"result-email"},t2={key:0,class:"corrected-badge"},s2={key:1,class:"no-results"},n2={key:2,class:"edit-form"},o2={class:"edit-row"},a2={class:"edit-field"},r2={class:"edit-field"},l2=["disabled"],i2={key:0,class:"save-feedback success"},c2={key:1,class:"save-feedback error"},u2={__name:"AdminLobby",emits:["back"],setup(e){const t=rl(),s=sl(),n=R(!1),o=R(""),a=R("info"),r=R(""),i=R(!1),c=R(!1),u=R(!1);function f(){const O=s.announcement.value;if(O){if(o.value=O.message,a.value=O.type,O.expires_at){const M=new Date(O.expires_at);r.value=new Date(M.getTime()-M.getTimezoneOffset()*6e4).toISOString().slice(0,16)}else r.value="";u.value=!0}}function d(){u.value=!1,o.value="",a.value="info",r.value=""}async function p(){if(o.value.trim()){i.value=!0;try{const O=r.value?new Date(r.value).toISOString():null;await s.setAnnouncement(o.value.trim(),a.value,O),o.value="",a.value="info",r.value="",u.value=!1}catch(O){console.error("Failed to publish announcement:",O)}finally{i.value=!1}}}async function h(){c.value=!0;try{await s.clearAnnouncement()}catch(O){console.error("Failed to clear announcement:",O)}finally{c.value=!1}}function g(O){return O?new Date(O).toLocaleString():""}const y={red:{bg:"#ef5350",fg:"white"},yellow:{bg:"#ffeb3b",fg:"#333"},orange:{bg:"#ff9800",fg:"white"},green:{bg:"#4caf50",fg:"white"},grey:{bg:"#ccc",fg:"#666"}};function $(O){return O.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/:(\w+):/g,(j,D)=>{const ee=y[D.toLowerCase()];return ee?`<span class="ann-circle" style="background:${ee.bg};color:${ee.fg}"></span>`:j})}const C="https://api.bridge-classroom.com/api",b="8a3ccc23767bdcbe6bb1709dfe3f20194dc0b8b4874939244e802dc71a21a568",w=R(""),A=R([]),L=R(!1),V=R(!1),U=R(null),X=R(""),q=R(""),ue=R(!1),ve=R(!1),de=R("");async function ye(){if(w.value.trim()){V.value=!0,L.value=!1,A.value=[],U.value=null,ve.value=!1,de.value="";try{const O=await fetch(`${C}/admin/users/search?q=${encodeURIComponent(w.value.trim())}`,{headers:{"x-api-key":b}});if(!O.ok)throw new Error(`Search failed: ${O.status}`);const M=await O.json();A.value=M.users||[]}catch(O){console.error("User search failed:",O)}finally{V.value=!1,L.value=!0}}}function Se(O){U.value=O,X.value=O.first_name,q.value=O.last_name,ve.value=!1,de.value=""}async function fe(){if(!(!U.value||!X.value.trim()||!q.value.trim())){ue.value=!0,ve.value=!1,de.value="";try{const O=await fetch(`${C}/admin/users/${encodeURIComponent(U.value.id)}`,{method:"PATCH",headers:{"Content-Type":"application/json","x-api-key":b},body:JSON.stringify({first_name:X.value.trim(),last_name:q.value.trim()})});if(!O.ok)throw new Error(`Save failed: ${O.status}`);const M=await O.json();M.success&&(ve.value=!0,U.value.first_name=M.user.first_name,U.value.last_name=M.user.last_name,U.value.name_corrected_at=M.user.name_corrected_at)}catch(O){de.value=O.message}finally{ue.value=!1}}}async function ie(){await Promise.all([t.loadStats(),t.loadHealth()])}async function H(){n.value=!0,await t.refreshAll(),n.value=!1}return wt(ie),(O,M)=>(m(),v("div",IA,[l("div",RA,[l("button",{class:"back-btn",onClick:M[0]||(M[0]=j=>O.$emit("back"))}," Back to Dashboard"),M[7]||(M[7]=l("h2",{class:"admin-title"},"Admin Dashboard",-1)),B(t).stats.value?(m(),v("p",PA,_(B(t).stats.value.total_observations.toLocaleString())+" total observations across "+_(B(t).stats.value.total_users)+" users ",1)):F("",!0)]),B(t).loading.value&&!B(t).stats.value?(m(),v("div",DA,[...M[8]||(M[8]=[l("div",{class:"spinner"},null,-1),l("p",null,"Loading dashboard...",-1)])])):B(t).error.value?(m(),v("div",LA,[l("p",null,_(B(t).error.value),1),l("button",{class:"retry-btn",onClick:ie},"Retry")])):B(t).stats.value?(m(),v(Q,{key:2},[l("div",BA,[M[10]||(M[10]=l("h3",{class:"section-title"},"Site Announcement",-1)),B(s).announcement.value&&!u.value?(m(),v("div",{key:0,class:le(["current-announcement",B(s).announcement.value.type])},[l("div",MA,[l("span",{class:le(["announcement-type-badge",B(s).announcement.value.type])},_(B(s).announcement.value.type),3),l("span",{class:"announcement-message",innerHTML:$(B(s).announcement.value.message)},null,8,UA),B(s).announcement.value.expires_at?(m(),v("span",FA," Expires: "+_(g(B(s).announcement.value.expires_at)),1)):(m(),v("span",jA,"No expiration"))]),l("div",HA,[l("button",{class:"edit-btn",onClick:f},"Edit"),l("button",{class:"clear-btn",onClick:h,disabled:c.value},_(c.value?"Clearing...":"Clear"),9,WA)])],2)):u.value||!B(s).announcement.value?(m(),v("div",VA,[Be(l("input",{"onUpdate:modelValue":M[1]||(M[1]=j=>o.value=j),type:"text",class:"announcement-input",placeholder:"Enter announcement message...",onKeydown:Vo(p,["enter"])},null,544),[[bt,o.value]]),l("div",KA,[Be(l("select",{"onUpdate:modelValue":M[2]||(M[2]=j=>a.value=j),class:"type-select"},[...M[9]||(M[9]=[l("option",{value:"info"},"Info",-1),l("option",{value:"warning"},"Warning",-1),l("option",{value:"urgent"},"Urgent",-1)])],512),[[Hn,a.value]]),Be(l("input",{"onUpdate:modelValue":M[3]||(M[3]=j=>r.value=j),type:"datetime-local",class:"expiry-input",title:"Optional expiration date"},null,512),[[bt,r.value]]),u.value?(m(),v("button",{key:0,class:"cancel-btn",onClick:d},"Cancel")):F("",!0),l("button",{class:"publish-btn",onClick:p,disabled:!o.value.trim()||i.value},_(i.value?"Publishing...":u.value?"Update":"Publish"),9,GA)])])):F("",!0)]),ge(qx,{stats:B(t).stats.value},null,8,["stats"]),l("div",zA,[ge(rA,{lessons:B(t).popularLessons.value},null,8,["lessons"]),ge(mA,{database:B(t).database.value},null,8,["database"])]),ge(OA,{health:B(t).health.value,refreshing:n.value,onRefresh:H},null,8,["health","refreshing"]),l("div",JA,[M[13]||(M[13]=l("h3",{class:"section-title"},"Correct User Name",-1)),l("div",YA,[Be(l("input",{"onUpdate:modelValue":M[4]||(M[4]=j=>w.value=j),type:"text",class:"search-input",placeholder:"Search by name or email...",onKeydown:Vo(ye,["enter"])},null,544),[[bt,w.value]]),l("button",{class:"search-btn",onClick:ye,disabled:V.value||!w.value.trim()},_(V.value?"Searching...":"Search"),9,qA)]),A.value.length?(m(),v("div",XA,[(m(!0),v(Q,null,ae(A.value,j=>(m(),v("div",{key:j.id,class:le(["search-result-item",{selected:U.value&&U.value.id===j.id}]),onClick:D=>Se(j)},[l("span",ZA,_(j.first_name)+" "+_(j.last_name),1),l("span",e2,_(j.email),1),j.name_corrected_at?(m(),v("span",t2,"corrected")):F("",!0)],10,QA))),128))])):F("",!0),L.value&&!A.value.length?(m(),v("div",s2,' No users found for "'+_(w.value)+'" ',1)):F("",!0),U.value?(m(),v("div",n2,[l("div",o2,[l("div",a2,[M[11]||(M[11]=l("label",null,"First Name",-1)),Be(l("input",{"onUpdate:modelValue":M[5]||(M[5]=j=>X.value=j),type:"text",class:"edit-input"},null,512),[[bt,X.value]])]),l("div",r2,[M[12]||(M[12]=l("label",null,"Last Name",-1)),Be(l("input",{"onUpdate:modelValue":M[6]||(M[6]=j=>q.value=j),type:"text",class:"edit-input"},null,512),[[bt,q.value]])]),l("button",{class:"save-btn",onClick:fe,disabled:ue.value||!X.value.trim()||!q.value.trim()},_(ue.value?"Saving...":"Save"),9,l2)]),ve.value?(m(),v("p",i2,"Name corrected successfully.")):F("",!0),de.value?(m(),v("p",c2,_(de.value),1)):F("",!0)])):F("",!0)])],64)):F("",!0)]))}},d2=be(u2,[["__scopeId","data-v-5a6964cf"]]),f2={class:"lobby-view"},p2={__name:"LobbyView",emits:["select-collection","select-assignment","show-become-teacher","load-file"],setup(e){const t=ze(),s=wn(),n=R(!1),o=E(()=>{const i=t.currentUser.value;return(i==null?void 0:i.role)||"student"}),a=E(()=>s.studentAssignments.value.length>0),r=E(()=>{const i=t.currentUser.value;return Array.isArray(i==null?void 0:i.classrooms)&&i.classrooms.length>0});return wt(()=>{const i=t.currentUser.value;i&&o.value==="student"&&s.fetchStudentAssignments(i.id)}),(i,c)=>(m(),v("div",f2,[n.value?(m(),Le(d2,{key:0,onBack:c[0]||(c[0]=u=>n.value=!1)})):o.value==="admin"||o.value==="teacher"?(m(),Le(Dx,{key:1,"is-admin":o.value==="admin",onSelectCollection:c[1]||(c[1]=u=>i.$emit("select-collection",u)),onShowAdmin:c[2]||(c[2]=u=>n.value=!0),onLoadFile:c[3]||(c[3]=u=>i.$emit("load-file",u))},null,8,["is-admin"])):a.value||r.value?(m(),Le(p$,{key:2,onSelectCollection:c[4]||(c[4]=u=>i.$emit("select-collection",u)),onSelectAssignment:c[5]||(c[5]=u=>i.$emit("select-assignment",u)),onLoadFile:c[6]||(c[6]=u=>i.$emit("load-file",u))})):(m(),Le(qS,{key:3,onSelectCollection:c[7]||(c[7]=u=>i.$emit("select-collection",u)),onShowBecomeTeacher:c[8]||(c[8]=u=>i.$emit("show-become-teacher")),onLoadFile:c[9]||(c[9]=u=>i.$emit("load-file",u))}))]))}},m2=be(p2,[["__scopeId","data-v-d84f343d"]]),v2={class:"modal-content"},h2={key:0,class:"step step-overview"},g2={class:"step-actions"},y2={key:1,class:"step step-agreement"},b2={class:"agreement-checkbox"},_2={class:"step-actions"},w2=["disabled"],C2={key:0,class:"error-text"},S2={key:2,class:"step step-confirmation"},$2={class:"step-actions"},k2={__name:"BecomeTeacherModal",emits:["close","activated"],setup(e){const t="https://api.bridge-classroom.com/api",s="8a3ccc23767bdcbe6bb1709dfe3f20194dc0b8b4874939244e802dc71a21a568",n=ze(),o=R(1),a=R(!1),r=R(!1),i=R(null);async function c(){const u=n.currentUser.value;if(u){r.value=!0,i.value=null;try{const d=await(await fetch(`${t}/users/me`,{method:"PATCH",headers:{"Content-Type":"application/json","x-api-key":s},body:JSON.stringify({user_id:u.id,action:"become_teacher"})})).json();if(!d.success){i.value=d.error||"Failed to upgrade account";return}n.updateUser(u.id,{role:"teacher"});try{const{publicKey:p,privateKey:h}=await sv();await fetch(`${t}/viewers`,{method:"POST",headers:{"Content-Type":"application/json","x-api-key":s},body:JSON.stringify({name:`${u.firstName} ${u.lastName}`,email:u.email,public_key:p,role:"teacher"})}),sessionStorage.setItem("bridgeTeacherSession",JSON.stringify({privateKeyBase64:h,expiry:new Date(Date.now()+8*60*60*1e3).toISOString()}))}catch(p){console.warn("Failed to create viewer record:",p)}o.value=3}catch(f){console.error("Teacher activation failed:",f),i.value="Unable to connect to server. Please try again."}finally{r.value=!1}}}return(u,f)=>(m(),v("div",{class:"modal-overlay",onClick:f[5]||(f[5]=_t(d=>u.$emit("close"),["self"]))},[l("div",v2,[o.value===1?(m(),v("div",h2,[f[6]||(f[6]=to('<h2 data-v-56e5717d>Become a Teacher</h2><p class="step-desc" data-v-56e5717d>Unlock classroom management tools to track your students&#39; progress.</p><div class="capabilities" data-v-56e5717d><div class="capability" data-v-56e5717d><span class="capability-icon" data-v-56e5717d></span><div data-v-56e5717d><strong data-v-56e5717d>Create Classrooms</strong><p data-v-56e5717d>Organize students into classes with invite links.</p></div></div><div class="capability" data-v-56e5717d><span class="capability-icon" data-v-56e5717d></span><div data-v-56e5717d><strong data-v-56e5717d>Assign Exercises</strong><p data-v-56e5717d>Assign curated board sets to your class or individual students.</p></div></div><div class="capability" data-v-56e5717d><span class="capability-icon" data-v-56e5717d></span><div data-v-56e5717d><strong data-v-56e5717d>Track Progress</strong><p data-v-56e5717d>See which boards students have completed and their accuracy.</p></div></div></div><div class="note-box" data-v-56e5717d><strong data-v-56e5717d>Still a Student Too</strong><p data-v-56e5717d>Teachers keep full access to all lessons, exercises, and practice tools.</p></div>',4)),l("div",g2,[l("button",{class:"btn btn-secondary",onClick:f[0]||(f[0]=d=>u.$emit("close"))},"Not Now"),l("button",{class:"btn btn-primary",onClick:f[1]||(f[1]=d=>o.value=2)},"Continue ")])])):o.value===2?(m(),v("div",y2,[f[8]||(f[8]=to('<h2 data-v-56e5717d>Teacher Agreement</h2><p class="step-desc" data-v-56e5717d>Please review and accept the terms below.</p><div class="terms-scroll" data-v-56e5717d><h4 data-v-56e5717d>Service Availability</h4><p data-v-56e5717d>Bridge Classroom is provided as a free educational tool on an &quot;as-is&quot; basis. There is no guarantee of uptime, availability, or continued operation. The service may be modified or discontinued at any time without notice.</p><h4 data-v-56e5717d>Data &amp; Storage</h4><p data-v-56e5717d>While we take reasonable care with data, there is no warranty on data preservation. Teachers are encouraged to export important data regularly. Student observations are encrypted end-to-end.</p><h4 data-v-56e5717d>Student Data &amp; Privacy</h4><p data-v-56e5717d>As a teacher, you will be able to see practice observations (which exercises students have completed and their accuracy) for students in your classrooms. You agree to:</p><ul data-v-56e5717d><li data-v-56e5717d>Use student data for educational purposes only</li><li data-v-56e5717d>Not share student data publicly or with unauthorized parties</li><li data-v-56e5717d>Respect that students can revoke your access at any time</li></ul><h4 data-v-56e5717d>Your Responsibilities</h4><p data-v-56e5717d>Teachers manage their own classrooms, communication, and student relationships. Bridge Classroom provides the tools but does not mediate teacher-student interactions.</p><h4 data-v-56e5717d>No Warranty</h4><p data-v-56e5717d>The service is provided &quot;as is&quot; without warranty of any kind, express or implied. In no event shall the developers be liable for any damages arising from the use of this service.</p><h4 data-v-56e5717d>Open Source</h4><p data-v-56e5717d>Bridge Classroom is open source software. The source code is available on GitHub.</p></div>',3)),l("label",b2,[Be(l("input",{type:"checkbox","onUpdate:modelValue":f[2]||(f[2]=d=>a.value=d)},null,512),[[Ur,a.value]]),f[7]||(f[7]=l("span",null,"I have read and agree to the terms above. I understand that Bridge Classroom is a free, as-is service with no guarantees of uptime or data preservation.",-1))]),l("div",_2,[l("button",{class:"btn btn-secondary",onClick:f[3]||(f[3]=d=>o.value=1)}," Back"),l("button",{class:"btn btn-primary",disabled:!a.value||r.value,onClick:c},_(r.value?"Activating...":"Activate Teacher Account"),9,w2)]),i.value?(m(),v("p",C2,_(i.value),1)):F("",!0)])):o.value===3?(m(),v("div",S2,[f[9]||(f[9]=l("div",{class:"success-icon"},"",-1)),f[10]||(f[10]=l("h2",null,"You're a Teacher!",-1)),f[11]||(f[11]=l("p",{class:"step-desc"},"Your account has been upgraded. Here's what to do next:",-1)),f[12]||(f[12]=l("ol",{class:"next-steps"},[l("li",null,"Create your first classroom from the teacher dashboard"),l("li",null,"Share the invite link with your students"),l("li",null,"Browse exercises and assign them to your class")],-1)),l("div",$2,[l("button",{class:"btn btn-primary",onClick:f[4]||(f[4]=d=>u.$emit("activated"))},"Go to Dashboard ")])])):F("",!0)])]))}},x2=be(k2,[["__scopeId","data-v-56e5717d"]]),A2={},T2={class:"page-footer"};function N2(e,t){return m(),v("footer",T2,[...t[0]||(t[0]=[l("span",{class:"footer-brand"},"Bridge Classroom  Free educational tool  Provided as-is",-1),l("nav",{class:"footer-links"},[l("a",{href:"https://discord.gg/7PGejFZn",target:"_blank",rel:"noopener"},"Discord"),l("a",{href:"https://github.com/Rick-Wilson/Bridge-Classroom",target:"_blank",rel:"noopener"},"GitHub")],-1)])])}const E2=be(A2,[["render",N2],["__scopeId","data-v-1b649814"]]),O2={key:1,class:"app"},I2={class:"app-header"},R2={class:"header-right"},P2=["title"],D2={key:3,class:"stats"},L2={class:"correct"},B2={class:"wrong"},M2={class:"user-avatar-group"},U2=["title"],F2=["title"],j2={class:"app-main"},H2={key:3,class:"collection-view"},W2={key:4,class:"practice-layout"},V2={class:"practice-left"},K2={class:"practice-right"},G2={key:1,class:"commentary-panel"},z2=["innerHTML"],J2=["innerHTML"],Y2=["innerHTML"],q2=["innerHTML"],X2={class:"commentary-controls"},Q2={key:0,class:"bidding-box-wrapper"},Z2={key:1,class:"card-choice-prompt"},eT=["innerHTML"],tT={key:3,class:"completion-controls"},sT={key:0,class:"registration-toast"},nT={__name:"MainLayout",setup(e){const t=Dm(),s=po(),n=ze(),o=va(),a=Ou(),r=bn(),i=sl(),c=wn(),u=Gv(),f=R(!1),d=R(!1),p=R(!1),h=R(!1),g=R(null),y=R(""),$=R(null),C=R(null),b=R(null),w=R(!1),A=R(null),L=R(null),V=R(!1),U=R(!1),X=R(null);function q(x,I=".current"){if(!x)return;const K=x.querySelector(I);K&&(x.scrollTop=K.offsetTop-x.offsetTop)}yt(()=>u.currentStepIndex.value,()=>{Xn(()=>{q($.value,".narrative-text.current")})}),yt(()=>u.isComplete.value,x=>{x&&Xn(()=>{q($.value,".narrative-text.current")})});const ue=E(()=>n.isAuthenticated.value),ve=E(()=>{const x=n.currentUser.value;return x?`${x.firstName} ${x.lastName}`:""}),de=E(()=>{const x=n.currentUser.value;return x?`${x.firstName.charAt(0)}${x.lastName.charAt(0)}`.toUpperCase():"?"}),ye=E(()=>{const x=n.currentUser.value;return(x==null?void 0:x.role)||"student"}),Se=E(()=>s.teacherName.value?`${s.teacherName.value}'s Bridge Classroom`:"Bridge Classroom");let fe=null;wt(()=>{i.loadAnnouncement(),fe=setInterval(()=>i.loadAnnouncement(),5*60*1e3)}),Pr(()=>{fe&&clearInterval(fe)}),wt(async()=>{s.initializeFromUrl(),n.initialize();const x=new URLSearchParams(window.location.search);x.get("recover")&&x.get("user_id")&&n.isAuthenticated.value&&(n.currentUserId.value=null),o.initializeFromUrl(),u.observationStore.initialize();const I=s.getCollectionFromUrl(),K=s.getLessonFromUrl();I&&(C.value=I,K&&await W(I,K)),n.isAuthenticated.value&&(await a.initialize(),await n.syncRole(),gs().initialize(),await r.checkTeacherStatus())});async function ie(x){console.log("User ready:",x.firstName,x.lastName),n.showKeyBackupModal.value&&(n.dismissKeyBackupModal(),U.value=!0,setTimeout(()=>{U.value=!1},4e3)),await a.initialize(),gs().initialize(),await r.checkTeacherStatus();const K=sessionStorage.getItem("pendingJoinCode");if(K){sessionStorage.removeItem("pendingJoinCode"),t.push({name:"join",params:{joinCode:K}});return}}function H(){gs().reset(),qr().clearCache(),ws().reset(),r.reset(),M.value=[],j.value=0,C.value=null,b.value=null,u.resetStats(),s.setCollectionInUrl(null),s.setLessonInUrl(null),n.currentUserId.value=null,f.value=!1,h.value=!1,g.value=null}async function O(){w.value=!1,await r.checkTeacherStatus()}const M=R([]),j=R(0),D=E(()=>M.value[j.value]||null),ee=E(()=>{var Z;const x=T(C.value),I=x!=null&&x.name?`${x.name} - `:"";if((Z=b.value)!=null&&Z.name)return I+b.value.name;if(!D.value)return"";const K=D.value.subfolder||D.value.category||"";return K?I+K:""});yt(j,()=>{D.value&&(u.loadDeal(D.value),s.setDealInUrl(D.value.boardNumber))},{flush:"sync"}),yt(()=>u.observationStore.pendingCount.value,(x,I)=>{x>I&&a.triggerSync()}),yt(()=>u.isComplete.value,x=>{x&&(A.value=null)});async function ke(x){const I=x.target.files[0];if(I)try{const K=await I.text(),Z=So(K);if(Z.length>0){const oe=I.name.replace(/\.pbn$/i,""),pe=Z.map(me=>({...me,subfolder:me.subfolder||oe,category:me.category||oe}));M.value=pe,j.value=0,u.loadDeal(pe[0]),u.resetStats(),vs().saveLessonBoardNumbers(oe,pe.map(me=>me.boardNumber)),b.value={id:oe,name:oe,category:oe}}else alert("No deals found in the PBN file")}catch(K){console.error("Error loading PBN file:",K),alert("Error loading PBN file: "+K.message)}}function Me({subfolder:x,name:I,category:K,content:Z}){const oe=So(Z);if(oe.length>0){const pe=oe.map(me=>({...me,subfolder:me.subfolder||x,category:me.category||K}));M.value=pe,j.value=0,u.loadDeal(pe[0]),u.resetStats(),vs().saveLessonBoardNumbers(x,pe.map(me=>me.boardNumber)),b.value={id:x,name:I,category:K},s.setLessonInUrl(x),V.value=!1,z()}else alert("No deals found in the lesson file")}const Ue=E(()=>u.boardState.correctCount),Fe=E(()=>u.boardState.wrongCount);function J(x){!u.makeBid(x)&&D.value&&(A.value=D.value.boardNumber)}function re({seat:x,suit:I,rank:K}){!u.makeCardChoice(I,K)&&D.value&&(A.value=D.value.boardNumber)}function ne(){u.clearCardFeedback(),u.goBack()}function ce(){j.value<M.value.length-1&&(A.value=null,j.value++,u.loadDeal(M.value[j.value]))}function Ce(x){x>=0&&x<M.value.length&&(A.value=null,j.value=x,u.loadDeal(M.value[x]))}async function S({subfolder:x,dealNumber:I}){var K;if(((K=b.value)==null?void 0:K.id)===x&&M.value.length>0){const Z=M.value.findIndex(oe=>oe.boardNumber===I);if(Z>=0){Ce(Z);return}}for(const Z of s.COLLECTIONS)try{const oe=x.includes("/")?x.split("/").pop():x,pe=`${Z.baseUrl}/${oe}.pbn`,_e=await fetch(pe);if(!_e.ok)continue;const me=await _e.text();C.value=Z.id,s.setCollectionInUrl(Z.id),Me({subfolder:x,name:x,category:"",content:me});const Ve=M.value.findIndex(Je=>Je.boardNumber===I);Ve>=0&&Ce(Ve);return}catch{}}function k(x){p.value=!1,h.value=!1,g.value=null,S(x)}function P(x,I){h.value=!1,g.value=null,S({subfolder:x,dealNumber:I||1})}function G(){b.value=null,s.setLessonInUrl(null),M.value=[],j.value=0,u.resetStats(),V.value=!1,L.value=null,h.value=!1,g.value=null}function Y(){C.value=null,b.value=null,s.setCollectionInUrl(null),s.setLessonInUrl(null),M.value=[],j.value=0,u.resetStats(),V.value=!1,L.value=null,h.value=!1,g.value=null}async function z(){if(L.value=null,!C.value||!b.value)return;const x=T(C.value);if(!x)return;const I=b.value.id,K=I.includes("/")?I.split("/").pop():I,Z=`${x.baseUrl}/${K}_Intro.pdf`;try{(await fetch(Z,{method:"HEAD"})).ok&&(L.value=Z)}catch{}}function se(x){window.innerWidth<600?window.open(x,"_blank"):(X.value=x,V.value=!0)}function te(x){C.value=x,s.setCollectionInUrl(x)}async function N(x){const I=await c.fetchExerciseBoards(x.exercise_id);if(!I||I.length===0){alert("Could not load exercise boards.");return}const K=_e=>`${_e.collection_id||""}|${_e.deal_subfolder}`,Z=new Map;for(const _e of I){const me=K(_e);Z.has(me)||Z.set(me,[]),Z.get(me).push(_e)}const oe=[];for(const[,_e]of Z){const me=_e[0].deal_subfolder,Ve=_e[0].collection_id,Je=me.includes("/")?me.split("/").pop():me;let Ze=null;if(Ve){const $e=T(Ve);if($e)try{const qe=`${$e.baseUrl}/${Je}.pbn`,et=await fetch(qe);et.ok&&(Ze=await et.text())}catch{}}if(!Ze)for(const $e of s.COLLECTIONS)try{const qe=`${$e.baseUrl}/${Je}.pbn`,et=await fetch(qe);if(et.ok){Ze=await et.text();break}}catch{}if(!Ze){console.warn(`Could not load PBN for subfolder: ${me}`);continue}const Gt=So(Ze),Ke=new Set(_e.map($e=>$e.deal_number));for(const $e of Gt)if(Ke.has($e.boardNumber)){const qe=_e.find(et=>et.deal_number===$e.boardNumber);oe.push({...$e,subfolder:$e.subfolder||me,category:$e.category||me,_sortOrder:(qe==null?void 0:qe.sort_order)??999})}}if(oe.length===0){alert("Could not find any of the assigned boards.");return}oe.sort((_e,me)=>_e._sortOrder-me._sortOrder),M.value=oe,j.value=0,u.loadDeal(oe[0]),u.resetStats(),vs().saveLessonBoardNumbers(x.exercise_name,oe.map(_e=>_e.boardNumber)),b.value={id:x.exercise_name,name:x.exercise_name,category:"Assignment"}}function T(x){return s.COLLECTIONS.find(I=>I.id===x)}async function W(x,I){var Z;const K=T(x);if(!K)return console.error("Collection not found:",x),!1;try{const oe=await fetch(K.tocUrl);if(!oe.ok)throw new Error(`Failed to load TOC: ${oe.statusText}`);const pe=await oe.json();let _e=null,me=null;for(const $e of pe.categories||[]){const qe=(Z=$e.lessons)==null?void 0:Z.find(et=>et.id===I);if(qe){_e=qe,me=$e;break}}if(!_e)return console.error("Lesson not found in TOC:",I),!1;const Ve=I.includes("/")?I.split("/").pop():I,Je=`${K.baseUrl}/${Ve}.pbn`,Ze=await fetch(Je);if(!Ze.ok)throw new Error(`Failed to load lesson: ${Ze.statusText}`);const Gt=await Ze.text(),Ke=So(Gt);if(Ke.length>0){const $e=Ke.map(ls=>({...ls,subfolder:ls.subfolder||I,category:ls.category||me.name}));M.value=$e;const qe=s.getDealFromUrl(),et=qe?$e.findIndex(ls=>ls.boardNumber===qe):-1;return j.value=et>=0?et:0,u.loadDeal($e[j.value]),u.resetStats(),b.value={id:I,name:_e.name,category:me.name},z(),!0}return!1}catch(oe){return console.error("Error loading lesson from URL:",oe),!1}}return(x,I)=>{var K,Z,oe,pe,_e,me,Ve,Je,Ze,Gt,Ke,$e,qe,et,ls,ll;return ue.value?(m(),v("div",O2,[l("header",I2,[l("h1",null,_(M.value.length?ee.value:Se.value),1),l("div",R2,[ge(w_),l("button",{class:"progress-btn",onClick:I[0]||(I[0]=Ie=>d.value=!0),title:"View Progress"}," Progress "),l("button",{class:"accomplishments-btn",onClick:I[1]||(I[1]=Ie=>p.value=!0),title:"View Accomplishments"}," Accomplishments "),B(r).isTeacher.value?(m(),v("button",{key:0,class:"teacher-btn",onClick:I[2]||(I[2]=Ie=>{h.value=!0,g.value=null,y.value=""}),title:"View Students"}," Students ")):F("",!0),M.value.length&&C.value?(m(),v("button",{key:1,class:"lessons-btn",onClick:G,title:"Back to "+((K=T(C.value))==null?void 0:K.name)},_((Z=T(C.value))==null?void 0:Z.name),9,P2)):F("",!0),C.value||M.value.length?(m(),v("button",{key:2,class:"lobby-btn",onClick:Y,title:"Return to lobby"}," Lobby ")):F("",!0),Ue.value+Fe.value>0?(m(),v("div",D2,[l("span",L2,_(Ue.value),1),l("span",B2,_(Fe.value),1)])):F("",!0),l("div",M2,[ye.value!=="student"?(m(),v("button",{key:0,class:le(["role-badge","role-"+ye.value]),onClick:Y,title:"Return to "+ye.value+" lobby"},_(ye.value),11,U2)):F("",!0),l("button",{class:"user-btn",onClick:I[3]||(I[3]=Ie=>f.value=!0),title:ve.value},_(de.value),9,F2)])])]),l("main",j2,[ge(u_),ge(l_),h.value&&!g.value?(m(),Le(TC,{key:0,onClose:I[4]||(I[4]=Ie=>h.value=!1),onSelectStudent:I[5]||(I[5]=(Ie,Cn)=>{g.value=Ie,y.value=Cn})})):h.value&&g.value?(m(),Le(nS,{key:1,studentId:g.value,studentName:y.value,onBack:I[6]||(I[6]=Ie=>g.value=null),onNavigateToLesson:P},null,8,["studentId","studentName"])):!M.value.length&&!C.value?(m(),Le(m2,{key:2,onSelectCollection:te,onSelectAssignment:N,onShowBecomeTeacher:I[7]||(I[7]=Ie=>w.value=!0),onLoadFile:ke})):!M.value.length&&C.value?(m(),v("div",H2,[l("h2",null,_(((oe=T(C.value))==null?void 0:oe.name)||C.value),1),I[17]||(I[17]=l("p",{class:"collection-subtitle"},"Select a lesson to begin practicing:",-1)),ge(ES,{visible:!0,inline:!0,collection:T(C.value),onLoad:Me},null,8,["collection"])])):(m(),v("div",W2,[l("div",V2,[M.value.length>1?(m(),Le(Lu,{key:0,boardNumbers:M.value.map(Ie=>Ie.boardNumber),lessonSubfolder:((pe=D.value)==null?void 0:pe.subfolder)||((_e=D.value)==null?void 0:_e.category)||"",currentIndex:j.value,forceRedBoard:A.value,introUrl:L.value,onGoto:Ce,onOpenIntro:se},null,8,["boardNumbers","lessonSubfolder","currentIndex","forceRedBoard","introUrl"])):F("",!0),ge(ly,{boardNumber:(me=D.value)==null?void 0:me.boardNumber,dealer:(Ve=D.value)==null?void 0:Ve.dealer,vulnerable:(Je=D.value)==null?void 0:Je.vulnerable,contract:(Ze=D.value)==null?void 0:Ze.contract,declarer:(Gt=D.value)==null?void 0:Gt.declarer,showContract:B(u).auctionState.auctionComplete||B(u).showOpeningLead.value||B(u).hasSteps.value&&!B(u).hasBidSteps.value,openingLead:B(u).showOpeningLead.value?(Ke=D.value)==null?void 0:Ke.openingLead:"",totalDeals:M.value.length,currentIndex:j.value,dealBoardNumbers:M.value.map(Ie=>Ie.boardNumber),onGoto:Ce},null,8,["boardNumber","dealer","vulnerable","contract","declarer","showContract","openingLead","totalDeals","currentIndex","dealBoardNumbers"]),ge(kg,{hands:B(u).hands.value,hiddenSeats:B(u).hiddenSeats.value,showHcp:B(u).showHcp.value,compact:!0,clickableSeat:B(u).hasCardChoice.value?B(u).studentSeat.value:null,playedCards:B(u).showcardsPlayedCards.value,onCardClick:re},null,8,["hands","hiddenSeats","showHcp","clickableSeat","playedCards"])]),l("div",K2,[B(u).showAuctionTable.value?(m(),Le(Wg,{key:0,bids:B(u).hasBidSteps.value?B(u).auctionState.displayedBids:(($e=D.value)==null?void 0:$e.auction)||[],dealer:((qe=D.value)==null?void 0:qe.dealer)||"N",currentBidIndex:B(u).hasBidSteps.value?B(u).auctionState.currentBidIndex:-1,wrongBidIndex:B(u).auctionState.wrongBidIndex,correctBidIndex:B(u).auctionState.correctBidIndex,showTurnIndicator:B(u).hasBidPrompt.value},null,8,["bids","dealer","currentBidIndex","wrongBidIndex","correctBidIndex","showTurnIndicator"])):F("",!0),ge(bi,{visible:!!B(u).auctionState.wrongBid,type:"wrong",wrongBid:B(u).auctionState.wrongBid,correctBid:B(u).auctionState.correctBid,showContinue:!1},null,8,["visible","wrongBid","correctBid"]),ge(bi,{visible:!!B(u).cardChoiceState.wrongCard,type:"wrong",wrongCardCode:B(u).cardChoiceState.wrongCard,correctCardCode:B(u).cardChoiceState.correctCard,showContinue:!1},null,8,["visible","wrongCardCode","correctCardCode"]),B(u).hasSteps.value?(m(),v("div",G2,[l("div",{class:"commentary-text-container",ref_key:"commentaryContainer",ref:$},[(m(!0),v(Q,null,ae(B(u).steps.value.slice(0,B(u).currentStepIndex.value),(Ie,Cn)=>(m(),v(Q,{key:"prev-"+Cn},[Cn>=B(u).commentaryStartIndex.value?(m(),v(Q,{key:0},[l("span",{class:"narrative-text previous",innerHTML:B(zs)(B(Tn)(Ie.text))},null,8,z2),Ie.type==="bid"&&Ie.explanationText?(m(),v("span",{key:0,class:le(["narrative-text",Cn===B(u).currentStepIndex.value-1&&B(u).isBidStep.value&&!B(u).bidAnswered.value?"current":"previous"]),innerHTML:B(zs)(B(Tn)(Ie.explanationText))},null,10,J2)):F("",!0)],64)):F("",!0)],64))),128)),B(u).currentStep.value?(m(),v("span",{key:0,class:"narrative-text current",innerHTML:B(zs)(B(Tn)(B(u).currentStep.value.text))},null,8,Y2)):F("",!0),B(u).bidAnswered.value&&((et=B(u).currentStep.value)!=null&&et.explanationText)?(m(),v("span",{key:1,class:"narrative-text current",innerHTML:B(zs)(B(Tn)(B(u).currentStep.value.explanationText))},null,8,q2)):F("",!0)],512),l("div",X2,[B(u).hasBidPrompt.value?(m(),v("div",Q2,[ge(Bg,{lastBid:B(u).lastContractBid.value,canDouble:B(u).canDouble.value,canRedouble:B(u).canRedouble.value,onBid:J},null,8,["lastBid","canDouble","canRedouble"])])):B(u).hasCardChoice.value?(m(),v("div",Z2," Click on the card you would choose ")):F("",!0),B(u).canGoBack.value?(m(),v("button",{key:2,class:"instruction-btn secondary",onClick:ne},"  Back ")):F("",!0),!B(u).isComplete.value&&(B(u).bidAnswered.value||!B(u).hasBidPrompt.value&&!B(u).hasCardChoice.value&&B(u).currentStep.value&&B(u).currentStep.value.type!=="end")?(m(),v("button",{key:3,class:"instruction-btn primary",onClick:I[8]||(I[8]=Ie=>B(u).advance())},_(((ls=B(u).currentStep.value)==null?void 0:ls.type)==="rotate"?"Rotate":"Next")+"  ",1)):F("",!0),B(u).isComplete.value&&j.value<M.value.length-1?(m(),v("button",{key:4,class:"next-deal-btn",onClick:ce}," Next Deal  ")):F("",!0)])])):(ll=D.value)!=null&&ll.commentary?(m(),v("div",{key:2,class:"display-commentary",innerHTML:B(zs)(B(Tn)(B(Gm)(D.value.commentary)))},null,8,eT)):F("",!0),!B(u).hasSteps.value&&B(u).isComplete.value&&j.value<M.value.length-1?(m(),v("div",tT,[l("button",{class:"next-deal-btn",onClick:ce}," Next Deal  ")])):F("",!0)])]))]),ge(qb,{visible:f.value,onClose:I[9]||(I[9]=Ie=>f.value=!1),onSwitchUser:H,onLogout:H,onBecomeTeacher:I[10]||(I[10]=Ie=>w.value=!0)},null,8,["visible"]),U.value?(m(),v("div",sT," Account created  your data is encrypted and linked to your email for recovery. ")):F("",!0),d.value?(m(),v("div",{key:1,class:"modal-overlay",onClick:I[12]||(I[12]=_t(Ie=>d.value=!1,["self"]))},[ge(dw,{onClose:I[11]||(I[11]=Ie=>d.value=!1)})])):F("",!0),p.value?(m(),v("div",{key:2,class:"modal-overlay",onClick:I[14]||(I[14]=_t(Ie=>p.value=!1,["self"]))},[ge(Xw,{onClose:I[13]||(I[13]=Ie=>p.value=!1),onNavigateToDeal:k})])):F("",!0),ge(MS,{visible:V.value,url:X.value||"",onClose:I[15]||(I[15]=Ie=>V.value=!1)},null,8,["visible","url"]),w.value?(m(),Le(x2,{key:3,onClose:I[16]||(I[16]=Ie=>w.value=!1),onActivated:O})):F("",!0),ge(E2)])):(m(),Le(mb,{key:0,onUserReady:ie}))}}},oT=()=>Ap(()=>import("./JoinClassroomView-DVPmcb24.js"),__vite__mapDeps([0,1])),aT=[{path:"/join/:joinCode",name:"join",component:oT},{path:"/:pathMatch(.*)*",name:"app",component:nT}],rT=Pm({history:fm(),routes:aT});typeof crypto<"u"&&!crypto.randomUUID&&(crypto.randomUUID=function(){const e=crypto.getRandomValues(new Uint8Array(16));e[6]=e[6]&15|64,e[8]=e[8]&63|128;const t=[...e].map(s=>s.toString(16).padStart(2,"0")).join("");return`${t.slice(0,8)}-${t.slice(8,12)}-${t.slice(12,16)}-${t.slice(16,20)}-${t.slice(20)}`});const Ju=bp($p);Ju.use(rT);Ju.mount("#app");export{be as _,l as a,ge as b,v as c,F as d,Ne as e,to as f,ze as g,yo as h,sf as i,qc as j,Dm as k,m as l,wt as o,R as r,_ as t,lT as u,Bd as w};
